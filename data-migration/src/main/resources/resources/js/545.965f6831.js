(self["webpackChunkweb_ui"]=self["webpackChunkweb_ui"]||[]).push([[545],{9662:function(e,t,a){var o=a(614),n=a(6330),r=TypeError;e.exports=function(e){if(o(e))return e;throw r(n(e)+" is not a function")}},9670:function(e,t,a){var o=a(111),n=String,r=TypeError;e.exports=function(e){if(o(e))return e;throw r(n(e)+" is not an object")}},1318:function(e,t,a){var o=a(5656),n=a(1400),r=a(6244),l=function(e){return function(t,a,l){var i,u=o(t),s=r(u),c=n(l,s);if(e&&a!=a){while(s>c)if(i=u[c++],i!=i)return!0}else for(;s>c;c++)if((e||c in u)&&u[c]===a)return e||c||0;return!e&&-1}};e.exports={includes:l(!0),indexOf:l(!1)}},3658:function(e,t,a){"use strict";var o=a(9781),n=a(3157),r=TypeError,l=Object.getOwnPropertyDescriptor,i=o&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=i?function(e,t){if(n(e)&&!l(e,"length").writable)throw r("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},4326:function(e,t,a){var o=a(1702),n=o({}.toString),r=o("".slice);e.exports=function(e){return r(n(e),8,-1)}},9920:function(e,t,a){var o=a(2597),n=a(3887),r=a(1236),l=a(3070);e.exports=function(e,t,a){for(var i=n(t),u=l.f,s=r.f,c=0;c<i.length;c++){var d=i[c];o(e,d)||a&&o(a,d)||u(e,d,s(t,d))}}},8880:function(e,t,a){var o=a(9781),n=a(3070),r=a(9114);e.exports=o?function(e,t,a){return n.f(e,t,r(1,a))}:function(e,t,a){return e[t]=a,e}},9114:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},8052:function(e,t,a){var o=a(614),n=a(3070),r=a(6339),l=a(3072);e.exports=function(e,t,a,i){i||(i={});var u=i.enumerable,s=void 0!==i.name?i.name:t;if(o(a)&&r(a,s,i),i.global)u?e[t]=a:l(t,a);else{try{i.unsafe?e[t]&&(u=!0):delete e[t]}catch(c){}u?e[t]=a:n.f(e,t,{value:a,enumerable:!1,configurable:!i.nonConfigurable,writable:!i.nonWritable})}return e}},3072:function(e,t,a){var o=a(2474),n=Object.defineProperty;e.exports=function(e,t){try{n(o,e,{value:t,configurable:!0,writable:!0})}catch(a){o[e]=t}return t}},5117:function(e,t,a){"use strict";var o=a(6330),n=TypeError;e.exports=function(e,t){if(!delete e[t])throw n("Cannot delete property "+o(t)+" of "+o(e))}},9781:function(e,t,a){var o=a(7293);e.exports=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},4154:function(e){var t="object"==typeof document&&document.all,a="undefined"==typeof t&&void 0!==t;e.exports={all:t,IS_HTMLDDA:a}},317:function(e,t,a){var o=a(2474),n=a(111),r=o.document,l=n(r)&&n(r.createElement);e.exports=function(e){return l?r.createElement(e):{}}},7207:function(e){var t=TypeError,a=9007199254740991;e.exports=function(e){if(e>a)throw t("Maximum allowed index exceeded");return e}},8113:function(e){e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},7392:function(e,t,a){var o,n,r=a(2474),l=a(8113),i=r.process,u=r.Deno,s=i&&i.versions||u&&u.version,c=s&&s.v8;c&&(o=c.split("."),n=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!n&&l&&(o=l.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=l.match(/Chrome\/(\d+)/),o&&(n=+o[1]))),e.exports=n},748:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(e,t,a){var o=a(2474),n=a(1236).f,r=a(8880),l=a(8052),i=a(3072),u=a(9920),s=a(4705);e.exports=function(e,t){var a,c,d,p,m,f,v=e.target,g=e.global,b=e.stat;if(c=g?o:b?o[v]||i(v,{}):(o[v]||{}).prototype,c)for(d in t){if(m=t[d],e.dontCallGetSet?(f=n(c,d),p=f&&f.value):p=c[d],a=s(g?d:v+(b?".":"#")+d,e.forced),!a&&void 0!==p){if(typeof m==typeof p)continue;u(m,p)}(e.sham||p&&p.sham)&&r(m,"sham",!0),l(c,d,m,e)}}},7293:function(e){e.exports=function(e){try{return!!e()}catch(t){return!0}}},4374:function(e,t,a){var o=a(7293);e.exports=!o((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},6916:function(e,t,a){var o=a(4374),n=Function.prototype.call;e.exports=o?n.bind(n):function(){return n.apply(n,arguments)}},6530:function(e,t,a){var o=a(9781),n=a(2597),r=Function.prototype,l=o&&Object.getOwnPropertyDescriptor,i=n(r,"name"),u=i&&"something"===function(){}.name,s=i&&(!o||o&&l(r,"name").configurable);e.exports={EXISTS:i,PROPER:u,CONFIGURABLE:s}},1702:function(e,t,a){var o=a(4374),n=Function.prototype,r=n.call,l=o&&n.bind.bind(r,r);e.exports=o?l:function(e){return function(){return r.apply(e,arguments)}}},5005:function(e,t,a){var o=a(2474),n=a(614),r=function(e){return n(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?r(o[e]):o[e]&&o[e][t]}},8173:function(e,t,a){var o=a(9662),n=a(8554);e.exports=function(e,t){var a=e[t];return n(a)?void 0:o(a)}},2474:function(e,t,a){var o=function(e){return e&&e.Math==Math&&e};e.exports=o("object"==typeof globalThis&&globalThis)||o("object"==typeof window&&window)||o("object"==typeof self&&self)||o("object"==typeof a.g&&a.g)||function(){return this}()||Function("return this")()},2597:function(e,t,a){var o=a(1702),n=a(7908),r=o({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return r(n(e),t)}},3501:function(e){e.exports={}},4664:function(e,t,a){var o=a(9781),n=a(7293),r=a(317);e.exports=!o&&!n((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},8361:function(e,t,a){var o=a(1702),n=a(7293),r=a(4326),l=Object,i=o("".split);e.exports=n((function(){return!l("z").propertyIsEnumerable(0)}))?function(e){return"String"==r(e)?i(e,""):l(e)}:l},2788:function(e,t,a){var o=a(1702),n=a(614),r=a(5465),l=o(Function.toString);n(r.inspectSource)||(r.inspectSource=function(e){return l(e)}),e.exports=r.inspectSource},9909:function(e,t,a){var o,n,r,l=a(4811),i=a(2474),u=a(111),s=a(8880),c=a(2597),d=a(5465),p=a(6200),m=a(3501),f="Object already initialized",v=i.TypeError,g=i.WeakMap,b=function(e){return r(e)?n(e):o(e,{})},w=function(e){return function(t){var a;if(!u(t)||(a=n(t)).type!==e)throw v("Incompatible receiver, "+e+" required");return a}};if(l||d.state){var y=d.state||(d.state=new g);y.get=y.get,y.has=y.has,y.set=y.set,o=function(e,t){if(y.has(e))throw v(f);return t.facade=e,y.set(e,t),t},n=function(e){return y.get(e)||{}},r=function(e){return y.has(e)}}else{var h=p("state");m[h]=!0,o=function(e,t){if(c(e,h))throw v(f);return t.facade=e,s(e,h,t),t},n=function(e){return c(e,h)?e[h]:{}},r=function(e){return c(e,h)}}e.exports={set:o,get:n,has:r,enforce:b,getterFor:w}},3157:function(e,t,a){var o=a(4326);e.exports=Array.isArray||function(e){return"Array"==o(e)}},614:function(e,t,a){var o=a(4154),n=o.all;e.exports=o.IS_HTMLDDA?function(e){return"function"==typeof e||e===n}:function(e){return"function"==typeof e}},4705:function(e,t,a){var o=a(7293),n=a(614),r=/#|\.prototype\./,l=function(e,t){var a=u[i(e)];return a==c||a!=s&&(n(t)?o(t):!!t)},i=l.normalize=function(e){return String(e).replace(r,".").toLowerCase()},u=l.data={},s=l.NATIVE="N",c=l.POLYFILL="P";e.exports=l},8554:function(e){e.exports=function(e){return null===e||void 0===e}},111:function(e,t,a){var o=a(614),n=a(4154),r=n.all;e.exports=n.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:o(e)||e===r}:function(e){return"object"==typeof e?null!==e:o(e)}},1913:function(e){e.exports=!1},2190:function(e,t,a){var o=a(5005),n=a(614),r=a(7976),l=a(3307),i=Object;e.exports=l?function(e){return"symbol"==typeof e}:function(e){var t=o("Symbol");return n(t)&&r(t.prototype,i(e))}},6244:function(e,t,a){var o=a(7466);e.exports=function(e){return o(e.length)}},6339:function(e,t,a){var o=a(1702),n=a(7293),r=a(614),l=a(2597),i=a(9781),u=a(6530).CONFIGURABLE,s=a(2788),c=a(9909),d=c.enforce,p=c.get,m=String,f=Object.defineProperty,v=o("".slice),g=o("".replace),b=o([].join),w=i&&!n((function(){return 8!==f((function(){}),"length",{value:8}).length})),y=String(String).split("String"),h=e.exports=function(e,t,a){"Symbol("===v(m(t),0,7)&&(t="["+g(m(t),/^Symbol\(([^)]*)\)/,"$1")+"]"),a&&a.getter&&(t="get "+t),a&&a.setter&&(t="set "+t),(!l(e,"name")||u&&e.name!==t)&&(i?f(e,"name",{value:t,configurable:!0}):e.name=t),w&&a&&l(a,"arity")&&e.length!==a.arity&&f(e,"length",{value:a.arity});try{a&&l(a,"constructor")&&a.constructor?i&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(n){}var o=d(e);return l(o,"source")||(o.source=b(y,"string"==typeof t?t:"")),e};Function.prototype.toString=h((function(){return r(this)&&p(this).source||s(this)}),"toString")},4758:function(e){var t=Math.ceil,a=Math.floor;e.exports=Math.trunc||function(e){var o=+e;return(o>0?a:t)(o)}},3070:function(e,t,a){var o=a(9781),n=a(4664),r=a(3353),l=a(9670),i=a(4948),u=TypeError,s=Object.defineProperty,c=Object.getOwnPropertyDescriptor,d="enumerable",p="configurable",m="writable";t.f=o?r?function(e,t,a){if(l(e),t=i(t),l(a),"function"===typeof e&&"prototype"===t&&"value"in a&&m in a&&!a[m]){var o=c(e,t);o&&o[m]&&(e[t]=a.value,a={configurable:p in a?a[p]:o[p],enumerable:d in a?a[d]:o[d],writable:!1})}return s(e,t,a)}:s:function(e,t,a){if(l(e),t=i(t),l(a),n)try{return s(e,t,a)}catch(o){}if("get"in a||"set"in a)throw u("Accessors not supported");return"value"in a&&(e[t]=a.value),e}},1236:function(e,t,a){var o=a(9781),n=a(6916),r=a(5296),l=a(9114),i=a(5656),u=a(4948),s=a(2597),c=a(4664),d=Object.getOwnPropertyDescriptor;t.f=o?d:function(e,t){if(e=i(e),t=u(t),c)try{return d(e,t)}catch(a){}if(s(e,t))return l(!n(r.f,e,t),e[t])}},8006:function(e,t,a){var o=a(6324),n=a(748),r=n.concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return o(e,r)}},5181:function(e,t){t.f=Object.getOwnPropertySymbols},7976:function(e,t,a){var o=a(1702);e.exports=o({}.isPrototypeOf)},6324:function(e,t,a){var o=a(1702),n=a(2597),r=a(5656),l=a(1318).indexOf,i=a(3501),u=o([].push);e.exports=function(e,t){var a,o=r(e),s=0,c=[];for(a in o)!n(i,a)&&n(o,a)&&u(c,a);while(t.length>s)n(o,a=t[s++])&&(~l(c,a)||u(c,a));return c}},5296:function(e,t){"use strict";var a={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,n=o&&!a.call({1:2},1);t.f=n?function(e){var t=o(this,e);return!!t&&t.enumerable}:a},2140:function(e,t,a){var o=a(6916),n=a(614),r=a(111),l=TypeError;e.exports=function(e,t){var a,i;if("string"===t&&n(a=e.toString)&&!r(i=o(a,e)))return i;if(n(a=e.valueOf)&&!r(i=o(a,e)))return i;if("string"!==t&&n(a=e.toString)&&!r(i=o(a,e)))return i;throw l("Can't convert object to primitive value")}},3887:function(e,t,a){var o=a(5005),n=a(1702),r=a(8006),l=a(5181),i=a(9670),u=n([].concat);e.exports=o("Reflect","ownKeys")||function(e){var t=r.f(i(e)),a=l.f;return a?u(t,a(e)):t}},4488:function(e,t,a){var o=a(8554),n=TypeError;e.exports=function(e){if(o(e))throw n("Can't call method on "+e);return e}},6200:function(e,t,a){var o=a(2309),n=a(9711),r=o("keys");e.exports=function(e){return r[e]||(r[e]=n(e))}},5465:function(e,t,a){var o=a(2474),n=a(3072),r="__core-js_shared__",l=o[r]||n(r,{});e.exports=l},2309:function(e,t,a){var o=a(1913),n=a(5465);(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.29.0",mode:o?"pure":"global",copyright:"© 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.29.0/LICENSE",source:"https://github.com/zloirock/core-js"})},6293:function(e,t,a){var o=a(7392),n=a(7293);e.exports=!!Object.getOwnPropertySymbols&&!n((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&o&&o<41}))},1400:function(e,t,a){var o=a(9303),n=Math.max,r=Math.min;e.exports=function(e,t){var a=o(e);return a<0?n(a+t,0):r(a,t)}},5656:function(e,t,a){var o=a(8361),n=a(4488);e.exports=function(e){return o(n(e))}},9303:function(e,t,a){var o=a(4758);e.exports=function(e){var t=+e;return t!==t||0===t?0:o(t)}},7466:function(e,t,a){var o=a(9303),n=Math.min;e.exports=function(e){return e>0?n(o(e),9007199254740991):0}},7908:function(e,t,a){var o=a(4488),n=Object;e.exports=function(e){return n(o(e))}},7593:function(e,t,a){var o=a(6916),n=a(111),r=a(2190),l=a(8173),i=a(2140),u=a(5112),s=TypeError,c=u("toPrimitive");e.exports=function(e,t){if(!n(e)||r(e))return e;var a,u=l(e,c);if(u){if(void 0===t&&(t="default"),a=o(u,e,t),!n(a)||r(a))return a;throw s("Can't convert object to primitive value")}return void 0===t&&(t="number"),i(e,t)}},4948:function(e,t,a){var o=a(7593),n=a(2190);e.exports=function(e){var t=o(e,"string");return n(t)?t:t+""}},6330:function(e){var t=String;e.exports=function(e){try{return t(e)}catch(a){return"Object"}}},9711:function(e,t,a){var o=a(1702),n=0,r=Math.random(),l=o(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+l(++n+r,36)}},3307:function(e,t,a){var o=a(6293);e.exports=o&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:function(e,t,a){var o=a(9781),n=a(7293);e.exports=o&&n((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},4811:function(e,t,a){var o=a(2474),n=a(614),r=o.WeakMap;e.exports=n(r)&&/native code/.test(String(r))},5112:function(e,t,a){var o=a(2474),n=a(2309),r=a(2597),l=a(9711),i=a(6293),u=a(3307),s=o.Symbol,c=n("wks"),d=u?s["for"]||s:s&&s.withoutSetter||l;e.exports=function(e){return r(c,e)||(c[e]=i&&r(s,e)?s[e]:d("Symbol."+e)),c[e]}},7658:function(e,t,a){"use strict";var o=a(2109),n=a(7908),r=a(6244),l=a(3658),i=a(7207),u=a(7293),s=u((function(){return 4294967297!==[].push.call({length:4294967296},1)})),c=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},d=s||!c();o({target:"Array",proto:!0,arity:1,forced:d},{push:function(e){var t=n(this),a=r(t),o=arguments.length;i(a+o);for(var u=0;u<o;u++)t[a]=arguments[u],a++;return l(t,a),a}})},541:function(e,t,a){"use strict";var o=a(2109),n=a(7908),r=a(6244),l=a(3658),i=a(5117),u=a(7207),s=1!==[].unshift(0),c=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}},d=s||!c();o({target:"Array",proto:!0,arity:1,forced:d},{unshift:function(e){var t=n(this),a=r(t),o=arguments.length;if(o){u(a+o);var s=a;while(s--){var c=s+o;s in t?t[c]=t[s]:i(t,c)}for(var d=0;d<o;d++)t[d]=arguments[d]}return l(t,a+o)}})},2649:function(e,t,a){"use strict";a.d(t,{C3:function(){return c},GA:function(){return l},Pj:function(){return i},_A:function(){return n},cg:function(){return u},dw:function(){return d},mX:function(){return s},mY:function(){return r},zN:function(){return p}});var o=a(196);function n(e){return o.ZP.get(`/plugins/data-migration/migration/${e}`)}function r(e){return o.ZP.get(`/plugins/data-migration/migration/refreshStatus/${e}`)}function l(e,t){return o.ZP.get(`/plugins/data-migration/migration/subTasks/${e}`,{params:t})}function i(e){return o.ZP.post(`/plugins/data-migration/migration/subTask/finish/${e}`)}function u(e){return o.ZP.post(`/plugins/data-migration/migration/subTask/start/reverse/${e}`)}function s(e){return o.ZP.post(`/plugins/data-migration/migration/subTask/stop/incremental/${e}`)}function c(e){return o.ZP.get(`/plugins/data-migration/migration/subTaskInfo/${e}`)}function d(e,t){return o.ZP.get(`/plugins/data-migration/migration/subTask/log/download/${e}`,{params:t})}function p(e){return o.ZP.get(`/plugins/data-migration/migration/editInfo/${e}`)}},3744:function(e,t){"use strict";t.Z=(e,t)=>{const a=e.__vccOpts||e;for(const[o,n]of t)a[o]=n;return a}},3545:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Te}});var o=a(821),n=a(5784);a(7658),a(541);const r={class:"modal-footer"};var l={__name:"AddSql",props:{open:Boolean},emits:["update:open"],setup(e,{emit:t}){const a=e,n=(0,o.iH)(),l=(0,o.qj)({}),i=(0,o.iH)(!1),u=(0,o.iH)(!1);(0,o.YP)(i,(e=>{t("update:open",e)})),(0,o.YP)((()=>a.open),(e=>{i.value=e}));const s=()=>{i.value=!1},c=()=>{n.value?.validate((e=>{}))};return(0,o.bv)((()=>{i.value=a.open})),(e,t)=>{const a=(0,o.up)("a-option"),d=(0,o.up)("a-select"),p=(0,o.up)("a-form-item"),m=(0,o.up)("a-input"),f=(0,o.up)("a-input-password"),v=(0,o.up)("a-form"),g=(0,o.up)("a-button"),b=(0,o.up)("a-modal");return(0,o.wg)(),(0,o.j4)(b,{title:"添加数据库",visible:i.value,"onUpdate:visible":t[4]||(t[4]=e=>i.value=e),width:"500px","title-align":"start","modal-class":"add-sql-modal"},{footer:(0,o.w5)((()=>[(0,o._)("div",r,[(0,o.Wm)(g,{onClick:s},{default:(0,o.w5)((()=>[(0,o.Uk)("取消")])),_:1}),(0,o.Wm)(g,{disabled:u.value,style:{"margin-left":"16px"}},{default:(0,o.w5)((()=>[(0,o.Uk)("测试连通性")])),_:1},8,["disabled"]),(0,o.Wm)(g,{type:"primary",disabled:u.value,style:{"margin-left":"16px"},onClick:c},{default:(0,o.w5)((()=>[(0,o.Uk)("确定")])),_:1},8,["disabled"])])])),default:(0,o.w5)((()=>[(0,o.Wm)(v,{ref_key:"formRef",ref:n,model:l,"auto-label-width":""},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{field:"attrCode1",label:"数据库类型",rules:[{required:!0,message:"数据库类型不能为空"}]},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{modelValue:l.attrCode1,"onUpdate:modelValue":t[0]||(t[0]=e=>l.attrCode1=e),placeholder:"请选择数据库类型"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{value:"1"},{default:(0,o.w5)((()=>[(0,o.Uk)("MySQL")])),_:1}),(0,o.Wm)(a,{value:"2"},{default:(0,o.w5)((()=>[(0,o.Uk)("openGauss")])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(p,{field:"attrCode2",label:"链接",rules:[{required:!0,message:"链接不能为空"}]},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{modelValue:l.attrCode2,"onUpdate:modelValue":t[1]||(t[1]=e=>l.attrCode2=e),placeholder:"请输入链接"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(p,{field:"attrCode3",label:"用户名",rules:[{required:!0,message:"用户名不能为空"}]},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{modelValue:l.attrCode3,"onUpdate:modelValue":t[2]||(t[2]=e=>l.attrCode3=e),placeholder:"请输入用户名",maxlength:"30"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(p,{field:"attrCode4",label:"密码",rules:[{required:!0,message:"密码不能为空"}]},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{modelValue:l.attrCode4,"onUpdate:modelValue":t[3]||(t[3]=e=>l.attrCode4=e),placeholder:"请输入密码",minlength:"6",maxlength:"20"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])}}},i=a(3744);const u=(0,i.Z)(l,[["__scopeId","data-v-38a52663"]]);var s=u,c=a(196);function d(e){return c.ZP.get("/plugins/data-migration/resource/getClusters",e)}function p(){return c.ZP.get("/plugins/data-migration/resource/getHosts")}function m(e){return c.ZP.get("/plugins/data-migration/resource/getSourceClusterDbs",{params:e})}function f(e){return c.ZP.get("/plugins/data-migration/resource/getTargetClusterDbs",{params:e})}function v(e){return c.ZP.post("/plugins/data-migration/migration/save",e)}function g(e){return c.ZP.post("/plugins/data-migration/migration/update",e)}function b(){return c.ZP.get("/plugins/data-migration/param/default")}const w=e=>((0,o.dD)("data-v-2d4f24b3"),e=e(),(0,o.Cn)(),e),y={class:"step1-container"},h={class:"form-con"},k={class:"form-left"},_={class:"card-title-con"},x=w((()=>(0,o._)("div",{class:"card-title"},"源端",-1))),N={class:"sql-sel-con"},W={class:"sql-tree-con"},I={key:1},P={key:1},U={style:{color:"var(--color-primary-light-4)"}},D={key:0,class:"selected-db-con"},j=w((()=>(0,o._)("span",{class:"selected-info"},"已选源端数据库：",-1))),C={class:"selected-db"},S={class:"form-center"},V={class:"form-right"},O={class:"card-title-con"},z=w((()=>(0,o._)("div",{class:"card-title"},"目的端",-1))),H={class:"sql-sel-con"},T={class:"sql-selected-con"},K={key:1,class:"add-sub-task"},q={key:1},B={style:{color:"var(--color-primary-light-4)"}},Z={class:"table-con"},M=w((()=>(0,o._)("span",null,"迁移过程模式",-1))),E=w((()=>(0,o._)("p",null,"离线模式：自动执行全量迁移，完成后自动结束，释放资源。",-1))),A=w((()=>(0,o._)("p",null,"在线模式：自动执行全量迁移+增量迁移，用户手动启动反向迁移，需要用户操作结束迁移，释放资源。",-1)));var $={__name:"index",props:{subTaskConfig:{type:Array,default:()=>[]}},emits:["syncConfig"],setup(e,{expose:t,emit:a}){const r=e,l=(0,o.iH)(!0),i=(0,o.iH)([]),u=(0,o.iH)([]),c=(0,o.iH)(""),p=(0,o.iH)(""),v=(0,o.iH)([]),g=(0,o.iH)([]),b=(0,o.qj)({sourceInfo:"",sourceNodeName:"",sourceDBName:""}),w=(0,o.iH)([]),$=(0,o.iH)(!1),L=(0,o.Fl)((()=>c.value?F(c.value,i.value):i.value)),Y=(0,o.Fl)((()=>p.value?F(p.value,u.value):u.value)),F=(e,t)=>{const a=t=>{const o=[];return t.forEach((t=>{if(t.title.toLowerCase().indexOf(e.toLowerCase())>-1)o.push({...t});else if(t.children){const e=a(t.children);e.length&&o.push({...t,children:e})}})),o};return a(t)},G=e=>c.value?e.toLowerCase().indexOf(c.value.toLowerCase()):-1,R=e=>p.value?e.toLowerCase().indexOf(p.value.toLowerCase()):-1,J=(e,t)=>{t.node.isLeaf?(b.sourceInfo=t.node.parentInfo,b.sourceNodeName=t.node.parentName,b.sourceDBName=t.node.title):(v.value=[],b.sourceInfo={},b.sourceNodeName="",b.sourceDBName="")},X=e=>e.map((e=>e?.nodes?.length>0?{title:e.name||"默认",key:e.clusterId||e.clusterNodeId,icon:()=>(0,o.h)((0,o.MY)('<svg-icon icon-class="cluster" style="font-size: 16px;" />')),level:e.clusterId?0:1,children:X(e.nodes),...e}:{title:e.ip+":"+e.port,key:e.clusterId||e.clusterNodeId,icon:()=>(0,o.h)((0,o.MY)(`<svg-icon icon-class="${e.clusterId?"cluster":"mysql"}" style="font-size: 22px;" />`)),level:e.clusterId?0:1,...e})),Q=e=>e.map((e=>e?.clusterNodes?.length>0?{title:e.clusterId||"默认",key:e.clusterId||e.nodeId,icon:()=>(0,o.h)((0,o.MY)('<svg-icon icon-class="cluster" style="font-size: 16px;" />')),level:e.clusterId?0:1,children:Q(e.clusterNodes.map((t=>({...t,versionNum:e.versionNum})))),...e}:{title:e.publicIp+":"+e.hostPort,key:e.clusterId||e.nodeId,icon:()=>(0,o.h)((0,o.MY)(`<svg-icon icon-class="${e.clusterId?"cluster":"opengaussdb"}" />`)),level:e.clusterId?0:1,...e})),ee=e=>m({url:e.url,username:e.username,password:e.password}).then((t=>{const a=t.data||[];e.children=a.map((t=>({title:t,key:t,icon:()=>(0,o.h)((0,o.MY)('<svg-icon icon-class="database" style="font-size: 16px;" />')),parentName:e.title,parentInfo:{host:e.ip,password:e.password,port:e.port,username:e.username,nodeId:e.clusterNodeId},isLeaf:!0})))})),te=e=>(console.log(e),f({azAddress:e.azAddress,azName:e.azName,clusterRole:e.clusterRole,dbName:e.dbName,dbPort:e.dbPort,dbUser:e.dbUser,dbUserPassword:e.dbUserPassword,hostId:e.hostId,hostPort:e.hostPort,hostname:e.hostname,installUserName:e.installUserName,nodeId:e.nodeId,privateIp:e.privateIp,publicIp:e.publicIp,rootPassword:e.rootPassword}).then((t=>{const a=t.data||[];e.children=a.map((t=>({title:t.dbName,key:t.dbName,icon:()=>(0,o.h)((0,o.MY)('<svg-icon icon-class="database" style="font-size: 16px;" />')),parentName:e.title,parentInfo:{host:e.publicIp,password:e.dbUserPassword,port:e.dbPort,username:e.dbUser,versionNum:e.versionNum,nodeId:e.nodeId},isSelect:t.isSelect,isLeaf:!0})))}))),ae=()=>{l.value=!0,d().then((e=>{l.value=!1;const t=e.data,a=X(t.sourceClusters);i.value=a;const o=Q(t.targetClusters);u.value=o})).catch((()=>{l.value=!1}))};(0,o.YP)(w,(e=>{a("syncConfig",e)}),{deep:!0});const oe=e=>{b.sourceDBName?w.value.some((t=>t.targetDBName===e.title))?n.Z.error("The destination database is selected"):(w.value.unshift({sourceNodeName:b.sourceNodeName,sourceNodeInfo:b.sourceInfo,sourceDBName:b.sourceDBName,targetNodeName:e.parentName,targetNodeInfo:e.parentInfo,targetDBName:e.title,configType:1,taskParamsObject:{basic:[],more:[]}}),b.sourceInfo={},b.sourceNodeName="",b.sourceDBName="",v.value=[],g.value=[]):n.Z.error("The source database cannot be empty")},ne=e=>{w.value.splice(e,1)},re=()=>{$.value=!0},le=e=>{w.value=(0,o.IU)(e||r.subTaskConfig)};return t({init:le}),(0,o.bv)((()=>{ae(),le()})),(e,t)=>{const a=(0,o.up)("a-input"),n=(0,o.up)("a-link"),r=(0,o.up)("a-popover"),d=(0,o.up)("a-tree"),m=(0,o.up)("a-empty"),f=(0,o.up)("a-spin"),F=(0,o.up)("a-card"),X=(0,o.up)("icon-arrow-right"),Q=(0,o.up)("a-button"),ae=(0,o.up)("a-table-column"),le=(0,o.up)("icon-question-circle"),ie=(0,o.up)("a-option"),ue=(0,o.up)("a-select"),se=(0,o.up)("icon-delete"),ce=(0,o.up)("a-popconfirm"),de=(0,o.up)("a-table");return(0,o.wg)(),(0,o.iD)("div",y,[(0,o._)("div",h,[(0,o._)("div",k,[(0,o.Wm)(F,{bordered:"",style:{width:"400px"}},{title:(0,o.w5)((()=>[(0,o._)("div",_,[x,(0,o._)("div",N,[(0,o.Wm)(a,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=e=>c.value=e),placeholder:"输入名称搜索","allow-clear":""},null,8,["modelValue"])])])])),extra:(0,o.w5)((()=>[(0,o.Wm)(n,{onClick:re},{default:(0,o.w5)((()=>[(0,o.Uk)("+自定义数据库")])),_:1})])),default:(0,o.w5)((()=>[(0,o._)("div",W,[(0,o.Wm)(f,{loading:l.value,style:{display:"block"}},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{data:(0,o.SU)(L),"selected-keys":v.value,"onUpdate:selected-keys":t[1]||(t[1]=e=>v.value=e),blockNode:"","check-strictly":!0,"load-more":ee,"default-expand-all":!1,onSelect:J},{title:(0,o.w5)((t=>[(e.index=G(t?.title),e.index<0?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[1===t?.level?((0,o.wg)(),(0,o.j4)(r,{key:0},{content:(0,o.w5)((()=>[(0,o._)("p",null,"Host Name: "+(0,o.zw)(t?.name||"-"),1),(0,o._)("p",null,"Host IP: "+(0,o.zw)(t?.ip),1),(0,o._)("p",null,"Port: "+(0,o.zw)(t?.port),1)])),default:(0,o.w5)((()=>[(0,o._)("span",null,(0,o.zw)(t?.title),1)])),_:2},1024)):((0,o.wg)(),(0,o.iD)("span",I,(0,o.zw)(t?.title),1))],64)):((0,o.wg)(),(0,o.iD)("span",P,[(0,o.Uk)((0,o.zw)(t?.title?.substr(0,e.index))+" ",1),(0,o._)("span",U,(0,o.zw)(t?.title?.substr(e.index,c.value.length)),1),(0,o.Uk)((0,o.zw)(t?.title?.substr(e.index+c.value.length)),1)])))])),_:1},8,["data","selected-keys"]),i.value.length?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(m,{key:0}))])),_:1},8,["loading"])])])),_:1}),b.sourceDBName?((0,o.wg)(),(0,o.iD)("div",D,[j,(0,o._)("span",C,(0,o.zw)(b.sourceDBName),1)])):(0,o.kq)("",!0)]),(0,o._)("div",S,[(0,o.Wm)(X,{size:"40"})]),(0,o._)("div",V,[(0,o.Wm)(F,{bordered:"",style:{width:"400px"}},{title:(0,o.w5)((()=>[(0,o._)("div",O,[z,(0,o._)("div",H,[(0,o.Wm)(a,{modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=e=>p.value=e),placeholder:"输入名称搜索","allow-clear":""},null,8,["modelValue"])])])])),extra:(0,o.w5)((()=>[(0,o.Wm)(n,{onClick:re},{default:(0,o.w5)((()=>[(0,o.Uk)("+自定义数据库")])),_:1})])),default:(0,o.w5)((()=>[(0,o._)("div",T,[(0,o.Wm)(f,{loading:l.value,style:{display:"block"}},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{data:(0,o.SU)(Y),"selected-keys":g.value,"onUpdate:selected-keys":t[3]||(t[3]=e=>g.value=e),blockNode:"","check-strictly":!0,"load-more":te,"default-expand-all":!1},{title:(0,o.w5)((t=>[(e.index=R(t?.title),e.index<0?((0,o.wg)(),(0,o.iD)(o.HY,{key:0},[1===t?.level?((0,o.wg)(),(0,o.j4)(r,{key:0},{content:(0,o.w5)((()=>[(0,o._)("p",null,"Host Name: "+(0,o.zw)(t?.hostname||"-"),1),(0,o._)("p",null,"Host IP: "+(0,o.zw)(t?.publicIp),1),(0,o._)("p",null,"Port: "+(0,o.zw)(t?.hostPort),1)])),default:(0,o.w5)((()=>[(0,o._)("span",null,(0,o.zw)(t?.title),1)])),_:2},1024)):((0,o.wg)(),(0,o.iD)("div",K,[(0,o._)("span",null,(0,o.zw)(t?.title),1),t?.isLeaf&&t?.isSelect?((0,o.wg)(),(0,o.j4)(Q,{key:0,class:"add-sub-btn",type:"primary",size:"mini",onClick:e=>oe(t)},{default:(0,o.w5)((()=>[(0,o.Uk)("添加子任务")])),_:2},1032,["onClick"])):(0,o.kq)("",!0)]))],64)):((0,o.wg)(),(0,o.iD)("span",q,[(0,o.Uk)((0,o.zw)(t?.title?.substr(0,e.index))+" ",1),(0,o._)("span",B,(0,o.zw)(t?.title?.substr(e.index,p.value.length)),1),(0,o.Uk)((0,o.zw)(t?.title?.substr(e.index+p.value.length)),1)])))])),_:1},8,["data","selected-keys"]),u.value.length?(0,o.kq)("",!0):((0,o.wg)(),(0,o.j4)(m,{key:0}))])),_:1},8,["loading"])])])),_:1})])]),(0,o._)("div",Z,[(0,o.Wm)(de,{data:w.value,bordered:!1,stripe:"",pagination:!1},{columns:(0,o.w5)((()=>[(0,o.Wm)(ae,{title:"源实例名","data-index":"sourceNodeName",width:200,ellipsis:"",tooltip:""}),(0,o.Wm)(ae,{title:"源库名","data-index":"sourceDBName",width:200,ellipsis:"",tooltip:""}),(0,o.Wm)(ae,{title:"目的实例名","data-index":"targetNodeName",width:200,ellipsis:"",tooltip:""}),(0,o.Wm)(ae,{title:"目的库名","data-index":"targetDBName",width:200,ellipsis:"",tooltip:""}),(0,o.Wm)(ae,{"data-index":"mode",width:130},{title:(0,o.w5)((()=>[(0,o._)("div",null,[M,(0,o.Wm)(r,{position:"top"},{content:(0,o.w5)((()=>[E,A])),default:(0,o.w5)((()=>[(0,o.Wm)(le,{style:{cursor:"pointer","margin-left":"3px"},size:"15"})])),_:1})])])),cell:(0,o.w5)((({record:e})=>[(0,o.Wm)(ue,{modelValue:e.mode,"onUpdate:modelValue":t=>e.mode=t,placeholder:"请选择"},{default:(0,o.w5)((()=>[(0,o.Wm)(ie,{value:1},{default:(0,o.w5)((()=>[(0,o.Uk)("离线模式")])),_:1}),(0,o.Wm)(ie,{value:2},{default:(0,o.w5)((()=>[(0,o.Uk)("在线模式")])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:1}),(0,o.Wm)(ae,{title:"操作",align:"center",width:100,fixed:"right"},{cell:(0,o.w5)((({rowIndex:e})=>[(0,o.Wm)(ce,{content:"你确认删除此任务吗？",onOk:t=>ne(e)},{default:(0,o.w5)((()=>[(0,o.Wm)(Q,{size:"mini",type:"text"},{icon:(0,o.w5)((()=>[(0,o.Wm)(se)])),default:(0,o.w5)((()=>[(0,o.Uk)("删除")])),_:1})])),_:2},1032,["onOk"])])),_:1})])),_:1},8,["data"])]),(0,o.Wm)(s,{open:$.value,"onUpdate:open":t[4]||(t[4]=e=>$.value=e)},null,8,["open"])])}}};const L=(0,i.Z)($,[["__scopeId","data-v-2d4f24b3"]]);var Y=L;const F=e=>((0,o.dD)("data-v-6a05b232"),e=e(),(0,o.Cn)(),e),G={class:"title-con"},R={class:"params-title"},J={key:0,class:"params-info"},X={class:"config-con"},Q={key:0,class:"diy-info-con"},ee={class:"basic-config-con"},te=F((()=>(0,o._)("div",{class:"basic-title"},"基础参数",-1))),ae={class:"basic-params-table"},oe={class:"super-config-con"},ne={class:"super-params-table"},re={class:"footer-con"};var le={__name:"ParamsConfig",props:{open:Boolean,mode:[String,Number],globalParams:Object,countUseDefault:[String,Number],taskInfo:Object},emits:["update:open","syncGlobalParams","syncTaskParams"],setup(e,{emit:t}){const a=e,n=(0,o.iH)(!1),r=(0,o.iH)({borderRadius:"6px",marginBottom:"18px",border:"none",overflow:"hidden"}),l=(0,o.iH)([]),i=(0,o.qj)({basic:[],more:[]}),u=(0,o.iH)([]),s=(0,o.iH)([]),c=(0,o.iH)([]),d=(0,o.iH)([]),p=(0,o.qj)({basic:[],more:[]}),m=e=>c.value.some((t=>t.paramKey===e.raw.paramKey))?"row-changed":"",f=e=>d.value.some((t=>t.paramKey===e.raw.paramKey))?"row-changed":"";(0,o.YP)(n,(e=>{t("update:open",e)})),(0,o.YP)((()=>a.open),(e=>{e&&(u.value=[],s.value=[],2===a.mode&&(l.value=[{label:"源实例名：",value:a.taskInfo.sourceNodeName},{label:"目的实例名：",value:a.taskInfo.targetNodeName},{label:"源库名：",value:a.taskInfo.sourceDBName},{label:"目的库名：",value:a.taskInfo.targetDBName}]),v()),n.value=e})),(0,o.YP)(u,(e=>{c.value=e.filter((e=>{let t=!1;const a=i.basic.find((t=>t.paramKey===e.paramKey));return a.paramValue!==e.paramValue&&(t=!0),t}))}),{deep:!0}),(0,o.YP)(s,(e=>{d.value=e.filter((e=>{let t=!1;const a=i.more.find((t=>t.paramKey===e.paramKey));return a.paramValue!==e.paramValue&&(t=!0),t}))}),{deep:!0});const v=()=>{b().then((e=>{i.basic=e.data.slice(0,10),i.more=e.data.slice(10);const t=JSON.parse(JSON.stringify(e.data));u.value=t.slice(0,10),s.value=t.slice(10),1===a.mode?(a.globalParams.basic.length&&(c.value=a.globalParams.basic,u.value=u.value.map((e=>{const t=c.value.find((t=>t.paramKey===e.paramKey));return t||e}))),a.globalParams.more.length&&(d.value=a.globalParams.more,s.value=s.value.map((e=>{const t=d.value.find((t=>t.paramKey===e.paramKey));return t||e})))):(p.basic=a.taskInfo.taskParamsObject.basic,p.more=a.taskInfo.taskParamsObject.more,p.basic.length&&(c.value=p.basic,u.value=u.value.map((e=>{const t=c.value.find((t=>t.paramKey===e.paramKey));return t||e}))),p.more.length&&(d.value=p.more,s.value=s.value.map((e=>{const t=d.value.find((t=>t.paramKey===e.paramKey));return t||e}))))}))},g=()=>{u.value=JSON.parse(JSON.stringify(i.basic)),s.value=JSON.parse(JSON.stringify(i.more)),c.value=[],d.value=[]},w=()=>{1===a.mode?t("syncGlobalParams",{basic:c.value,more:d.value}):t("syncTaskParams",{basic:c.value,more:d.value}),n.value=!1};return(0,o.bv)((()=>{n.value=a.open})),(e,t)=>{const i=(0,o.up)("a-descriptions"),p=(0,o.up)("a-table-column"),v=(0,o.up)("a-input"),b=(0,o.up)("a-table"),y=(0,o.up)("a-collapse-item"),h=(0,o.up)("a-collapse"),k=(0,o.up)("a-button"),_=(0,o.up)("a-drawer");return(0,o.wg)(),(0,o.j4)(_,{visible:n.value,"onUpdate:visible":t[1]||(t[1]=e=>n.value=e),width:"600px","unmount-on-close":""},{title:(0,o.w5)((()=>[(0,o._)("div",G,[(0,o._)("span",R,(0,o.zw)(1===a.mode?"默认参数配置（全局配置）":"子任务参数配置"),1),1===a.mode?((0,o.wg)(),(0,o.iD)("span",J,[(0,o._)("b",null,(0,o.zw)(a.countUseDefault),1),(0,o.Uk)("个子任务使用了此配置")])):(0,o.kq)("",!0)])])),footer:(0,o.w5)((()=>[(0,o._)("div",re,[1!==a.mode&&(c.value.length||d.value.length)?((0,o.wg)(),(0,o.j4)(k,{key:0,type:"outline",style:{"margin-right":"10px"},onClick:g},{default:(0,o.w5)((()=>[(0,o.Uk)("恢复默认值")])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(k,{type:"primary",onClick:t[0]||(t[0]=e=>w())},{default:(0,o.w5)((()=>[(0,o.Uk)("保存")])),_:1})])])),default:(0,o.w5)((()=>[(0,o._)("div",X,[1!==a.mode?((0,o.wg)(),(0,o.iD)("div",Q,[(0,o.Wm)(i,{data:l.value,layout:"inline-horizontal",column:2,"table-layout":"fixed",bordered:""},null,8,["data"])])):(0,o.kq)("",!0),(0,o._)("div",ee,[te,(0,o._)("div",ae,[(0,o.Wm)(b,{data:u.value,hoverable:!1,bordered:!0,pagination:!1,"row-class":m},{columns:(0,o.w5)((()=>[(0,o.Wm)(p,{title:"参数名称","data-index":"paramKey",width:180,ellipsis:"",tooltip:""}),(0,o.Wm)(p,{title:"值","data-index":"paramValue"},{cell:(0,o.w5)((({record:e})=>[(0,o.Wm)(v,{modelValue:e.paramValue,"onUpdate:modelValue":t=>e.paramValue=t},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,o.Wm)(p,{title:"备注说明","data-index":"paramDesc",width:200,ellipsis:"",tooltip:""})])),_:1},8,["data"])])]),(0,o._)("div",oe,[(0,o.Wm)(h,{"default-active-key":[1],accordion:"",bordered:!1,"expand-icon-position":"right","show-expand-icon":!0},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{header:"高级参数",key:"1",style:(0,o.j5)(r.value)},{default:(0,o.w5)((()=>[(0,o._)("div",ne,[(0,o.Wm)(b,{data:s.value,hoverable:!1,bordered:!0,pagination:!1,"row-class":f},{columns:(0,o.w5)((()=>[(0,o.Wm)(p,{title:"参数名称","data-index":"paramKey",width:180,ellipsis:"",tooltip:""}),(0,o.Wm)(p,{title:"值","data-index":"paramValue"},{cell:(0,o.w5)((({record:e})=>[(0,o.Wm)(v,{modelValue:e.paramValue,"onUpdate:modelValue":t=>e.paramValue=t},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,o.Wm)(p,{title:"备注说明","data-index":"paramDesc",width:200,ellipsis:"",tooltip:""})])),_:1},8,["data"])])])),_:1},8,["style"])])),_:1})])])])),_:1},8,["visible"])}}};const ie=(0,i.Z)(le,[["__scopeId","data-v-6a05b232"]]);var ue=ie;const se={class:"step2-container"},ce={class:"warn-con"},de={class:"search-con"},pe={class:"table-con"};var me={__name:"index",props:{subTaskConfig:{type:Array,default:()=>[]},globalParams:Object},emits:["syncConfig","syncGlobalParams"],setup(e,{emit:t}){const a=e,n=(0,o.qj)({sourcedbKey:void 0,targetdbKey:void 0,mode:void 0,configType:void 0}),r=(0,o.qj)({total:0,current:1,pageSize:10}),l=(0,o.iH)([]),i=(0,o.iH)(!1),u=(0,o.iH)(1),s=(0,o.iH)(0),c=(0,o.iH)({}),d=e=>{t("syncGlobalParams",e)},p=e=>{c.value={...c.value,taskParamsObject:e};const a=l.value.findIndex((e=>e.sourceDBName===c.value.sourceDBName&&e.targetDBName===c.value.targetDBName));l.value.splice(a,1,(0,o.IU)(c.value)),t("syncConfig",(0,o.IU)(l.value))},m=(e,t)=>{i.value=!0,u.value=e,c.value=t;const n=(0,o.IU)(a.subTaskConfig).filter((e=>!e.taskParamsObject.basic.length&&!e.taskParamsObject.more.length))||[];s.value=n.length},f=e=>{r.current=e},v=()=>{r.current=1;const e=(0,o.IU)(a.subTaskConfig);l.value=e.filter((e=>{let t=!0;return!n.sourcedbKey||~e.sourceNodeName.indexOf(n.sourcedbKey)||~e.sourceDBName.indexOf(n.sourcedbKey)||(t=!1),!n.targetdbKey||~e.targetNodeName.indexOf(n.targetdbKey)||~e.targetDBName.indexOf(n.targetdbKey)||(t=!1),n.mode&&e.mode!==n.mode&&(t=!1),n.configType&&e.configType!==n.configType&&(t=!1),t})),r.total=l.value.length},g=()=>{n.sourcedbKey=void 0,n.targetdbKey=void 0,n.mode=void 0,n.configType=void 0,v()};return(0,o.bv)((()=>{l.value=(0,o.IU)(a.subTaskConfig),r.total=l.value.length})),(e,t)=>{const b=(0,o.up)("a-button"),w=(0,o.up)("a-alert"),y=(0,o.up)("a-input"),h=(0,o.up)("a-form-item"),k=(0,o.up)("a-option"),_=(0,o.up)("a-select"),x=(0,o.up)("icon-search"),N=(0,o.up)("icon-sync"),W=(0,o.up)("a-form"),I=(0,o.up)("a-table-column"),P=(0,o.up)("icon-edit"),U=(0,o.up)("a-table");return(0,o.wg)(),(0,o.iD)("div",se,[(0,o._)("div",ce,[(0,o.Wm)(w,null,{action:(0,o.w5)((()=>[(0,o.Wm)(b,{size:"small",type:"primary",onClick:t[0]||(t[0]=e=>m(1))},{default:(0,o.w5)((()=>[(0,o.Uk)("默认参数配置(全局配置)")])),_:1})])),default:(0,o.w5)((()=>[(0,o.Uk)(" 提示：每个迁移过程都需要有参数配置，DataKit已经为每一个迁移过程（即子任务）配置了默认参数。 ")])),_:1}),(0,o.Wm)(w,{style:{"margin-top":"10px"}},{default:(0,o.w5)((()=>[(0,o.Uk)("提示：您也可以在下表中修改某个迁移过程（即子任务）的参数配置，来确保迁移过程顺利执行。")])),_:1})]),(0,o._)("div",de,[(0,o.Wm)(W,{model:n,layout:"inline"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{field:"sourcedbKey"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{modelValue:n.sourcedbKey,"onUpdate:modelValue":t[1]||(t[1]=e=>n.sourcedbKey=e),modelModifiers:{trim:!0},"allow-clear":"",placeholder:"请输入源实例名/库名",onChange:v},null,8,["modelValue"])])),_:1}),(0,o.Wm)(h,{field:"targetdbKey"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{modelValue:n.targetdbKey,"onUpdate:modelValue":t[2]||(t[2]=e=>n.targetdbKey=e),modelModifiers:{trim:!0},"allow-clear":"",placeholder:"请输入目的实例名/库名",onChange:v},null,8,["modelValue"])])),_:1}),(0,o.Wm)(h,{field:"mode"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{modelValue:n.mode,"onUpdate:modelValue":t[3]||(t[3]=e=>n.mode=e),placeholder:"请选择迁移模式","allow-clear":"",onChange:v},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{value:1},{default:(0,o.w5)((()=>[(0,o.Uk)("离线模式")])),_:1}),(0,o.Wm)(k,{value:2},{default:(0,o.w5)((()=>[(0,o.Uk)("在线模式")])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(h,{field:"configType"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{modelValue:n.configType,"onUpdate:modelValue":t[4]||(t[4]=e=>n.configType=e),placeholder:"请选择配置类型","allow-clear":"",onChange:v},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{value:1},{default:(0,o.w5)((()=>[(0,o.Uk)("默认配置")])),_:1}),(0,o.Wm)(k,{value:2},{default:(0,o.w5)((()=>[(0,o.Uk)("个性化配置")])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[(0,o.Wm)(b,{type:"outline",onClick:v},{icon:(0,o.w5)((()=>[(0,o.Wm)(x)])),default:(0,o.w5)((()=>[(0,o.Uk)("查询")])),_:1}),(0,o.Wm)(b,{style:{"margin-left":"10px"},onClick:g},{icon:(0,o.w5)((()=>[(0,o.Wm)(N)])),default:(0,o.w5)((()=>[(0,o.Uk)("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),(0,o._)("div",pe,[(0,o.Wm)(U,{data:l.value,bordered:!1,stripe:"",pagination:r,onPageChange:f},{columns:(0,o.w5)((()=>[(0,o.Wm)(I,{title:"源实例名","data-index":"sourceNodeName"}),(0,o.Wm)(I,{title:"源IP和端口"},{cell:(0,o.w5)((({record:e})=>[(0,o.Uk)((0,o.zw)(e.sourceNodeInfo.host+":"+e.sourceNodeInfo.port),1)])),_:1}),(0,o.Wm)(I,{title:"源库名","data-index":"sourceDBName"}),(0,o.Wm)(I,{title:"目的实例名","data-index":"targetNodeName"}),(0,o.Wm)(I,{title:"目的IP和端口"},{cell:(0,o.w5)((({record:e})=>[(0,o.Uk)((0,o.zw)(e.targetNodeInfo.host+":"+e.targetNodeInfo.port),1)])),_:1}),(0,o.Wm)(I,{title:"目的库名","data-index":"targetDBName"}),(0,o.Wm)(I,{title:"迁移过程模式","data-index":"mode"},{cell:(0,o.w5)((({record:e})=>[(0,o.Uk)((0,o.zw)(1===e.mode?"离线模式":"在线模式"),1)])),_:1}),(0,o.Wm)(I,{title:"操作",align:"center",width:160,fixed:"right"},{cell:(0,o.w5)((({record:e})=>[(0,o.Wm)(b,{size:"mini",type:"text",onClick:t=>m(2,e)},{icon:(0,o.w5)((()=>[(0,o.Wm)(P)])),default:(0,o.w5)((()=>[(0,o.Uk)("编辑配置参数")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","pagination"])]),(0,o.Wm)(ue,{open:i.value,"onUpdate:open":t[5]||(t[5]=e=>i.value=e),mode:u.value,"global-params":a.globalParams,"count-use-default":s.value,"task-info":c.value,onSyncGlobalParams:d,onSyncTaskParams:p},null,8,["open","mode","global-params","count-use-default","task-info"])])}}};const fe=(0,i.Z)(me,[["__scopeId","data-v-3313e52d"]]);var ve=fe;const ge={class:"step3-container"},be={class:"warn-con"},we={class:"search-con"},ye={class:"table-con"},he={class:"select-tips"},ke={class:"tips-item"},_e={class:"tips-item"};var xe={__name:"index",props:{subTaskConfig:{type:Array,default:()=>[]},hostData:{type:Array,default:()=>[]}},emits:["syncHost"],setup(e,{emit:t}){const a=e,n=(0,o.iH)(!0),r=(0,o.qj)({ip:void 0}),l=(0,o.qj)({pageNum:1,pageSize:10}),i=(0,o.qj)({total:0,current:1,pageSize:10}),u=(0,o.iH)([]),s=(0,o.iH)([]),c=(0,o.qj)({type:"checkbox",showCheckedAll:!0,onlyCurrent:!1}),d=e=>{l.pageNum=e,i.current=e},m=e=>{t("syncHost",e)},f=()=>{n.value=!0,p().then((e=>{n.value=!1,u.value=e.data,i.total=e.data.length})).catch((()=>{n.value=!1}))};return(0,o.bv)((()=>{f(),s.value=(0,o.IU)(a.hostData)})),(e,t)=>{const l=(0,o.up)("a-alert"),p=(0,o.up)("a-input"),f=(0,o.up)("a-form-item"),v=(0,o.up)("icon-search"),g=(0,o.up)("a-button"),b=(0,o.up)("icon-sync"),w=(0,o.up)("a-form"),y=(0,o.up)("a-table-column"),h=(0,o.up)("a-table");return(0,o.wg)(),(0,o.iD)("div",ge,[(0,o._)("div",be,[(0,o.Wm)(l,null,{default:(0,o.w5)((()=>[(0,o.Uk)("提示：DataKit本着资源利用最大化原则尽量让子任务并行执行，为每个子任务创建一个数据迁移代理（一台机器可以创建多个迁移代理），在资源不足时则等待资源顺序执行。")])),_:1})]),(0,o._)("div",we,[(0,o.Wm)(w,{model:r,layout:"inline"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{field:"ip"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:r.ip,"onUpdate:modelValue":t[0]||(t[0]=e=>r.ip=e),"allow-clear":"",placeholder:"请输入IP地址"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(f,{field:"ip"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:r.ip,"onUpdate:modelValue":t[1]||(t[1]=e=>r.ip=e),"allow-clear":"",placeholder:"请输入物理机地址"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(f,{field:"ip"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:r.ip,"onUpdate:modelValue":t[2]||(t[2]=e=>r.ip=e),"allow-clear":"",placeholder:"请输入cpu核心数"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(f,{field:"ip"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:r.ip,"onUpdate:modelValue":t[3]||(t[3]=e=>r.ip=e),"allow-clear":"",placeholder:"请输入内存大小"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(f,{field:"ip"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:r.ip,"onUpdate:modelValue":t[4]||(t[4]=e=>r.ip=e),"allow-clear":"",placeholder:"请输入硬盘空闲大小"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[(0,o.Wm)(g,{type:"outline"},{icon:(0,o.w5)((()=>[(0,o.Wm)(v)])),default:(0,o.w5)((()=>[(0,o.Uk)("查询")])),_:1}),(0,o.Wm)(g,{style:{"margin-left":"10px"}},{icon:(0,o.w5)((()=>[(0,o.Wm)(b)])),default:(0,o.w5)((()=>[(0,o.Uk)("重置")])),_:1})])),_:1})])),_:1},8,["model"])]),(0,o._)("div",ye,[(0,o._)("div",he,[(0,o._)("span",ke,[(0,o.Uk)("迁移子任务："),(0,o._)("b",null,(0,o.zw)(a.subTaskConfig.length),1),(0,o.Uk)("个")]),(0,o._)("span",_e,[(0,o.Uk)("已选择机器："),(0,o._)("b",null,(0,o.zw)(s.value.length),1),(0,o.Uk)("台")])]),(0,o.Wm)(h,{loading:n.value,"row-key":"hostId",data:u.value,"row-selection":c,selectedKeys:s.value,"onUpdate:selectedKeys":t[5]||(t[5]=e=>s.value=e),bordered:!1,stripe:"",pagination:i,onPageChange:d,onSelectionChange:m},{columns:(0,o.w5)((()=>[(0,o.Wm)(y,{title:"物理机IP","data-index":"publicIp"}),(0,o.Wm)(y,{title:"物理机名称+OS","data-index":"hostname"}),(0,o.Wm)(y,{title:"配置信息"},{cell:(0,o.w5)((({record:e})=>[(0,o.Uk)((0,o.zw)(e.os?"系统："+e.os+",":"")+" "+(0,o.zw)(e.os?"CPU架构："+e.cpuArch:""),1)])),_:1}),(0,o.Wm)(y,{title:"最大子任务数","data-index":"d"}),(0,o.Wm)(y,{title:"正在执行子任务数","data-index":"tasks",align:"center"},{cell:(0,o.w5)((({record:e})=>[(0,o.Uk)((0,o.zw)(e.tasks.length),1)])),_:1}),(0,o.Wm)(y,{title:"正在执行的子任务","data-index":"tasks"},{cell:(0,o.w5)((({record:e})=>[(0,o.Uk)((0,o.zw)(e.tasks.map((e=>`#${e.id}`)).join(", ")),1)])),_:1})])),_:1},8,["loading","data","row-selection","selectedKeys","pagination"])])])}}};const Ne=(0,i.Z)(xe,[["__scopeId","data-v-3c6f03d4"]]);var We=Ne,Ie=a(2649);const Pe=e=>((0,o.dD)("data-v-368cd329"),e=e(),(0,o.Cn)(),e),Ue={class:"home-container"},De={class:"title-con"},je=Pe((()=>(0,o._)("div",{class:"title"},"创建数据迁移任务",-1))),Ce={class:"task-name-con"},Se=Pe((()=>(0,o._)("span",{class:"task-name"},[(0,o._)("i",null,"*"),(0,o.Uk)("任务名称")],-1))),Ve={class:"task-steps-con"},Oe={class:"submit-con"};var ze={__name:"index",setup(e){const t=(0,o.iH)(1),a=(0,o.iH)(),r=(0,o.iH)(""),l=(0,o.iH)([]),i=(0,o.qj)({basic:[],more:[]}),u=(0,o.iH)([]),s=(0,o.iH)(null),c=()=>{t.value=Math.max(1,t.value-1)},d=()=>{1!==t.value||l.value.length?l.value.length&&l.value.some((e=>!e.mode))?n.Z.error("Please select a migration mode for subtasks"):t.value=Math.min(3,t.value+1):n.Z.error("Please add subtasks")},p=e=>{console.log(e),l.value=e},m=e=>{i.basic=e.basic,i.more=e.more},f=e=>{u.value=e},b=()=>{if(!r.value)return void n.Z.error("Task name cannot be empty");if(!u.value.length)return void n.Z.error("Please select a migration machine");const e={taskName:r.value,globalParams:[...i.basic.map((e=>({paramKey:e.paramKey,paramValue:e.paramValue,paramDesc:e.paramDesc}))),...i.more.map((e=>({paramKey:e.paramKey,paramValue:e.paramValue,paramDesc:e.paramDesc})))],hostIds:u.value,tasks:l.value.map((e=>({migrationModelId:e.mode,sourceDb:e.sourceDBName,sourceDbHost:e.sourceNodeInfo.host,sourceDbPass:e.sourceNodeInfo.password,sourceDbPort:e.sourceNodeInfo.port,sourceDbUser:e.sourceNodeInfo.username,sourceNodeId:e.sourceNodeInfo.nodeId,targetDb:e.targetDBName,targetDbHost:e.targetNodeInfo.host,targetDbPass:e.targetNodeInfo.password,targetDbPort:e.targetNodeInfo.port,targetDbUser:e.targetNodeInfo.username,targetDbVersion:e.targetNodeInfo.versionNum,targetNodeId:e.targetNodeInfo.nodeId,taskParams:[...e.taskParamsObject.basic.map((e=>({paramKey:e.paramKey,paramValue:e.paramValue,paramDesc:e.paramDesc}))),...e.taskParamsObject.more.map((e=>({paramKey:e.paramKey,paramValue:e.paramValue,paramDesc:e.paramDesc})))]})))};a.value?(e["taskId"]=a.value,g(e).then((()=>{n.Z.success("Update success"),window.$wujie?.bus.$emit("data-migration-update"),window.$wujie?.bus.$emit("opengauss-close-tab",{name:"Static-pluginData-migrationTaskConfig",fullPath:"/static-plugin/data-migration/taskConfig"}),window.$wujie?.props.methods.jump({name:"Static-pluginData-migrationIndex"})}))):v(e).then((()=>{n.Z.success("Save success"),window.$wujie?.bus.$emit("data-migration-update"),window.$wujie?.bus.$emit("opengauss-close-tab",{name:"Static-pluginData-migrationTaskConfig",fullPath:"/static-plugin/data-migration/taskConfig"}),window.$wujie?.props.methods.jump({name:"Static-pluginData-migrationIndex"})}))},w=e=>{(0,Ie.zN)(e).then((e=>{const t=e.data;a.value=t.taskId,r.value=t.taskName,u.value=t.hostIds,i.basic=t.globalParams,i.more=[],l.value=t.tasks.map((e=>({mode:e.migrationModelId,sourceDBName:e.sourceDb,sourceNodeName:e.sourceDbHost,sourceNodeInfo:{host:e.sourceDbHost,password:e.sourceDbPass,port:e.sourceDbPort,username:e.sourceDbUser,nodeId:e.sourceNodeId},targetDBName:e.targetDb,targetNodeName:e.targetDbHost,targetNodeInfo:{host:e.targetDbHost,password:e.targetDbPass,port:e.targetDbPort,username:e.targetDbUser,versionNum:e.targetDbVersion,nodeId:e.targetNodeId},taskParamsObject:{basic:e.taskParams,more:[]}}))),s.value.init(l.value)}))};return(0,o.bv)((()=>{const e=window.$wujie?.props.data.id;e&&w(e)})),(e,a)=>{const n=(0,o.up)("a-input"),v=(0,o.up)("a-divider"),g=(0,o.up)("a-step"),w=(0,o.up)("a-steps"),y=(0,o.up)("a-button");return(0,o.wg)(),(0,o.iD)("div",Ue,[(0,o._)("div",De,[je,(0,o._)("div",Ce,[Se,(0,o.Wm)(n,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=e=>r.value=e),modelModifiers:{trim:!0},placeholder:"请输入任务名称",style:{width:"250px"}},null,8,["modelValue"])])]),(0,o.Wm)(v),(0,o._)("div",Ve,[(0,o.Wm)(w,{current:t.value},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{description:"1个子任务是1个源库到1个目的库的迁移过程"},{default:(0,o.w5)((()=>[(0,o.Uk)("选择迁移源库和目的库")])),_:1}),(0,o.Wm)(g,{description:"确定每一个迁移过程的执行参数"},{default:(0,o.w5)((()=>[(0,o.Uk)("配置迁移过程参数")])),_:1}),(0,o.Wm)(g,{description:"选择合适的机器执行迁移过程"},{default:(0,o.w5)((()=>[(0,o.Uk)("分配执行机资源")])),_:1})])),_:1},8,["current"])]),1===t.value?((0,o.wg)(),(0,o.j4)((0,o.SU)(Y),{key:0,ref_key:"stepOneComp",ref:s,"sub-task-config":l.value,onSyncConfig:p},null,8,["sub-task-config"])):(0,o.kq)("",!0),2===t.value?((0,o.wg)(),(0,o.j4)((0,o.SU)(ve),{key:1,"sub-task-config":l.value,"global-params":i,onSyncConfig:p,onSyncGlobalParams:m},null,8,["sub-task-config","global-params"])):(0,o.kq)("",!0),3===t.value?((0,o.wg)(),(0,o.j4)((0,o.SU)(We),{key:2,"sub-task-config":l.value,"host-data":u.value,onSyncHost:f},null,8,["sub-task-config","host-data"])):(0,o.kq)("",!0),(0,o._)("div",Oe,[2===t.value||3===t.value?((0,o.wg)(),(0,o.j4)(y,{key:0,type:"outline",class:"btn-item",onClick:c},{default:(0,o.w5)((()=>[(0,o.Uk)("上一步")])),_:1})):(0,o.kq)("",!0),1===t.value||2===t.value?((0,o.wg)(),(0,o.j4)(y,{key:1,type:"primary",class:"btn-item",onClick:d},{default:(0,o.w5)((()=>[(0,o.Uk)("下一步")])),_:1})):(0,o.kq)("",!0),3===t.value?((0,o.wg)(),(0,o.j4)(y,{key:2,type:"primary",class:"btn-item",onClick:b},{default:(0,o.w5)((()=>[(0,o.Uk)("完成")])),_:1})):(0,o.kq)("",!0)])])}}};const He=(0,i.Z)(ze,[["__scopeId","data-v-368cd329"]]);var Te=He}}]);
//# sourceMappingURL=545.965f6831.js.map