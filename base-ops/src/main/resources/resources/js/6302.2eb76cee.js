"use strict";(self["webpackChunkweb_ui"]=self["webpackChunkweb_ui"]||[]).push([[6302,733],{89965:function(e,t,a){a.d(t,{AH:function(){return g},Bd:function(){return f},C7:function(){return S},DG:function(){return L},Du:function(){return z},H7:function(){return E},Iz:function(){return T},J6:function(){return Z},Jh:function(){return b},NQ:function(){return _},QS:function(){return B},Qt:function(){return V},R7:function(){return y},Rq:function(){return c},SB:function(){return p},SW:function(){return C},UL:function(){return m},Up:function(){return w},WK:function(){return D},Yn:function(){return I},gp:function(){return s},j9:function(){return P},nB:function(){return k},qR:function(){return N},qo:function(){return v},sZ:function(){return q},v$:function(){return u},vs:function(){return r},w0:function(){return U},wB:function(){return O},x9:function(){return F},xl:function(){return x},yA:function(){return d},yf:function(){return $}});var o=a(15784),n=a(9669),l=a.n(n),i=a(90989);const r=(e,t,a,o)=>l().get(`/modeling/dataflow/dataSourceDb/getTablesBySchema/${e}/${t}/${a}`,o||{}),d=(e,t)=>l().get(`/modeling/dataflow/dataSourceDb/getFieldsByTable/${e}`,t||{}),s=e=>l().get("/modeling/dataflow/list",{params:e}),u=e=>l().post("/modeling/dataflow/add",e||{}),c=e=>l()["delete"](`/modeling/dataflow/delete/${e}`),m=e=>l().put("/modeling/dataflow/edit",e||{}),f=e=>l().get(`/modeling/dataflow/getById/${e}`),p=(e,t)=>l().get(`/modeling/dataflow/dataSourceDb/getSchemaByClusterNodeId/${e}/${t}`,e||{}),g=e=>l().post("/modeling/dataflow/getSql",e||{}),b=e=>l().post("/modeling/dataflow/runSql",e||{});let h=!0;const w=(e,t,a)=>new Promise((n=>{h&&(h=!1,l().put("/modeling/dataflow/edit",{id:e,operatorContent:JSON.stringify(t)}).then((e=>{n(!0),h=!0,200===Number(e.code)&&(a||o.Z.success({content:i.Z.global.t("modeling.dy_common.saveSuccess")}))})).catch((()=>{n(!1),a||o.Z.error({content:i.Z.global.t("modeling.dy_common.saveFailed")}),h=!0})))})),v=e=>l().get("/modeling/dataflow/dataSourceDb/list",e||{}),D=e=>l().post("/modeling/dataflow/getResultFieldsByOperator",e||{}),C=e=>l().post("/modeling/dataflow/visualization/params/add",e||{}),$=e=>l().put("/modeling/dataflow/visualization/params/edit",e||{}),y=e=>l()["delete"](`/modeling/dataflow/visualization/params/delete/${e}`),x=e=>l().post("/modeling/dataflow/visualization/params/generateChart",e||{}),k=(e,t)=>l().get(`/modeling/dataflow/visualization/params/getListByOperatorId/${e}`,t||{}),N=e=>l().post("/modeling/dataflow/visualization/snapshot/add",e||{}),B=(e,t)=>l().get(`/modeling/dataflow/visualization/snapshot/getListByDataFlowId/${e}`,t||{}),V=e=>l()["delete"](`/modeling/dataflow/visualization/snapshot/delete/${e}`),q=(e,t)=>l().get(`/modeling/dataflow/visualization/report/getListByDataFlowId/${e}`,{params:t||{}}),O=e=>l().post("/modeling/dataflow/visualization/report/add",e||{}),S=e=>l().put("/modeling/dataflow/visualization/report/update",e||{}),T=e=>l()["delete"](`/modeling/dataflow/visualization/report/delete/${e}`),z=e=>l().get(`/modeling/dataflow/visualization/report/share/getByReportId/${e}`),I=(e,t)=>l().get(`/modeling/dataflow/visualization/customDimension/getListByOperatorId/${e}`,{params:t||{}}),Z=e=>l().post("/modeling/dataflow/visualization/customDimension/add",e||{}),_=e=>l().put("/modeling/dataflow/visualization/customDimension/edit",e||{}),E=e=>l()["delete"](`/modeling/dataflow/visualization/customDimension/delete/${e}`),F=(e,t)=>l().get(`/modeling/visualization/report/share/getMapGeo/${e}`,t||{}),L=e=>l().post("/modeling/dataflow/visualization/params/uploadGeo",e||{}),U=(e,t)=>l().get(`/modeling/dataflow/visualization/params/getGeo/${e}`,{params:t||{}}),P=e=>l()["delete"](`/modeling/dataflow/visualization/params/deleteGeo/${e}`)},8603:function(e,t,a){a.d(t,{M:function(){return r}});a(57658);var o=a(89965),n=a(95684),l=a(15784);const i={graph:null,dataFlowInfo:{},rawData:{},useData:{},useDatabase:"",useTable:[]},r=(0,n.Q_)("dataFlow",{state(){return JSON.parse(JSON.stringify(i))},getters:{getTableSelectList:e=>e.useDatabase?e.useData[e.useDatabase]:[],getFieldsSelectList:e=>{if(e.useDatabase&&e.useTable.length>0){const t=e.useData[e.useDatabase],a=[];return e.useTable.forEach((e=>{const o={group:e,fields:[]},n=t.findIndex((t=>t.tablename===e));-1!==n&&(o.fields=t[n].fields),a.push(o)})),a}return[]},getFlowDataInfo:e=>e.dataFlowInfo,getFieldsByTable:e=>t=>{if(e.useDatabase){const a=e.useData[e.useDatabase];if(0===t||"0"===t){const t=a.findIndex((t=>t.tablename===e.useTable[0]));return-1===t?[]:a[t].fields}{const e=a.findIndex((e=>e.tablename===t));return-1===e?[]:a[e].fields}}return[]},getUseTable:e=>e.useTable,getUseDatabase:e=>e.useDatabase},actions:{setGraph(e){this.$patch((t=>{t.graph=e}))},initState(){return new Promise((e=>{this.$patch((t=>{t.useData=[],t.useDatabase="",t.useTable=[],t.rawData=[],t.dataFlowInfo=[],e(!0)}))}))},clearUse(){return new Promise((e=>{this.$patch((t=>{t.useDatabase="",t.useTable=[],e(!0)}))}))},setFlowDataInfo(e){this.$patch((t=>t.dataFlowInfo=e))},setDatabaseInfo(e,t,a){return new Promise(((n,i)=>{this.$patch((r=>{r.useDatabase=`${e}|,|${t}|,|${a}`,r.useTable=[],Object.keys(r.rawData).includes(`${e}|,|${t}|,|${a}`)?n(!0):(0,o.vs)(e,t,a).then((o=>{if(200===Number(o.code)){const l=o.data.map((e=>({...e,tables:{}})));r.rawData[`${e}|,|${t}|,|${a}`]=l,r.useData[`${e}|,|${t}|,|${a}`]=l,n(!0)}else l.Z.error("database not found"),i(!0)})).catch((()=>{l.Z.error("database not found"),i(!0)}))}))}))},setDatabaseTableInfo(e,t){return new Promise((a=>{this.$patch((n=>{if(e){t&&(t.tableKey||0===t.tableKey)?n.useTable[t.tableKey]=e:t&&t.noUse||n.useTable.push(e);const l=n.rawData[n.useDatabase].findIndex((t=>t.tablename===e));Object.keys(n.rawData[n.useDatabase][l].tables).includes(e)?a(!1):(0,o.yA)(`${n.useDatabase.split("|,|").join("/")}/${e}`).then((e=>{a(!0),n.rawData[n.useDatabase][l].fields=e.data,n.useData[n.useDatabase][l].fields=e.data}))}else a(!1)}))}))},removeDatabaseTable(e){return new Promise((t=>{this.$patch((a=>{const o=a.useTable.indexOf(e);-1!==o?(a.useTable.splice(o,1),t(!0)):t(!1)}))}))}}})},733:function(e,t,a){a.r(t),a.d(t,{checkDisabled:function(){return o},saveData:function(){return n}});const o=(e,t,a)=>{if(!e||0===e.length)return!1;if("string"===typeof e[0]||"number"===typeof e[0])return-1!==e.indexOf(t);{const o=e;return-1!==o.findIndex((e=>e[a||"value"]===t))}},n=(e,t,a)=>{if(console.log(e,t,a),a){const o=a.getData();a?.setData({...o,[e]:JSON.parse(JSON.stringify(t))},{overwrite:!0})}}},63736:function(e,t,a){a.r(t),a.d(t,{default:function(){return d}});var o=a(70821),n=a(29067),l=(0,o.defineComponent)({props:{content:{type:String,required:!0},text:{type:String,required:!0},otherWidth:{type:Number,required:!1},fontSize:{type:Number,required:!1}},setup(e){const t=e,a=(0,o.ref)(),l=(0,o.ref)(!1),i=()=>{let e=a.value.parentNode.offsetWidth,o=a.value.offsetWidth+(t.otherWidth||0===t.otherWidth?t.otherWidth:24);l.value=!(o>e)};return(e,r)=>((0,o.openBlock)(),(0,o.createBlock)((0,o.unref)(n.Z),{content:t.content,disabled:l.value},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",{onMouseover:i},[(0,o.renderSlot)(e.$slots,"default")],32),(0,o.createElementVNode)("span",{class:"get-width",ref:(e,t)=>{t["contentRef"]=e,a.value=e}},(0,o.toDisplayString)(t.text),513)])),_:3},8,["content","disabled"]))}}),i=a(83744);const r=(0,i.Z)(l,[["__scopeId","data-v-6f1614ab"]]);var d=r},76302:function(e,t,a){a.r(t),a.d(t,{default:function(){return V}});a(57658);var o=a(70821),n=a(96336),l=a(73019),i=a(62e3),r=a(51121),d=a(2768),s=a(18933),u=a(58478),c=a(733),m=a(8603),f=a(63736),p=a(57330);const g={class:"tab-content d-a-form"},b={class:"or-frame"},h={key:0,class:"or-item-ortext"},w={class:"d-frame"},v={class:"d-form-item-label mb-s"},D={class:"label-text"},C=["onClick"],$=["onClick"],y=["onClick"],x={class:"flex-right",style:{"margin-top":"10px"}};var k=(0,o.defineComponent)({setup(e,{expose:t}){const{t:a}=(0,p.QT)(),k=n.ZP.Option,N=n.ZP.OptGroup,B=(0,m.M)(),V=(0,o.computed)((()=>({connectType:[{value:a("modeling.combination.ConditionOperator.5m82aq4s8ts0"),label:a("modeling.combination.ConditionOperator.5m82aq4s8ts0")}],condition:[{value:"equal",label:a("modeling.combination.ConditionOperator.5m82aq4s8wc0")},{value:"notEqual",label:a("modeling.combination.ConditionOperator.5m82aq4s8yo0")},{value:"lessThan",label:a("modeling.combination.ConditionOperator.5m82aq4s9180")},{value:"equalLessThan",label:a("modeling.combination.ConditionOperator.5m82aq4s93k0")},{value:"greaterThan",label:a("modeling.combination.ConditionOperator.5m82aq4s95s0")},{value:"equalGreaterThan",label:a("modeling.combination.ConditionOperator.5m82aq4s98c0")},{value:"include",label:a("modeling.combination.ConditionOperator.5m82aq4s9ao0")},{value:"notInclude",label:a("modeling.combination.ConditionOperator.5m82aq4s9cw0")},{value:"isNull",label:a("modeling.combination.ConditionOperator.5m82aq4s9fk0")},{value:"notNull",label:a("modeling.combination.ConditionOperator.5m82aq4s9i00")}]}))),q=(0,o.computed)((()=>B.getFieldsSelectList)),O=(0,o.reactive)({activeKey:"1",cell:null,or:[]}),S=e=>{O.cell=e;let{data:t}=e;O.or=t.or&&0!==t.or.length?t.or:[[]]},T=(e,t,a)=>{"add"===e?O.or.push([]):"delete"===e?O.or.splice(t,1):"addAnd"!==e||0!==t&&!t?"deleteAnd"!==e||0!==t&&!t||0!==a&&!a||O.or[t].splice(a,1):O.or[t].push({field:null,condition:null,value:""}),(0,c.saveData)("or",O.or,O.cell)},z=e=>{e.condition===a("modeling.combination.ConditionOperator.5m82aq4s9i00")?e.value=a("modeling.combination.ConditionOperator.5m82aq4s9i00"):e.value="",(0,c.saveData)("or",O.or,O.cell)};return t({init:S}),(e,t)=>((0,o.openBlock)(),(0,o.createBlock)((0,o.unref)(l.Z),{class:"d-a-tabs",activeKey:(0,o.unref)(O).activeKey,"onUpdate:activeKey":t[3]||(t[3]=e=>(0,o.unref)(O).activeKey=e),centered:"",size:"mini",tabBarGutter:40,tabBarStyle:{color:"#fff"}},{default:(0,o.withCtx)((()=>[(0,o.createVNode)((0,o.unref)(i.Z),{key:"1",title:e.$t("modeling.combination.ConditionOperator.5m82aq4s7qo0")},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",g,[(0,o.withDirectives)((0,o.createElementVNode)("div",b,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(O).or,((a,l)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"or-item",key:`or${l}`},[0!==l?((0,o.openBlock)(),(0,o.createElementBlock)("div",h,(0,o.toDisplayString)(e.$t("modeling.combination.ConditionOperator.5m82aq4s8cw0")),1)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",w,[(0,o.createElementVNode)("div",v,[(0,o.createElementVNode)("div",D,(0,o.toDisplayString)(e.$t("modeling.combination.ConditionOperator.5m82aq4s8gw0")),1),(0,o.createElementVNode)("div",{class:"d-control-add",onClick:e=>T("addAnd",l)},"+",8,C),(0,o.createElementVNode)("div",{class:"d-control-remove",onClick:e=>T("delete",l)},"-",8,$)]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a,((a,i)=>((0,o.openBlock)(),(0,o.createBlock)((0,o.unref)(r.Z),{align:"center",class:"mb-s",key:`item${i}`},{default:(0,o.withCtx)((()=>[(0,o.createVNode)((0,o.unref)(d.Z),{span:8,class:"mr-xs"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)((0,o.unref)(n.ZP),{modelValue:a.field,"onUpdate:modelValue":e=>a.field=e,placeholder:e.$t("modeling.combination.ConditionOperator.5m82aq4s8js0"),"trigger-props":{contentClass:"d-a-select-dropdown"},showSearch:"",style:{width:"100%"},onChange:t[0]||(t[0]=e=>(0,o.unref)(c.saveData)("or",(0,o.unref)(O).or,(0,o.unref)(O).cell))},{label:(0,o.withCtx)((({data:e})=>[(0,o.createVNode)(f["default"],{text:e?.label,content:e?.label,"other-width":0},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e?.label),1)])),_:2},1032,["text","content"])])),default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)((0,o.unref)(q),((e,t)=>((0,o.openBlock)(),(0,o.createBlock)((0,o.unref)(N),{key:`fieldsGroup${t}`,label:e.group},{label:(0,o.withCtx)((()=>[(0,o.createVNode)(f["default"],{text:e.group,content:e.group},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.group),1)])),_:2},1032,["text","content"])])),default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.fields,((t,a)=>((0,o.openBlock)(),(0,o.createBlock)(f["default"],{text:t.name,key:`field${a}`,content:`${e.group} . ${t.name}`},{default:(0,o.withCtx)((()=>[(0,o.createVNode)((0,o.unref)(k),{value:`${e.group}.${t.name}`,label:t.name},null,8,["value","label"])])),_:2},1032,["text","content"])))),128))])),_:2},1032,["label"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1024),(0,o.createVNode)((0,o.unref)(d.Z),{span:6,class:"mr-xs"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)((0,o.unref)(n.ZP),{modelValue:a.condition,"onUpdate:modelValue":e=>a.condition=e,options:(0,o.unref)(V).condition,onChange:e=>z(a),placeholder:e.$t("modeling.combination.ConditionOperator.5m82aq4s8m40"),style:{width:"100%"},"trigger-props":{contentClass:"d-a-select-dropdown"}},null,8,["modelValue","onUpdate:modelValue","options","onChange","placeholder"])])),_:2},1024),(0,o.createVNode)((0,o.unref)(d.Z),{span:8,class:"mr-xs"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createVNode)((0,o.unref)(s.ZP),{"max-length":140,"show-word-limit":"",modelValue:a.value,"onUpdate:modelValue":e=>a.value=e,placeholder:e.$t("modeling.combination.ConditionOperator.5m82aq4s8ow0"),onBlur:t[1]||(t[1]=e=>(0,o.unref)(c.saveData)("or",(0,o.unref)(O).or,(0,o.unref)(O).cell))},null,8,["modelValue","onUpdate:modelValue","placeholder"]),[[o.vShow,"notNull"!==a.condition]])])),_:2},1024),(0,o.createVNode)((0,o.unref)(d.Z),{span:1},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",{class:"d-control-remove",onClick:e=>T("deleteAnd",l,i)},"-",8,y)])),_:2},1024)])),_:2},1024)))),128))])])))),128))],512),[[o.vShow,(0,o.unref)(O).or.length>0]]),(0,o.createElementVNode)("div",x,[(0,o.createVNode)((0,o.unref)(u.Z),{type:"primary",onClick:t[2]||(t[2]=e=>T("add"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("modeling.combination.ConditionOperator.5m82aq4s8rc0")),1)])),_:1})])])])),_:1},8,["title"])])),_:1},8,["activeKey"]))}}),N=a(83744);const B=(0,N.Z)(k,[["__scopeId","data-v-d93078d4"]]);var V=B}}]);
//# sourceMappingURL=6302.2eb76cee.js.map