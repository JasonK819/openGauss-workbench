"use strict";(self["webpackChunkweb_ui"]=self["webpackChunkweb_ui"]||[]).push([[9981],{39518:function(e,t,o){o.d(t,{$4:function(){return B},Ac:function(){return c},BL:function(){return w},C4:function(){return O},DF:function(){return V},GD:function(){return R},IW:function(){return A},K4:function(){return L},Kf:function(){return $},LR:function(){return l},Lf:function(){return s},Ox:function(){return b},PK:function(){return u},R1:function(){return I},Sv:function(){return M},T2:function(){return m},T4:function(){return z},TL:function(){return E},TY:function(){return F},Uw:function(){return P},We:function(){return _},YQ:function(){return C},Ye:function(){return v},ZA:function(){return H},_V:function(){return g},c0:function(){return a},gi:function(){return x},h:function(){return N},jQ:function(){return W},jV:function(){return T},nT:function(){return f},sT:function(){return k},tA:function(){return i},ur:function(){return h},w3:function(){return d},xj:function(){return p},y6:function(){return S},zs:function(){return D},zx:function(){return y}});var r=o(9669),n=o.n(r);const s=()=>n().get("encryption/getKey"),l=e=>n().post("opsCluster/download",e||{}),a=e=>n().get(`opsCluster/env/${e}`),c=e=>n().post("opsCluster/install",e),i=e=>n().post("opsCluster/import",e),u=e=>n().post("opsCluster/quickInstall",e),p=e=>n().get("opsCluster/check",{params:e}),d=e=>n().post("opsCluster/uninstall",e),m=e=>n().get("opsCluster/hasName",{params:e}),g=()=>n().get("opsCluster/listCluster"),v=e=>n().post("opsCluster/ssh",e),f=e=>n().get("opsCluster/monitor",{params:e}),w=e=>n().post("opsCluster/start",e),k=e=>n().post("opsCluster/stop",e),h=e=>n().post("opsCluster/restart",e),E=e=>n().get("opsCluster/listHost",{params:e}),N=e=>n().get(e?`opsCluster/listInstallPackage?path=${e}`:"opsCluster/listInstallPackage"),y=()=>n().get("host/listAll"),C=e=>n().get(`hostUser/listAllWithoutRoot/${e}`),B=()=>n().get("az/listAll"),V=e=>n().get("opsCluster/logPath",{params:e}),x=e=>n().get("opsCluster/ls",{params:e}),P=e=>n().get("opsCluster/slowSql",{params:e}),R=e=>n().get("opsCluster/auditLog",{params:e}),M=e=>n().get("opsCluster/download",{params:e}),S=e=>n().get("wdr/list",{params:e}),I=e=>n().post("wdr/generate",e),D=e=>n()["delete"]("wdr/del/"+e),b=e=>n().get("wdr/createSnapshot",{params:e}),L=e=>n().get("wdr/downloadWdr",{params:e}),O=e=>n().get("wdr/listSnapshot",{params:e}),A=e=>n().post("backup/backup",e),z=e=>n().get("backup/page",{params:e}),$=(e,t)=>n().post("backup/recover/"+e,t),T=e=>n()["delete"]("backup/del/"+e),_=e=>n().get("installPackageManager/page",{params:e}),F=e=>n()["delete"]("installPackageManager/"+e),H=e=>n().post("installPackageManager/save",e),W=(e,t)=>n().put(`installPackageManager/update/${e}`,t)},83744:function(e,t){t.Z=(e,t)=>{const o=e.__vccOpts||e;for(const[r,n]of t)o[r]=n;return o}},29981:function(e,t,o){o.r(t),o.d(t,{default:function(){return _}});o(57658);var r=o(70821),n=o(39518),s=o(40225),l=o(98535),a=o(15784),c=o(57330);const i={class:"env-monitor-c"},u={class:"flex-col"},p={class:"flex-col-start"},d={class:"flex-row"},m={class:"env-item-c flex-between full-w mb"},g={class:"flex-row"},v={class:"flex-row"},f={key:0},w={class:"flex-row mb"},k={class:"ft-xlg"},h={class:"hardware-env"},E={key:0,class:"flex-col"},N={style:{width:"250px"},class:"flex-row"},y={class:"mr"},C={style:{"min-width":"500px"},class:"flex-row-start"},B={class:"mr"},V={class:"flex-row mb"},x={class:"ft-xlg"},P={class:"hardware-env"},R={key:0,class:"flex-col"},M={style:{width:"250px"},class:"flex-row"},S={class:"mr"},I={style:{"min-width":"500px"},class:"flex-row-start"},D={class:"mr"},b={key:1},L={key:1},O={key:2};var A;(function(e){e["NORMAL"]="NORMAL",e["WARMING"]="WARMING",e["ERROR"]="ERROR",e["INFO"]="INFO"})(A||(A={}));var z=(0,r.defineComponent)({setup(e,{expose:t}){const{t:o}=(0,c.QT)(),z=(0,s.BH)(),$=(0,r.inject)("loading"),T=(0,r.reactive)({nodeData:[]}),_=(0,r.ref)(null);(0,r.onMounted)((async()=>{$.toLoading(),T.nodeData=[],H(),T.nodeData.forEach((e=>{e.loading=!0,(0,n.c0)(e.hostId).then((t=>{200===Number(t.code)&&(e.result=200,e.hardwareEnv.envProperties=t.data.hardwareEnv.envProperties,e.softwareEnv.envProperties=t.data.softwareEnv.envProperties,j(e))})).catch((t=>{e.result=500,e.errMsg=t})).finally((()=>{e.loading=!1}))})),_.value=setInterval((()=>{const e=T.nodeData.filter((e=>200!==e.result&&500!==e.result));0===e.length&&(clearInterval(_.value),$.cancelLoading())}),100)})),(0,r.onBeforeUnmount)((()=>{_.value&&clearInterval(_.value)}));const F=e=>{$.toLoading(),e.loading=!0,(0,n.c0)(e.hostId).then((t=>{200===Number(t.code)?(e.result=200,e.hardwareEnv.envProperties=t.data.hardwareEnv.envProperties,e.softwareEnv.envProperties=t.data.softwareEnv.envProperties,j(e)):(e.result=500,e.errMsg=t.msg)})).catch((t=>{e.result=500,e.errMsg=t})).finally((()=>{e.loading=!1,$.cancelLoading()}))},H=()=>{T.nodeData=[],z.getLiteConfig.nodeConfigList.forEach((e=>{const t=T.nodeData.find((t=>t.privateIp===e.privateIp));if(!t){const t=W();t.hostId=e.hostId,t.privateIp=e.privateIp,t.publicIp=e.publicIp,t.clusterRole=e.clusterRole,T.nodeData.push(t)}}))},W=()=>({result:-1,errMsg:"",noPassNum:0,noPassNumHard:0,noPassNumSoft:0,isShow:!0,loading:!1,hostId:"",clusterRole:"",privateIp:"",publicIp:"",hardwareEnv:{envProperties:[]},softwareEnv:{envProperties:[]}}),j=e=>{e.hardwareEnv.envProperties.forEach((t=>{t.status===A.ERROR&&(e.noPassNum=e.noPassNum+1,e.noPassNumHard=e.noPassNumHard+1)})),e.softwareEnv.envProperties.forEach((t=>{t.status===A.ERROR&&(e.noPassNum=e.noPassNum+1,e.noPassNumHard=e.noPassNumHard+1)}))},G=e=>{switch(e.status){case A.ERROR:return"red";case A.INFO:return"gray";case A.NORMAL:return"green";default:return"orange"}},K=e=>{switch(e){case l._.MASTER:return o("lightweight.EnvMonitor.5mpmgwswkpc0");case l._.SLAVE:return o("lightweight.EnvMonitor.5mpmgwswkso0");default:return o("lightweight.EnvMonitor.5mpmgwswkwg0")}},Z=()=>{const e=T.nodeData.filter((e=>200!==e.result));let t=!0;return e.length>0&&(t=!1,a.Z.warning("If the host fails to be detected, configure the host and re-detect the host for installation")),t};return t({beforeConfirm:Z}),(e,t)=>{const o=(0,r.resolveComponent)("a-badge"),n=(0,r.resolveComponent)("a-alert"),s=(0,r.resolveComponent)("a-tag"),l=(0,r.resolveComponent)("icon-refresh"),a=(0,r.resolveComponent)("a-button"),c=(0,r.resolveComponent)("icon-down"),z=(0,r.resolveComponent)("icon-up"),$=(0,r.resolveComponent)("icon-exclamation-circle-fill"),_=(0,r.resolveComponent)("icon-check-circle-fill"),H=(0,r.resolveComponent)("icon-info-circle-fill"),W=(0,r.resolveComponent)("a-spin"),j=(0,r.resolveComponent)("a-divider");return(0,r.openBlock)(),(0,r.createElementBlock)("div",i,[(0,r.createElementVNode)("div",u,[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)((0,r.unref)(T).nodeData,((t,i)=>((0,r.openBlock)(),(0,r.createElementBlock)("div",{class:"mb",style:{width:"50%"},key:i},[(0,r.createVNode)(W,{class:"full-w",loading:t.loading,tip:e.$t("lightweight.EnvMonitor.5mpmgwswi880")},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("div",p,[-1!==t.result&&t.noPassNum>0?((0,r.openBlock)(),(0,r.createBlock)(n,{key:0,class:"mb",style:{width:"fit-content"},type:"error"},{default:(0,r.withCtx)((()=>[(0,r.createElementVNode)("div",d,[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("lightweight.EnvMonitor.5mpmgwswj8g0"))+" ",1),(0,r.createVNode)(o,{count:t.noPassNum},null,8,["count"]),(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("lightweight.EnvMonitor.else1")),1)])])),_:2},1024)):(0,r.createCommentVNode)("",!0),(0,r.createElementVNode)("div",m,[(0,r.createElementVNode)("div",g,[(0,r.createVNode)(s,{class:"mr",color:"#86909C"},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(K(t.clusterRole)),1)])),_:2},1024),(0,r.createTextVNode)(" "+(0,r.toDisplayString)(e.$t("lightweight.EnvMonitor.5mpmgwswjlc0"))+": "+(0,r.toDisplayString)(t.privateIp)+"("+(0,r.toDisplayString)(t.publicIp)+") ",1)]),(0,r.createElementVNode)("div",v,[(0,r.createVNode)(a,{class:"mr",type:"text",long:"",onClick:e=>F(t)},{icon:(0,r.withCtx)((()=>[(0,r.createVNode)(l)])),default:(0,r.withCtx)((()=>[(0,r.createTextVNode)(" "+(0,r.toDisplayString)(e.$t("lightweight.EnvMonitor.5mpmgwswjuk0")),1)])),_:2},1032,["onClick"]),t.isShow?((0,r.openBlock)(),(0,r.createBlock)(z,{key:1,style:{cursor:"pointer"},onClick:e=>t.isShow=!1},null,8,["onClick"])):((0,r.openBlock)(),(0,r.createBlock)(c,{key:0,style:{cursor:"pointer"},onClick:e=>t.isShow=!0},null,8,["onClick"]))])]),(0,r.withDirectives)((0,r.createElementVNode)("div",null,[200===t.result?((0,r.openBlock)(),(0,r.createElementBlock)("div",f,[(0,r.createElementVNode)("div",w,[t.noPassNumHard>0?((0,r.openBlock)(),(0,r.createBlock)($,{key:0,class:"mr",style:{color:"orange"},size:30})):((0,r.openBlock)(),(0,r.createBlock)(_,{key:1,style:{color:"green"},class:"mr",size:30})),(0,r.createElementVNode)("div",k,(0,r.toDisplayString)(e.$t("lightweight.EnvMonitor.5mpmgwswk640")),1)]),(0,r.createElementVNode)("div",h,[t.hardwareEnv.envProperties.length?((0,r.openBlock)(),(0,r.createElementBlock)("div",E,[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(t.hardwareEnv.envProperties,((e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)("div",{class:"flex-row mb",key:t},[(0,r.createElementVNode)("div",N,[(0,r.createElementVNode)("div",y,(0,r.toDisplayString)(e.name)+":",1),(0,r.createElementVNode)("div",null,(0,r.toDisplayString)(e.value),1)]),(0,r.createElementVNode)("div",C,[(0,r.createElementVNode)("div",B,[e.status===A.NORMAL?((0,r.openBlock)(),(0,r.createBlock)(_,{key:0,style:{color:"green"},size:20})):(0,r.createCommentVNode)("",!0),e.status===A.WARMING||e.status===A.ERROR?((0,r.openBlock)(),(0,r.createBlock)($,{key:1,style:{color:"orange"},size:20})):(0,r.createCommentVNode)("",!0),e.status===A.INFO?((0,r.openBlock)(),(0,r.createBlock)(H,{key:2,style:{color:"gray"},size:20})):(0,r.createCommentVNode)("",!0)]),(0,r.createElementVNode)("div",{style:(0,r.normalizeStyle)("color: "+G(e))},(0,r.toDisplayString)(e.statusMessage),5)])])))),128))])):(0,r.createCommentVNode)("",!0)]),(0,r.createElementVNode)("div",V,[t.noPassNumSoft>0?((0,r.openBlock)(),(0,r.createBlock)($,{key:0,class:"mr",style:{color:"orange"},size:30})):((0,r.openBlock)(),(0,r.createBlock)(_,{key:1,style:{color:"green"},class:"mr",size:30})),(0,r.createElementVNode)("div",x,(0,r.toDisplayString)(e.$t("lightweight.EnvMonitor.5mpmgwswkb40")),1)]),(0,r.createElementVNode)("div",P,[t.softwareEnv.envProperties.length?((0,r.openBlock)(),(0,r.createElementBlock)("div",R,[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(t.softwareEnv.envProperties,((e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)("div",{class:"flex-row mb",key:t},[(0,r.createElementVNode)("div",M,[(0,r.createElementVNode)("div",S,(0,r.toDisplayString)(e.name)+":",1),(0,r.createElementVNode)("div",null,(0,r.toDisplayString)(e.value),1)]),(0,r.createElementVNode)("div",I,[(0,r.createElementVNode)("div",D,[e.status===A.NORMAL?((0,r.openBlock)(),(0,r.createBlock)(_,{key:0,style:{color:"green"},size:20})):(0,r.createCommentVNode)("",!0),e.status===A.WARMING||e.status===A.ERROR?((0,r.openBlock)(),(0,r.createBlock)($,{key:1,style:{color:"orange"},size:20})):(0,r.createCommentVNode)("",!0),e.status===A.INFO?((0,r.openBlock)(),(0,r.createBlock)(H,{key:2,style:{color:"gray"},size:20})):(0,r.createCommentVNode)("",!0)]),(0,r.createElementVNode)("div",{style:(0,r.normalizeStyle)("max-width: 300px; color: "+G(e))},(0,r.toDisplayString)(e.statusMessage),5)])])))),128))])):(0,r.createCommentVNode)("",!0),500===t.result?((0,r.openBlock)(),(0,r.createElementBlock)("div",b,[(0,r.createVNode)(s,{color:"red"},{default:(0,r.withCtx)((()=>[(0,r.createTextVNode)((0,r.toDisplayString)(e.$t("lightweight.EnvMonitor.5mpmgwswkeo0")),1)])),_:1})])):(0,r.createCommentVNode)("",!0)])])):-1!==t.result&&200!==t.result?((0,r.openBlock)(),(0,r.createElementBlock)("div",L,(0,r.toDisplayString)(e.$t("lightweight.EnvMonitor.5mpmgwswki80"))+" "+(0,r.toDisplayString)(t.errMsg),1)):((0,r.openBlock)(),(0,r.createElementBlock)("div",O,(0,r.toDisplayString)(e.$t("lightweight.EnvMonitor.5mpmgwswkls0")),1))],512),[[r.vShow,t.isShow]])])])),_:2},1032,["loading","tip"]),(0,r.createVNode)(j)])))),128))])])}}}),$=o(83744);const T=(0,$.Z)(z,[["__scopeId","data-v-b1c6227e"]]);var _=T}}]);
//# sourceMappingURL=9981.c23af978.js.map