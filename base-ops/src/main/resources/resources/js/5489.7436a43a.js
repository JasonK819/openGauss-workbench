"use strict";(self["webpackChunkweb_ui"]=self["webpackChunkweb_ui"]||[]).push([[5489,3017],{89965:function(e,t,o){o.d(t,{AH:function(){return f},Bd:function(){return g},C7:function(){return Z},DG:function(){return A},Du:function(){return I},H7:function(){return O},Iz:function(){return z},J6:function(){return E},Jh:function(){return v},NQ:function(){return q},QS:function(){return $},Qt:function(){return _},R7:function(){return b},Rq:function(){return m},SB:function(){return p},SW:function(){return D},UL:function(){return c},Up:function(){return w},WK:function(){return k},Yn:function(){return T},gp:function(){return r},j9:function(){return U},nB:function(){return N},qR:function(){return V},qo:function(){return C},sZ:function(){return S},v$:function(){return u},vs:function(){return s},w0:function(){return L},wB:function(){return B},x9:function(){return J},xl:function(){return x},yA:function(){return d},yf:function(){return y}});var a=o(15784),n=o(9669),l=o.n(n),i=o(90989);const s=(e,t,o,a)=>l().get(`/modeling/dataflow/dataSourceDb/getTablesBySchema/${e}/${t}/${o}`,a||{}),d=(e,t)=>l().get(`/modeling/dataflow/dataSourceDb/getFieldsByTable/${e}`,t||{}),r=e=>l().get("/modeling/dataflow/list",{params:e}),u=e=>l().post("/modeling/dataflow/add",e||{}),m=e=>l()["delete"](`/modeling/dataflow/delete/${e}`),c=e=>l().put("/modeling/dataflow/edit",e||{}),g=e=>l().get(`/modeling/dataflow/getById/${e}`),p=(e,t)=>l().get(`/modeling/dataflow/dataSourceDb/getSchemaByClusterNodeId/${e}/${t}`,e||{}),f=e=>l().post("/modeling/dataflow/getSql",e||{}),v=e=>l().post("/modeling/dataflow/runSql",e||{});let h=!0;const w=(e,t,o)=>new Promise((n=>{h&&(h=!1,l().put("/modeling/dataflow/edit",{id:e,operatorContent:JSON.stringify(t)}).then((e=>{n(!0),h=!0,200===Number(e.code)&&(o||a.Z.success({content:i.Z.global.t("modeling.dy_common.saveSuccess")}))})).catch((()=>{n(!1),o||a.Z.error({content:i.Z.global.t("modeling.dy_common.saveFailed")}),h=!0})))})),C=e=>l().get("/modeling/dataflow/dataSourceDb/list",e||{}),k=e=>l().post("/modeling/dataflow/getResultFieldsByOperator",e||{}),D=e=>l().post("/modeling/dataflow/visualization/params/add",e||{}),y=e=>l().put("/modeling/dataflow/visualization/params/edit",e||{}),b=e=>l()["delete"](`/modeling/dataflow/visualization/params/delete/${e}`),x=e=>l().post("/modeling/dataflow/visualization/params/generateChart",e||{}),N=(e,t)=>l().get(`/modeling/dataflow/visualization/params/getListByOperatorId/${e}`,t||{}),V=e=>l().post("/modeling/dataflow/visualization/snapshot/add",e||{}),$=(e,t)=>l().get(`/modeling/dataflow/visualization/snapshot/getListByDataFlowId/${e}`,t||{}),_=e=>l()["delete"](`/modeling/dataflow/visualization/snapshot/delete/${e}`),S=(e,t)=>l().get(`/modeling/dataflow/visualization/report/getListByDataFlowId/${e}`,{params:t||{}}),B=e=>l().post("/modeling/dataflow/visualization/report/add",e||{}),Z=e=>l().put("/modeling/dataflow/visualization/report/update",e||{}),z=e=>l()["delete"](`/modeling/dataflow/visualization/report/delete/${e}`),I=e=>l().get(`/modeling/dataflow/visualization/report/share/getByReportId/${e}`),T=(e,t)=>l().get(`/modeling/dataflow/visualization/customDimension/getListByOperatorId/${e}`,{params:t||{}}),E=e=>l().post("/modeling/dataflow/visualization/customDimension/add",e||{}),q=e=>l().put("/modeling/dataflow/visualization/customDimension/edit",e||{}),O=e=>l()["delete"](`/modeling/dataflow/visualization/customDimension/delete/${e}`),J=(e,t)=>l().get(`/modeling/visualization/report/share/getMapGeo/${e}`,t||{}),A=e=>l().post("/modeling/dataflow/visualization/params/uploadGeo",e||{}),L=(e,t)=>l().get(`/modeling/dataflow/visualization/params/getGeo/${e}`,{params:t||{}}),U=e=>l()["delete"](`/modeling/dataflow/visualization/params/deleteGeo/${e}`)},73017:function(e,t,o){o.r(t),o.d(t,{chartTypes:function(){return l},compareWays:function(){return m},getQueryDataByKey:function(){return r},indicatorType:function(){return n},particles:function(){return c},setQueryData:function(){return u}});o(57658);var a=o(90989);const n=[{value:"sum",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1cb00")},{value:"avg",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1d3k0")},{value:"max",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1d7c0")},{value:"min",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1d9s0")},{value:"mid",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1dcg0")}],l=[{value:"bar",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1df40")},{value:"line",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1dhs0")},{value:"mix",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1dk40")},{value:"pie",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1dmk0")},{value:"heatmap",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1dqg0")},{value:"scatter",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1dso0")},{value:"graph",label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1dvc0")}];let i=[],s=[],d=[];const r=(e,t,o)=>{let a=10;o&&(a=o);let n=[];return d.includes(e)?n=JSON.parse(JSON.stringify(s[e])):(n=Array.from(new Set(i.map((t=>t[e])))).filter((e=>e&&e.trim())).map((e=>({label:e,value:e}))),s[e]=JSON.parse(JSON.stringify(n)),d.push(e)),n.splice((t-1)*a,a)},u=e=>{e&&Array.isArray(e)&&(i=e,s=[],d=[])},m=[{value:1,label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1dxs0")},{value:2,label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1e080")}],c=[{value:1,label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1e2g0")},{value:2,label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1e500")},{value:3,label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1e7g0")},{value:4,label:a.Z.global.t("modeling.hooks.visual-edit.5m83coh1e9o0")}]},83744:function(e,t){t.Z=(e,t)=>{const o=e.__vccOpts||e;for(const[a,n]of t)o[a]=n;return o}},63736:function(e,t,o){o.r(t),o.d(t,{default:function(){return d}});var a=o(70821),n=o(29067),l=(0,a.defineComponent)({props:{content:{type:String,required:!0},text:{type:String,required:!0},otherWidth:{type:Number,required:!1},fontSize:{type:Number,required:!1}},setup(e){const t=e,o=(0,a.ref)(),l=(0,a.ref)(!1),i=()=>{let e=o.value.parentNode.offsetWidth,a=o.value.offsetWidth+(t.otherWidth||0===t.otherWidth?t.otherWidth:24);l.value=!(a>e)};return(e,s)=>((0,a.openBlock)(),(0,a.createBlock)((0,a.unref)(n.Z),{content:t.content,disabled:l.value},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("span",{onMouseover:i},[(0,a.renderSlot)(e.$slots,"default")],32),(0,a.createElementVNode)("span",{class:"get-width",ref:(e,t)=>{t["contentRef"]=e,o.value=e}},(0,a.toDisplayString)(t.text),513)])),_:3},8,["content","disabled"]))}}),i=o(83744);const s=(0,i.Z)(l,[["__scopeId","data-v-6f1614ab"]]);var d=s},65489:function(e,t,o){o.r(t),o.d(t,{default:function(){return D}});o(57658);var a=o(70821),n=o(63736),l=o(15784),i=o(42119),s=o(73017),d=o(89965),r=o(57330);const u={class:"cddc-content"},m={class:"menu"},c={class:"vm-header"},g={class:"vm-content"},p={class:"vm-footer"},f={class:"cddc-form"},v={class:"table mb"},h={class:"cf-footer"};var w=(0,a.defineComponent)({props:{stringOption:{type:Array,required:!0}},emits:["setCustomList"],setup(e,{expose:t,emit:o}){const{t:w}=(0,r.QT)(),C=((0,i.yj)(),(0,a.ref)(!1)),k=(0,a.ref)(""),D=(0,a.ref)(!1),y=e=>{k.value=e,C.value=!0,V().then((()=>{x.value.length>0?T(x.value[0],0):T({},"")}))},b=()=>{C.value=!1},x=(0,a.ref)([]),N=(0,a.ref)(""),V=()=>new Promise((e=>{D.value=!0,(0,d.Yn)(k.value).then((t=>{D.value=!1,x.value=t&&t.data&&Array.isArray(t.data)?t.data:[],o("setCustomList",t&&t.data&&Array.isArray(t.data)?t.data:[]),e(!0)})).catch((()=>{D.value=!1}))})),$=e=>{D.value=!0,(0,d.H7)(e.id).then((e=>{200===Number(e.code)?(l.Z.success({content:w("modeling.components.CustomDimensionDialog.5m7iksonsk00")}),V().then((()=>{x.value.length>0?T(x.value[0],0):T({},"")}))):D.value=!1})).catch((()=>{D.value=!1}))},_=(e,t)=>{T(e,t)},S=()=>{let e={dataFlowId:window.$wujie?.props.data.id,operatorId:k.value,name:I.name,field:I.field,categories:I.categories};e.categories.forEach(((e,t)=>{e.sortId=t})),D.value=!0,I.id?(e.id=I.id,(0,d.NQ)(e).then((e=>{200===Number(e.code)?(l.Z.success({content:w("modeling.components.CustomDimensionDialog.5m7iksonsmc0")}),V().then((()=>{let e=x.value.findIndex((e=>e.id===I.id));T(x.value[e],e)}))):D.value=!1})).catch((()=>{D.value=!1}))):(0,d.J6)(e).then((e=>{200===Number(e.code)?(l.Z.success({content:w("modeling.components.CustomDimensionDialog.5m7iksonsmc0")}),V().then((()=>{T(x.value[x.value.length-1],x.value.length-1)}))):D.value=!1})).catch((()=>{D.value=!1}))},B=[{title:w("modeling.components.CustomDimensionDialog.5m7iksonspg0"),dataIndex:"name",slotName:"name",width:180},{title:w("modeling.components.CustomDimensionDialog.5m7iksonsro0"),dataIndex:"type",slotName:"type",width:180},{title:w("modeling.components.CustomDimensionDialog.5m7iksonsu00"),dataIndex:"value",slotName:"value"},{title:w("modeling.components.CustomDimensionDialog.5m7iksonsvs0"),slotName:"operate",width:100}],Z=(0,a.ref)([]),z={page:1,size:10},I=(0,a.reactive)({name:"",field:"",id:"",categories:[]}),T=(e,t)=>{N.value=t,I.name=e.name?e.name:"",I.field=e.field?e.field:"",I.id=e.id?e.id:"",I.categories=e.categoriesJson?JSON.parse(e.categoriesJson):[],e.field&&J(1)},E=e=>{I.categories.splice(e,1)},q=()=>{I.categories.push({name:"",type:"",value:[]})},O=()=>{I.categories.forEach((e=>e.value=[])),J(1)},J=e=>{e&&1===e?z.page=1:z.page++,1===z.page?Z.value=(0,s.getQueryDataByKey)(I.field,z.page,z.size):Z.value=[...Z.value,...(0,s.getQueryDataByKey)(I.field,z.page,z.size)]},A=e=>{I.categories=e};return t({open:y}),(t,o)=>{const l=(0,a.resolveComponent)("a-button"),i=(0,a.resolveComponent)("a-doption"),s=(0,a.resolveComponent)("a-dropdown"),d=(0,a.resolveComponent)("icon-plus"),r=(0,a.resolveComponent)("a-col"),w=(0,a.resolveComponent)("a-input"),k=(0,a.resolveComponent)("a-row"),y=(0,a.resolveComponent)("icon-tag"),V=(0,a.resolveComponent)("a-option"),z=(0,a.resolveComponent)("a-select"),T=(0,a.resolveComponent)("a-table"),L=(0,a.resolveComponent)("a-spin"),U=(0,a.resolveComponent)("a-modal");return(0,a.openBlock)(),(0,a.createBlock)(U,{class:"custom-dimension-dialog-container",visible:C.value,title:t.$t("modeling.components.CustomDimensionDialog.5m7iksonqnk0"),"ok-text":t.$t("modeling.components.CustomDimensionDialog.5m7iksonr9s0"),onCancel:b,width:"1280px",footer:!1},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(L,{loading:D.value,style:{width:"100%",height:"100%"}},{default:(0,a.withCtx)((()=>[(0,a.createElementVNode)("div",u,[(0,a.createElementVNode)("div",m,[(0,a.createElementVNode)("div",c,(0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksonrew0")),1),(0,a.createElementVNode)("div",g,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(x.value,((e,o)=>((0,a.openBlock)(),(0,a.createBlock)(s,{trigger:"contextMenu",key:`menuItem${o}`},{content:(0,a.withCtx)((()=>[(0,a.createVNode)(i,{onClick:t=>$(e)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksonrkg0")),1)])),_:2},1032,["onClick"])])),default:(0,a.withCtx)((()=>[(0,a.createVNode)(l,{class:"mb-s",type:o===N.value?"outline":"dashed",onClick:t=>_(e,o)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.name?e.name:t.$t("modeling.components.CustomDimensionDialog.5m7iksonri40")),1)])),_:2},1032,["type","onClick"])])),_:2},1024)))),128))]),(0,a.createElementVNode)("div",p,[(0,a.createVNode)(l,{type:"primary",onClick:o[0]||(o[0]=e=>_({},""))},{icon:(0,a.withCtx)((()=>[(0,a.createVNode)(d)])),default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksonros0")),1)])),_:1})])]),(0,a.createElementVNode)("div",f,[(0,a.createVNode)(k,{class:"mb",align:"center"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(r,{span:3},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksonrrg0")),1)])),_:1}),(0,a.createVNode)(r,{span:8},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(w,{"max-length":140,"show-word-limit":"",modelValue:(0,a.unref)(I).name,"onUpdate:modelValue":o[1]||(o[1]=e=>(0,a.unref)(I).name=e),placeholder:t.$t("modeling.components.CustomDimensionDialog.5m7iksonru00")},null,8,["modelValue","placeholder"])])),_:1})])),_:1}),(0,a.createVNode)(k,{class:"mb",align:"center"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(r,{span:3},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksonrwc0")),1)])),_:1}),(0,a.createVNode)(r,{span:8},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(z,{modelValue:(0,a.unref)(I).field,"onUpdate:modelValue":o[2]||(o[2]=e=>(0,a.unref)(I).field=e),placeholder:t.$t("modeling.components.CustomDimensionDialog.5m7iksonryw0"),onChange:O},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.stringOption,((e,t)=>((0,a.openBlock)(),(0,a.createBlock)(n["default"],{text:e.label,key:t,content:e.label},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(V,{value:e.value},{default:(0,a.withCtx)((()=>[e.isCustom?((0,a.openBlock)(),(0,a.createBlock)(y,{key:0,class:"mr-s"})):(0,a.createCommentVNode)("",!0),(0,a.createTextVNode)((0,a.toDisplayString)(e.label),1)])),_:2},1032,["value"])])),_:2},1032,["text","content"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1})])),_:1}),(0,a.createVNode)(k,{align:"center",class:"mb-s"},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(r,{span:3},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksons100")),1)])),_:1}),(0,a.createVNode)(r,{span:3},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(l,{type:"primary",onClick:q},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksons3g0")),1)])),_:1})])),_:1})])),_:1}),(0,a.createElementVNode)("div",v,[(0,a.createVNode)(T,{data:(0,a.unref)(I).categories,columns:B,scroll:{y:500},pagination:!1,onChange:A,draggable:{type:"handle",width:40}},{name:(0,a.withCtx)((({rowIndex:e})=>[(0,a.createVNode)(w,{"max-length":140,modelValue:(0,a.unref)(I).categories[e].name,"onUpdate:modelValue":t=>(0,a.unref)(I).categories[e].name=t,placeholder:t.$t("modeling.components.CustomDimensionDialog.5m7iksons5w0")},null,8,["modelValue","onUpdate:modelValue","placeholder"])])),type:(0,a.withCtx)((({rowIndex:e})=>[(0,a.createVNode)(z,{modelValue:(0,a.unref)(I).categories[e].type,"onUpdate:modelValue":t=>(0,a.unref)(I).categories[e].type=t,placeholder:t.$t("modeling.components.CustomDimensionDialog.5m7iksons8g0")},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(V,{value:1},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksonsak0")),1)])),_:1}),(0,a.createVNode)(V,{value:2},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksonscs0")),1)])),_:1})])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])])),value:(0,a.withCtx)((({rowIndex:e})=>[(0,a.createVNode)(z,{modelValue:(0,a.unref)(I).categories[e].value,"onUpdate:modelValue":t=>(0,a.unref)(I).categories[e].value=t,placeholder:t.$t("modeling.components.CustomDimensionDialog.5m7iksonsf40"),multiple:"","allow-clear":"",onDropdownReachBottom:o[3]||(o[3]=e=>J())},{default:(0,a.withCtx)((()=>[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(Z.value,((e,t)=>((0,a.openBlock)(),(0,a.createBlock)(n["default"],{text:e.label,key:t,content:e.label},{default:(0,a.withCtx)((()=>[(0,a.createVNode)(V,{value:e.value},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(e.label),1)])),_:2},1032,["value"])])),_:2},1032,["text","content"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])])),operate:(0,a.withCtx)((({rowIndex:e})=>[(0,a.createVNode)(l,{type:"primary",status:"warning",size:"mini",onClick:t=>E(e)},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksonrkg0")),1)])),_:2},1032,["onClick"])])),_:1},8,["data"])]),(0,a.createElementVNode)("div",h,[(0,a.createVNode)(l,{type:"primary",class:"mlauto",onClick:S},{default:(0,a.withCtx)((()=>[(0,a.createTextVNode)((0,a.toDisplayString)(t.$t("modeling.components.CustomDimensionDialog.5m7iksonshg0")),1)])),_:1})])])])])),_:1},8,["loading"])])),_:1},8,["visible","title","ok-text"])}}}),C=o(83744);const k=(0,C.Z)(w,[["__scopeId","data-v-51ef2b26"]]);var D=k}}]);
//# sourceMappingURL=5489.7436a43a.js.map