"use strict";(self["webpackChunkweb_ui"]=self["webpackChunkweb_ui"]||[]).push([[3836],{39518:function(e,t,l){l.d(t,{$4:function(){return b},Ac:function(){return u},BL:function(){return h},C4:function(){return P},DF:function(){return S},GD:function(){return y},IW:function(){return T},K4:function(){return B},Kf:function(){return Y},LR:function(){return o},Lf:function(){return a},Ox:function(){return E},PK:function(){return d},R1:function(){return $},Sv:function(){return _},T2:function(){return m},T4:function(){return M},TL:function(){return C},TY:function(){return F},Uw:function(){return V},We:function(){return A},YQ:function(){return L},Ye:function(){return f},ZA:function(){return Q},_V:function(){return w},c0:function(){return s},gi:function(){return q},h:function(){return I},jQ:function(){return U},jV:function(){return z},nT:function(){return g},sT:function(){return x},tA:function(){return i},ur:function(){return v},w3:function(){return p},xj:function(){return c},y6:function(){return N},zs:function(){return D},zx:function(){return k}});var n=l(9669),r=l.n(n);const a=()=>r().get("encryption/getKey"),o=e=>r().post("opsCluster/download",e||{}),s=e=>r().get(`opsCluster/env/${e}`),u=e=>r().post("opsCluster/install",e),i=e=>r().post("opsCluster/import",e),d=e=>r().post("opsCluster/quickInstall",e),c=e=>r().get("opsCluster/check",{params:e}),p=e=>r().post("opsCluster/uninstall",e),m=e=>r().get("opsCluster/hasName",{params:e}),w=()=>r().get("opsCluster/listCluster"),f=e=>r().post("opsCluster/ssh",e),g=e=>r().get("opsCluster/monitor",{params:e}),h=e=>r().post("opsCluster/start",e),x=e=>r().post("opsCluster/stop",e),v=e=>r().post("opsCluster/restart",e),C=e=>r().get("opsCluster/listHost",{params:e}),I=e=>r().get(e?`opsCluster/listInstallPackage?path=${e}`:"opsCluster/listInstallPackage"),k=()=>r().get("host/listAll"),L=e=>r().get(`hostUser/listAllWithoutRoot/${e}`),b=()=>r().get("az/listAll"),S=e=>r().get("opsCluster/logPath",{params:e}),q=e=>r().get("opsCluster/ls",{params:e}),V=e=>r().get("opsCluster/slowSql",{params:e}),y=e=>r().get("opsCluster/auditLog",{params:e}),_=e=>r().get("opsCluster/download",{params:e}),N=e=>r().get("wdr/list",{params:e}),$=e=>r().post("wdr/generate",e),D=e=>r()["delete"]("wdr/del/"+e),E=e=>r().get("wdr/createSnapshot",{params:e}),B=e=>r().get("wdr/downloadWdr",{params:e}),P=e=>r().get("wdr/listSnapshot",{params:e}),T=e=>r().post("backup/backup",e),M=e=>r().get("backup/page",{params:e}),Y=(e,t)=>r().post("backup/recover/"+e,t),z=e=>r()["delete"]("backup/del/"+e),A=e=>r().get("installPackageManager/page",{params:e}),F=e=>r()["delete"]("installPackageManager/"+e),Q=e=>r().post("installPackageManager/save",e),U=(e,t)=>r().put(`installPackageManager/update/${e}`,t)},83744:function(e,t){t.Z=(e,t)=>{const l=e.__vccOpts||e;for(const[n,r]of t)l[n]=r;return l}},13836:function(e,t,l){l.r(t),l.d(t,{default:function(){return x}});l(57658);var n=l(70821),r=l(15784),a=l(39518),o=l(57330);const s={class:"slow-sql-c"},u={class:"flex-row mb"},i={class:"flex-row mr"},d={class:"top-label mr-s"},c={class:"flex-row mr"},p={class:"top-label mr-s"},m={class:"flex-row mr"},w={class:"query-label mr-s"};var f=(0,n.defineComponent)({setup(e){const{t:t}=(0,o.QT)(),l=(0,n.reactive)({clusterId:"",hostId:"",start:"",end:"",clusterListLoading:!1,clusterList:[],hostListLoading:!1,hostList:[]}),f=(0,n.computed)((()=>[{title:t("slowSql.index.5mplw69rw300"),dataIndex:"time"},{title:t("slowSql.index.5mplw69rwcw0"),dataIndex:"type"},{title:t("slowSql.index.5mplw69rwgs0"),dataIndex:"result"},{title:t("slowSql.index.5mplw69rwks0"),dataIndex:"userid"},{title:t("slowSql.index.5mplw69rwog0"),dataIndex:"username"},{title:t("slowSql.index.5mplw69rwrw0"),dataIndex:"database"},{title:t("slowSql.index.5mplw69rwvw0"),dataIndex:"client_conninfo"},{title:t("slowSql.index.5mplw69rwzc0"),dataIndex:"object_name"},{title:t("slowSql.index.5mplw69rx3c0"),dataIndex:"detail_info"},{title:t("slowSql.index.5mplw69rx740"),dataIndex:"node_name"},{title:t("slowSql.index.5mplw69rxak0"),dataIndex:"thread_id"},{title:t("slowSql.index.5mplw69rxe80"),dataIndex:"local_port"},{title:t("slowSql.index.5mplw69rxmc0"),dataIndex:"remote_port"}])),g=(0,n.reactive)({data:[],page:{page:1,pageSize:20},loading:!1}),h=e=>{l.start=e[0],l.end=e[1]},x=(0,n.computed)((()=>{const e=new Date,t=e.getFullYear(),l=e.getMonth(),n=e.getDate();return[new Date(t,l,n,0,0,0),new Date(t,l,n,23,59,59)]}));(0,n.onMounted)((async()=>{await C(),await I(),v()}));const v=()=>{g.loading=!0;const e={clusterId:l.clusterId,hostId:l.hostId,start:l.start,end:l.end};(0,a.Uw)(e).then((e=>{200===Number(e.code)?g.data=e.data:r.Z.error("Failed to obtain the slow SQL query list")})).catch((()=>{r.Z.error("Failed to obtain the slow SQL query list")})).finally((()=>{g.loading=!1}))},C=()=>new Promise((e=>{l.clusterListLoading=!0,(0,a._V)().then((t=>{200===Number(t.code)?(e(!0),t.data.forEach((e=>{l.clusterList.push({label:e.clusterId,value:e.clusterId})})),l.clusterId=l.clusterList[0].value):e(!1)})).finally((()=>{l.clusterListLoading=!1}))})),I=()=>new Promise((e=>{if(l.clusterId){const t={clusterId:l.clusterId};l.hostListLoading=!0,(0,a.TL)(t).then((t=>{200===Number(t.code)?(e(!0),l.hostList=[],t.data.forEach((e=>{l.hostList.push({label:`${e.privateIp}(${e.hostname})`,value:e.hostId})})),l.hostId=l.hostList[0].value):e(!1)})).finally((()=>{l.hostListLoading=!1}))}}));return(e,t)=>{const r=(0,n.resolveComponent)("a-option"),a=(0,n.resolveComponent)("a-select"),o=(0,n.resolveComponent)("a-range-picker"),C=(0,n.resolveComponent)("a-button"),k=(0,n.resolveComponent)("a-table");return(0,n.openBlock)(),(0,n.createElementBlock)("div",s,[(0,n.createElementVNode)("div",u,[(0,n.createElementVNode)("div",i,[(0,n.createElementVNode)("div",d,(0,n.toDisplayString)(e.$t("slowSql.index.5mplw69rv000")),1),(0,n.createVNode)(a,{class:"select-w",loading:(0,n.unref)(l).clusterListLoading,modelValue:(0,n.unref)(l).clusterId,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,n.unref)(l).clusterId=e),placeholder:e.$t("slowSql.index.5mplw69rvmo0"),onChange:I},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(l).clusterList,((e,t)=>((0,n.openBlock)(),(0,n.createBlock)(r,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["loading","modelValue","placeholder"])]),(0,n.createElementVNode)("div",c,[(0,n.createElementVNode)("div",p,(0,n.toDisplayString)(e.$t("slowSql.index.5mplw69rvt40")),1),(0,n.createVNode)(a,{class:"select-w",loading:(0,n.unref)(l).hostListLoading,modelValue:(0,n.unref)(l).hostId,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,n.unref)(l).hostId=e),placeholder:e.$t("slowSql.index.5mplw69rvz80")},{default:(0,n.withCtx)((()=>[((0,n.openBlock)(!0),(0,n.createElementBlock)(n.Fragment,null,(0,n.renderList)((0,n.unref)(l).hostList,((e,t)=>((0,n.openBlock)(),(0,n.createBlock)(r,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["loading","modelValue","placeholder"])]),(0,n.createElementVNode)("div",m,[(0,n.createElementVNode)("div",w,(0,n.toDisplayString)(e.$t("slowSql.index.5mplw69rw300")),1),(0,n.createVNode)(o,{style:{width:"360px",margin:"0 24px 0 0"},"show-time":"","default-value":(0,n.unref)(x),"allow-clear":!1,"time-picker-props":{defaultValue:["00:00:00","23:59:59"]},format:"YYYY-MM-DD HH:mm:ss",onOk:h},null,8,["default-value"])]),(0,n.createVNode)(C,{type:"primary",onClick:v},{default:(0,n.withCtx)((()=>[(0,n.createTextVNode)((0,n.toDisplayString)(e.$t("slowSql.index.5mplw69rw900")),1)])),_:1})]),(0,n.createVNode)(k,{class:"d-a-table-row full-h",data:(0,n.unref)(g).data,columns:(0,n.unref)(f),pagination:(0,n.unref)(g).page,loading:(0,n.unref)(g).loading},null,8,["data","columns","pagination","loading"])])}}}),g=l(83744);const h=(0,g.Z)(f,[["__scopeId","data-v-351300f6"]]);var x=h}}]);
//# sourceMappingURL=3836.68b8c1e9.js.map