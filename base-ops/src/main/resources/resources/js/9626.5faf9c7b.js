"use strict";(self["webpackChunkweb_ui"]=self["webpackChunkweb_ui"]||[]).push([[9626],{83744:function(e,t){t.Z=(e,t)=>{const o=e.__vccOpts||e;for(const[l,n]of t)o[l]=n;return o}},19626:function(e,t,o){o.r(t),o.d(t,{default:function(){return b}});o(57658);var l=o(70821),n=o(15784),a=o(42119),r=o(57330);const i={class:"cu-report"},s={class:"draw",id:"content"},d={class:"grid-item-content"},c=["src"],p={class:"config"},m={class:"config-item base"},u={class:"ci-title"},g={class:"config-row"},v={class:"text"},y={class:"value"},f={class:"config-row"},h={class:"text"},x={class:"value"},C={class:"config-item snapshot-list"},V={class:"ci-title"},E={class:"snapshot-list-content"},w={class:"snapshot-item"},N=["src","onDrag","onDragend"];var k=(0,l.defineComponent)({props:{snapshotList:{type:Array,required:!0}},setup(e,{expose:t}){const o=e,{t:k}=(0,r.QT)(),B=((0,a.yj)(),(0,l.ref)(!1)),D=(e,t)=>{B.value=!0,"create"===e?(L.value=[],R.name="",R.type="",R.id=""):"update"===e&&(L.value=JSON.parse(t.paramsJson),R.name=t.name,R.type=t.type,R.id=t.id),(0,l.nextTick)((()=>{document.addEventListener("dragover",(function(e){U.x=e.clientX,U.y=e.clientY}),!1)}))},b=()=>{document.removeEventListener("dragover",(function(e){U.x=e.clientX,U.y=e.clientY}),!1),B.value=!1},R=(0,l.reactive)({name:"",type:"",id:""}),$=120;let U={x:null,y:null},_={x:0,y:0,w:20,h:10,i:-1,imgBase64:""};const L=(0,l.ref)([]),S=(0,l.ref)();let I=[];const Z=(e,t)=>{0===t&&(I=[]),I.push(e)},O=(e,t)=>{let l=document.getElementById("content");if(l&&S.value){let e=l.getBoundingClientRect(),n=!1;U.x>e.left&&U.x<e.right&&U.y>e.top&&U.y<e.bottom&&(n=!0),!0===n&&-1===L.value.findIndex((e=>"drop"===e.i))&&L.value.push({x:2*L.value.length%($||12),y:L.value.length+($||12),w:20,h:10,i:"drop",imgBase64:o.snapshotList[t].imgBase64});let a=L.value.findIndex((e=>"drop"===e.i));if(-1!==a){try{I[L.value.length-1].$refs.item.style.display="none"}catch{console.error("gridItemRef[layout.value.length].$refs.item.style.display = 'none'")}let t=I[a];if(t){t.dragging={top:U.y-e.top,left:U.x-e.left};let o=t.calcXY(U.y-e.top,U.x-e.left);!0===n&&(S.value.dragEvent("dragstart","drop",o.x,o.y,1,1),_.i=String(a),_.x=L.value[a].x,_.y=L.value[a].y),!1===n&&(S.value.dragEvent("dragend","drop",o.x,o.y,1,1),L.value=L.value.filter((e=>"drop"!==e.i)))}}}},T=(e,t)=>{let l=document.getElementById("content");if(l&&S.value){let e=l.getBoundingClientRect(),n=!1;if(U.x>e.left&&U.x<e.right&&U.y>e.top&&U.y<e.bottom&&(n=!0),!0===n){S.value.dragEvent("dragend","drop",_.x,_.y,1,1),L.value=L.value.filter((e=>"drop"!==e.i)),L.value.push({x:_.x,y:_.y,w:20,h:10,i:_.i,imgBase64:o.snapshotList[t].imgBase64}),S.value.dragEvent("dragend",_.i,_.x,_.y,1,1);try{I[L.value.length].$refs.item.style.display="block"}catch{console.error("gridItemRef[layout.value.length].$refs.item.style.display = `block`")}}}},X=()=>{if(!R.name)return void n.Z.error({content:k("modeling.components.CUReportDrag.5m7ipr5ls800")});if(!R.type)return void n.Z.error({content:k("modeling.components.CUReportDrag.5m7ipr5lsd40")});R.name,window.$wujie?.props.data.id,R.type};return t({open:D}),(t,o)=>{const n=(0,l.resolveComponent)("grid-item"),a=(0,l.resolveComponent)("grid-layout"),r=(0,l.resolveComponent)("a-input"),k=(0,l.resolveComponent)("a-option"),D=(0,l.resolveComponent)("a-select"),U=(0,l.resolveComponent)("a-tooltip"),_=(0,l.resolveComponent)("a-modal");return(0,l.openBlock)(),(0,l.createBlock)(_,{class:"cu-report-drag-container",visible:B.value,title:t.$t("modeling.components.CUReportDrag.5m7ipr5lr5s0"),"ok-text":t.$t("modeling.components.CUReportDrag.5m7ipr5lrw40"),onCancel:b,onOk:X,fullscreen:""},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",i,[(0,l.createElementVNode)("div",s,[(0,l.createVNode)(a,{ref:(e,t)=>{t["gridlayoutRef"]=e,S.value=e},layout:L.value,"onUpdate:layout":o[0]||(o[0]=e=>L.value=e),"col-num":$,"row-height":10,"is-draggable":!0,"is-resizable":!0,"vertical-compact":!0,"use-css-transforms":!0},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(L.value,((e,t)=>((0,l.openBlock)(),(0,l.createBlock)(n,{key:e.i,ref:e=>Z(e,t),x:e.x,y:e.y,w:e.w,h:e.h,i:e.i,style:{border:"1px solid blue"}},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",d,[(0,l.createElementVNode)("img",{src:e.imgBase64},null,8,c)])])),_:2},1032,["x","y","w","h","i"])))),128))])),_:1},8,["layout"])]),(0,l.createElementVNode)("div",p,[(0,l.createElementVNode)("div",m,[(0,l.createElementVNode)("div",u,(0,l.toDisplayString)(t.$t("modeling.components.CUReportDrag.5m7ipr5ls0w0")),1),(0,l.createElementVNode)("div",g,[(0,l.createElementVNode)("div",v,(0,l.toDisplayString)(t.$t("modeling.components.CUReportDrag.5m7ipr5ls3k0")),1),(0,l.createElementVNode)("div",y,[(0,l.createVNode)(r,{"max-length":140,"show-word-limit":"",modelValue:(0,l.unref)(R).name,"onUpdate:modelValue":o[1]||(o[1]=e=>(0,l.unref)(R).name=e),placeholder:t.$t("modeling.components.CUReportDrag.5m7ipr5ls800")},null,8,["modelValue","placeholder"])])]),(0,l.createElementVNode)("div",f,[(0,l.createElementVNode)("div",h,(0,l.toDisplayString)(t.$t("modeling.components.CUReportDrag.5m7ipr5lsao0")),1),(0,l.createElementVNode)("div",x,[(0,l.createVNode)(D,{modelValue:(0,l.unref)(R).type,"onUpdate:modelValue":o[2]||(o[2]=e=>(0,l.unref)(R).type=e),placeholder:t.$t("modeling.components.CUReportDrag.5m7ipr5lsd40")},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(k,null,{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(t.$t("modeling.components.CUReportDrag.5m7ipr5lsfc0")),1)])),_:1})])),_:1},8,["modelValue","placeholder"])])])]),(0,l.createElementVNode)("div",C,[(0,l.createElementVNode)("div",V,(0,l.toDisplayString)(t.$t("modeling.components.CUReportDrag.5m7ipr5lsho0")),1),(0,l.createElementVNode)("div",E,[(0,l.createElementVNode)("div",null,(0,l.toDisplayString)(L.value),1),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.snapshotList,((e,t)=>((0,l.openBlock)(),(0,l.createBlock)(U,{key:`s${t}`,content:e.name},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",w,[(0,l.createElementVNode)("img",{src:e.imgBase64,draggable:"true",unselectable:"on",onDrag:e=>O(e,t),onDragend:e=>T(e,t)},null,40,N)])])),_:2},1032,["content"])))),128))])])])])])),_:1},8,["visible","title","ok-text"])}}}),B=o(83744);const D=(0,B.Z)(k,[["__scopeId","data-v-222bda0a"]]);var b=D}}]);
//# sourceMappingURL=9626.5faf9c7b.js.map