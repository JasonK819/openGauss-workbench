"use strict";(self["webpackChunkweb_ui"]=self["webpackChunkweb_ui"]||[]).push([[6399],{39518:function(e,t,n){n.d(t,{$4:function(){return S},Ac:function(){return l},BL:function(){return C},C4:function(){return $},DF:function(){return T},GD:function(){return V},IW:function(){return L},K4:function(){return D},Kf:function(){return z},LR:function(){return a},Lf:function(){return r},Ox:function(){return E},PK:function(){return u},R1:function(){return B},Sv:function(){return O},T2:function(){return f},T4:function(){return G},TL:function(){return k},TY:function(){return M},Uw:function(){return I},We:function(){return A},YQ:function(){return N},Ye:function(){return d},ZA:function(){return R},_V:function(){return g},c0:function(){return i},gi:function(){return x},h:function(){return w},jQ:function(){return U},jV:function(){return Z},nT:function(){return h},sT:function(){return b},tA:function(){return c},ur:function(){return v},w3:function(){return m},xj:function(){return p},y6:function(){return P},zs:function(){return _},zx:function(){return y}});var o=n(9669),s=n.n(o);const r=()=>s().get("encryption/getKey"),a=e=>s().post("opsCluster/download",e||{}),i=e=>s().get(`opsCluster/env/${e}`),l=e=>s().post("opsCluster/install",e),c=e=>s().post("opsCluster/import",e),u=e=>s().post("opsCluster/quickInstall",e),p=e=>s().get("opsCluster/check",{params:e}),m=e=>s().post("opsCluster/uninstall",e),f=e=>s().get("opsCluster/hasName",{params:e}),g=()=>s().get("opsCluster/listCluster"),d=e=>s().post("opsCluster/ssh",e),h=e=>s().get("opsCluster/monitor",{params:e}),C=e=>s().post("opsCluster/start",e),b=e=>s().post("opsCluster/stop",e),v=e=>s().post("opsCluster/restart",e),k=e=>s().get("opsCluster/listHost",{params:e}),w=e=>s().get(e?`opsCluster/listInstallPackage?path=${e}`:"opsCluster/listInstallPackage"),y=()=>s().get("host/listAll"),N=e=>s().get(`hostUser/listAllWithoutRoot/${e}`),S=()=>s().get("az/listAll"),T=e=>s().get("opsCluster/logPath",{params:e}),x=e=>s().get("opsCluster/ls",{params:e}),I=e=>s().get("opsCluster/slowSql",{params:e}),V=e=>s().get("opsCluster/auditLog",{params:e}),O=e=>s().get("opsCluster/download",{params:e}),P=e=>s().get("wdr/list",{params:e}),B=e=>s().post("wdr/generate",e),_=e=>s()["delete"]("wdr/del/"+e),E=e=>s().get("wdr/createSnapshot",{params:e}),D=e=>s().get("wdr/downloadWdr",{params:e}),$=e=>s().get("wdr/listSnapshot",{params:e}),L=e=>s().post("backup/backup",e),G=e=>s().get("backup/page",{params:e}),z=(e,t)=>s().post("backup/recover/"+e,t),Z=e=>s()["delete"]("backup/del/"+e),A=e=>s().get("installPackageManager/page",{params:e}),M=e=>s()["delete"]("installPackageManager/"+e),R=e=>s().post("installPackageManager/save",e),U=(e,t)=>s().put(`installPackageManager/update/${e}`,t)},33781:function(e,t,n){n.d(t,{Z:function(){return r}});var o=n(47327);class s{constructor(){(0,o.Z)(this,"heartTimeOut",void 0),(0,o.Z)(this,"ServerHeartTimeOut",void 0),(0,o.Z)(this,"timeout",5e3)}reset(){clearTimeout(this.heartTimeOut),clearTimeout(this.ServerHeartTimeOut)}start(e){this.heartTimeOut=setTimeout((t=>{e(t),this.ServerHeartTimeOut=setTimeout((t=>{e(t),this.reset(),this.start(e)}),this.timeout)}),this.timeout)}}class r extends s{constructor(e){super(),(0,o.Z)(this,"ws",void 0),(0,o.Z)(this,"reconnectTimer",0),(0,o.Z)(this,"reconnectCount",10),(0,o.Z)(this,"options",{url:null,heartTime:5e3,heartMsg:"ping",isReconnect:!0,isRestory:!1,reconnectTime:5e3,reconnectCount:5,openCb:e=>{console.log("connect success callback::::",e)},closeCb:e=>{console.log("close callback::::",e)},messageCb:e=>{console.log("message callback::::",e)},errorCb:e=>{console.log("error callback::::",e)}}),Object.assign(this.options,e),this.create()}create(){if(!("WebSocket"in window))throw new Error("The current browser does not support it and cannot be used");if(!this.options.url)throw new Error("The address does not exist, and the channel cannot be established");let e;console.log("get locaion host: ",window.location.host),e=`ws://${window.location.host}/ws/base-ops/${this.options.url}`,this.ws=new WebSocket(e),this.onopen(this.options.openCb),this.onclose(this.options.closeCb),this.onmessage(this.options.messageCb)}onopen(e){this.ws.onopen=t=>{"function"===typeof e?e(t):"function"===typeof this.options.openCb&&this.options.openCb(t)}}onclose(e){this.ws.onclose=t=>{"function"===typeof e?e(t):"function"===typeof this.options.closeCb&&this.options.closeCb(t)}}onerror(e){this.ws.onerror=t=>{"function"===typeof e?e(t):"function"===typeof this.options.errorCb&&this.options.errorCb(t)}}onmessage(e){this.ws.onmessage=t=>{const n=t.data;"function"===typeof e&&e(n)}}send(e){console.log("doNothing",e)}destroy(){super.reset(),clearTimeout(this.reconnectTimer),this.options.isRestory=!0,this.ws.close()}}},83744:function(e,t){t.Z=(e,t)=>{const n=e.__vccOpts||e;for(const[o,s]of t)n[o]=s;return n}},46399:function(e,t,n){n.r(t),n.d(t,{default:function(){return w}});var o=n(70821),s=n(39518),r=n(33781),a=n(40225),i=n(98535);const l={class:"panel-c"},c={class:"mb ft-xlg"},u={class:"mb"},p={class:"flex-col panel-body"},m={key:0,class:"center-item flex-row mb"},f={class:"ft-main mr-xlg"},g={key:1,class:"center-item flex-row mb"},d={class:"ft-main mr-xlg"},h={key:2,class:"center-item flex-row"},C={class:"ft-main mr-xlg"};var b=(0,o.defineComponent)({setup(e){const t=(0,a.BH)(),n=(0,o.reactive)({targetPath:"/ops/files/",enterprise:{name:"openGauss-3.0.0 Enterprise",resourceUrl:"https://opengauss.obs.cn-south-1.myhuaweicloud.com/3.0.0/x86/openGauss-3.0.0-CentOS-64bit-all.tar.gz",fileName:"openGauss-3.0.0-CentOS-64bit-all.tar.gz"},lite:{name:"openGauss-3.0.0 Lightweight",resourceUrl:"https://opengauss.obs.cn-south-1.myhuaweicloud.com/3.0.0/x86/openGauss-Lite-3.0.0-CentOS-x86_64.tar.gz",fileName:"openGauss-Lite-3.0.0-CentOS-x86_64.tar.gz"},mini:{name:"openGauss-3.0.0 Minimalist",resourceUrl:"https://opengauss.obs.cn-south-1.myhuaweicloud.com/3.0.0/x86/openGauss-3.0.0-CentOS-64bit.tar.bz2",fileName:"openGauss-3.0.0-CentOS-64bit.tar.bz2"}}),b=(0,o.ref)(n.enterprise.name),v=(0,o.ref)(!1),k=(0,o.ref)(0),w=(0,o.ref)(!1),y=(0,o.ref)(),N=(0,o.ref)(!1);(0,o.onMounted)((()=>{t.getInstallConfig.openGaussVersion&&(t.getInstallConfig.openGaussVersion===i.e0.MINIMAL_LIST?b.value=n.mini.name:t.getInstallConfig.openGaussVersion===i.e0.LITE?b.value=n.lite.name:b.value=n.enterprise.name),t.getInstallConfig.packagePath&&(N.value=!0)})),(0,o.onBeforeUnmount)((()=>{y.value?.destroy()}));const S=e=>{k.value=0,b.value=n[e].name;const o=(new Date).getTime(),a=new r.Z({url:`downloadPackage_${o}`});y.value=a,a.onopen((()=>{const t={resourceUrl:n[e].resourceUrl,targetPath:n.targetPath,fileName:n[e].fileName,connectType:"DOWNLOAD_INSTALL_PACKAGE",businessId:`downloadPackage_${o}`};(0,s.LR)(t).then((()=>{v.value=!0,w.value=!0}))})),a.onmessage((o=>{isNaN(Number(o))||(k.value=Number(o),1===Number(o)&&(w.value=!1,N.value=!0,t.setInstallContext({packagePath:n.targetPath,packageName:n[e].fileName,installPackagePath:n.targetPath+n[e].fileName}),a.destroy()))}))},T=()=>{v.value=!1},x=(0,o.computed)((()=>t.getInstallConfig));return(e,t)=>{const s=(0,o.resolveComponent)("svg-icon"),r=(0,o.resolveComponent)("a-button"),a=(0,o.resolveComponent)("a-tag"),w=(0,o.resolveComponent)("a-space"),y=(0,o.resolveComponent)("a-progress"),I=(0,o.resolveComponent)("a-modal");return(0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createVNode)(w,{direction:"vertical",fill:""},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",c,(0,o.toDisplayString)(e.$t("components.OnlineInstall.else1"))+": "+(0,o.toDisplayString)(b.value),1),(0,o.createElementVNode)("div",u,(0,o.toDisplayString)(e.$t("components.OnlineInstall.5mpn3mp10hw0"))+": "+(0,o.toDisplayString)((0,o.unref)(n).targetPath),1),(0,o.createElementVNode)("div",p,[(0,o.unref)(x).openGaussVersion===(0,o.unref)(i.e0).ENTERPRISE?((0,o.openBlock)(),(0,o.createElementBlock)("div",m,[(0,o.createVNode)(s,{"icon-class":"ops-online-install",class:"icon-size mr-lg"}),(0,o.createElementVNode)("div",f,(0,o.toDisplayString)((0,o.unref)(n).enterprise.name),1),N.value?((0,o.openBlock)(),(0,o.createBlock)(a,{key:1,color:"green"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("components.OnlineInstall.5mpn3mp117k0")),1)])),_:1})):((0,o.openBlock)(),(0,o.createBlock)(r,{key:0,onClick:t[0]||(t[0]=e=>S("enterprise"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("components.OnlineInstall.5mpn3mp111s0")),1)])),_:1}))])):(0,o.createCommentVNode)("",!0),(0,o.unref)(x).openGaussVersion===(0,o.unref)(i.e0).MINIMAL_LIST?((0,o.openBlock)(),(0,o.createElementBlock)("div",g,[(0,o.createVNode)(s,{"icon-class":"ops-online-install",class:"icon-size mr-lg"}),(0,o.createElementVNode)("div",d,(0,o.toDisplayString)((0,o.unref)(n).mini.name),1),N.value?((0,o.openBlock)(),(0,o.createBlock)(a,{key:1,color:"green"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("components.OnlineInstall.5mpn3mp117k0")),1)])),_:1})):((0,o.openBlock)(),(0,o.createBlock)(r,{key:0,onClick:t[1]||(t[1]=e=>S("mini"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("components.OnlineInstall.5mpn3mp111s0")),1)])),_:1}))])):(0,o.createCommentVNode)("",!0),(0,o.unref)(x).openGaussVersion===(0,o.unref)(i.e0).LITE?((0,o.openBlock)(),(0,o.createElementBlock)("div",h,[(0,o.createVNode)(s,{"icon-class":"ops-online-install",class:"icon-size mr-lg"}),(0,o.createElementVNode)("div",C,(0,o.toDisplayString)((0,o.unref)(n).lite.name),1),N.value?((0,o.openBlock)(),(0,o.createBlock)(a,{key:1,color:"green"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("components.OnlineInstall.5mpn3mp117k0")),1)])),_:1})):((0,o.openBlock)(),(0,o.createBlock)(r,{key:0,onClick:t[2]||(t[2]=e=>S("lite"))},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("components.OnlineInstall.5mpn3mp111s0")),1)])),_:1}))])):(0,o.createCommentVNode)("",!0)])])),_:1}),(0,o.createVNode)(I,{"mask-closable":!1,"esc-to-close":!1,visible:v.value,"onUpdate:visible":t[3]||(t[3]=e=>v.value=e),"ok-text":e.$t("components.OnlineInstall.5mpn3mp11cg0"),onOk:T},{title:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.$t("components.OnlineInstall.5mpn3mp11g00")),1)])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{size:"large",percent:k.value},null,8,["percent"])])),_:1},8,["visible","ok-text"])])}}}),v=n(83744);const k=(0,v.Z)(b,[["__scopeId","data-v-11540ab5"]]);var w=k},47327:function(e,t,n){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function s(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!==o(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function r(e){var t=s(e,"string");return"symbol"===o(t)?t:String(t)}function a(e,t,n){return t=r(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:function(){return a}})}}]);
//# sourceMappingURL=6399.149e0860.js.map