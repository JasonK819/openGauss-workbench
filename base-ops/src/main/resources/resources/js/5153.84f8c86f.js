"use strict";(self["webpackChunkweb_ui"]=self["webpackChunkweb_ui"]||[]).push([[5153,7096,3844],{3844:function(e,t,n){n.r(t),n.d(t,{clearChart:function(){return d},getBase64:function(){return s},hideLoading:function(){return c},initChart:function(){return a},renderChart:function(){return o},showLoading:function(){return r}});var l=n(44835);let i;const a=e=>{i=l.S1(e)},o=(e,t)=>{t&&l.je(t.name,t.data),i&&i.setOption(e,!0)},d=()=>{i&&i.clear()},r=()=>{i&&i.showLoading()},c=()=>{i&&i.hideLoading()},s=()=>{if(i)return i.getDataURL()}},68957:function(e,t,n){n.r(t),n.d(t,{checkData:function(){return d},jsonFormat:function(){return r}});var l=n(43610),i=n(35589),a=n(90989);const o=(0,l.m)(),d=e=>{let t=!0,n="";return e&&e.cells&&Array.isArray(e.cells)&&e.cells.length>0&&e.cells.forEach((e=>{if("edge"!==e.shape){const l=o.getRules[e.data.cells_type];e.data&&(e.data.rule&&"function"===typeof e.data.rule?e.data.rule(e.data)||(t=!1,n+=`[${e.data.text}]`+a.Z.global.t("modeling.utils.index.5m78yfizcxc0")):l&&"function"===typeof l&&(l(e.data)||(t=!1,n+=`[${e.data.text}]`+a.Z.global.t("modeling.utils.index.5m78yfizcxc0"))))}})),!t&&n&&i.Z.error({position:"bottomRight",content:n,closable:!0,duration:1e4}),t},r=e=>{if(e){const t=e.toJSON();return t.cells.forEach((e=>{e.data&&e.data.cells_type?e.cells_type=e.data.cells_type:"edge"===e.shape&&(e.cells_type="line")})),t}return""}},57096:function(e,t,n){n.r(t),n.d(t,{default:function(){return o}});var l=n(70821),i=(0,l.defineComponent)({setup(e){return(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)("div"))}});const a=i;var o=a},39883:function(e,t,n){n.r(t),n.d(t,{default:function(){return R}});n(57658);var l=n(70821),i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA+gAAAJYCAMAAADGwDwXAAAAb1BMVEX////p6enZ2dnFxcWhoaH19fXd3d2RzXRUcMfT09Pt7e3j893J57ut2ZnV2/GrueN+ldWzs7Opt+O33aXJ5bufpZ2b0YHp9eP19/ubsY94j9NWcsdugbuRl6nb7dGv25mZt4vB47Hb79GToc2zuc8JB5cRAAAUhUlEQVR4AezVgaqiQBiAUVPKGjEyfP9n3ZnJlgL10nLTcs9B/mRA0IaPKQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAZR2fvPZs/WTtLwEmCR3+A+Ohn8/xymPu2fHQmyZeeaz9bcBgIvRLcb2NOROht0V/G8CHGA+9uF6uw5gxHnrRt/0wgM8wFfrxPIwZU6HXzTCAzzAR+vF8GcaMidDrph0G8BnGQ79e45XH3LPjofd9vPJY+9sAAAAAAAAAAAAAAAAAAAAAAAAAWFmoqnK4KcunBWArQheKsoo3qfIqxJv7ArAZ+RRPgXfxN1QPC8Bm5KRj3LnvVHteCI502JKc9P0gT5V3f1ennPZpnIrX5iGO/UJzF+duoZn+jMOC8+U//t/nUtt1WHC7dt+wXfvT6yH/qOzKFLnQhS70D9mut4RehZh6DD08hl7MhQ58mxx47PuFEx34Nrno2PUt7S63XgzZA9tw67u8h14JHbaoSkmnrtNN+k3Fh27t1wJ+Uyi7qsvnd1Xm6Iu0ENZ+LeCXhR8X+HpN37Z13zdrvwfwNk1bD1qpw0b19YN+7bfhXf6wV8erkcJAAMat0moVQzaEe4G+/zuek2w5tbpHWXXazPf7I7sRSoeVj4Fti84pHSjSqvO2HbQnAnC4deftqD0RgKPlhT7KxxjzJWrPBOBgY+58mM7qXjorHShN2uFtO4UulUvvU/EAyrIMPV8H7aEAHGqYhT4SOlCmWegjGx0o1Sz0oY0xXbRnAnCwUcqOwzCMcqbOR+2ZABxsvK/0mag9E4CDDYQOGBDpHDBgXIWuPQ+AEwzLzgfteQCcYVF61J4GwDkGOgcMiHQOGBDpHDAg0jlgQKRzwIBI5wAAAAAAAMC5/qxozwPgBO2K9jwATkDogAGEDhhA6IABhA4YQOiAAYQOGEDogAGEDhhA6IABhA4YQOiAAYQOGEDogAGEDhhA6IABhI6qb5I6fa3r+6NaeywciNAxZS2kbKm86acnt76qG+2xcBxCR9bLBr+lZZ6Dz8WjDLuhu+B9F4LTHhAXkbRT31J7arxnpZdjJ3TnuztP6ib0/0KfKpfN/jj091c53qvvnW/T8XrR+TKdLxed8mO8XXh++4d/X4een390Mx+bf3vV63q78HW9/PjXlX6S6gw1odsLPcw777pA6D/ldZ0Xekq77uX8DL1qTvlP0LAOXZ6tOu86pz0lTpei/sZGx++yFfq6885rT4mz5cRz2rfU+uczFGEj9LzQvXz4kC9Be0ycbB56Q+jl2Qjd587ddFb30lnppbtH3dT5qxTf37SHwnE2Qk87vOum0KVy6X0qHmVLKzyVLq1Ptd+aW689FI7z39Dz1WnPiauReVG+hu5moXtCB0rwMHTPRgeK8DX0aha660JIF+0xATxjI3QvZQfnnJczde61xwTwjL3Ql4L2mACesRG6I3SgMBuhV4HOgbJshV75VejaQwJ4zmbobtm50x4SwHM2Q1+WHrRnBPCk7dDnpdM58OvthF4FOgfKsRf6Z+l0DhRgN/RcOp0DJdgPXUqnc6AID0KvAp0DZXgUOoBCELo1f9mr49W2dTiOo65Fe29d8och7/+sk+xkHYnXLU3mOPmeA/mZCgxG6gcRSegQQOgQYCn0/0/c+xuBKwkdAggdAggdAggdAggdAggdAggdAggdAggdAggdAggdAggdAgidb/nvY/rv6S6buzo+Vpr7OvcrzbYZuxXnxRu/YDn0s3fXOq7dise13/xxTVvyL/v9a0IXutADQuexnGe+HDrwwIQOAYQOAYQOAYQOAYQOAYQOAYQOAYQOAYQOAYQOAYQOAYQOAYROM5TSz8++//VvnoTQqVrdx18Z6sI4dH2591dxO0Jn7nsy1t9QDgtT8b/z/trGe3fZfKvjdaX5UufLSrNtxtuK8+KNfz8Nva0vhX727lrH9bbicb1s/rimLelu7hj6/BwPjQ9fXelCF7rQHy30WvR0e8+h18rbzf516DyW09Db2lLoPLNx6Evphf7EhE4NvQVe++6ne/0Yeif07bg2SqHT/bzA3eibJXSuNxddDmmPU+vdIXs2Qehc79j1HHoR+vYInetNgbeuSz8/28Iw3vuz+CR0bmAYyzjd36Vvrdfa68Jw76/ik9C5ieGPC9yT0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0CGA0PmeH+zV3W7iOhTHUbBVpPouOu//rscO0M4waKZR+Aj815K6G/kiRIl+2rwUoUMAoUMAoUMAoUMAoUMAoUMAoUMAoUMAoUMAoUMAoUMAoUMAoUMAoUMAobNeq8PxqpTTSXn2U/ELobNeK63rF6PyOi6mtiv12Y/FN6GzXjlv76n/tXo6mItnG4TOeufQj/+nU+PNSt8OobNeaa20r9B75WOz/z30z48xPnfL5qGPjwfNfZ/7B83xMg53ndeiXPL6L0Mf5z+656M+1+GBn2t/98/1+1zcyfHFr+76D622MhWhC13obx36rPc9r/Wv0Hf1Tr/EcteiXOIy9Fvck5dU65KNzmMJnRtp5ZT2NLe+O2XPJgidGynn0KvQt0forNZ3eR99ke9qOfY9ip8P2Aihs16Zap2XeC99tD6fTO3Zj8U3oXMT7Z8HPJPQ4c38d2GcCR3ezD2iFDpsjNAhgNAhgNAhwKuEfu2ewA8JHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIHQIIndv7n72621FbB+AgDrZAwne+Ou//psdOoB9AA6kNzjTzk9bLptK/KDCKuqNEaehSA0qUhr5HIdUzxRDm3zGMfkdYlCgNfYdCrqHXymN9Uf4KcfR7oqJEaeg7lKcnei4/Kc7Bz8X/yeVUj8th3Xkux+lL57Gcxy+d9Wacf5z3Af3+r6/P+4Ceba688Q+b9fpbmwu3+WGz9UP71sd1XPmBtJ6rO5lvfM++b0KooU9919qnxtPSI93QDd3QcaGXwn+GXiqvT/bl0PVnzwJa4z4g0marT2zqhxK2oXdDidLQ96YGPoVefn6GfjD0v0OJ0tB3ZnqQ+0TvhhKloe9MiEWO8Zp2nlq/Za/VKFEa+h7VJ/ocejT0NpQoDX2PauiHGOa+a/Epj35LVJQoDX2PptBL6bX18leOOY1+S1SUKA1d5YE++g1wUaI0dKkBJUpDlxpQojR0qQElSkOXGlCiNHSpASVKQ5caUKI0dKkBJUpDlxpQojR0qQElSkOXGlCiNHSpASVKQ5caUKI0dKkBJUpDlxpQojR0qQElSkOXGlCipGxKm0QJiLIpbRIlIMqmtEmUgCib0iZRAqJsSptECYiyKW0SJSDKprRJlIAom9ImUQKibEqbRAmIsiltEiUgyqa0SZSAKJvSJlEComxKm0QJiLIpDfffnXqNEhBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlUxqOHBBlU92kGMP1RQi/XdAyckCUTfVSow6xvKiVx1Re5DRf0AvkgCib6qq0fcjld4pz8HPxWkYOiLKprm5919qnxpOP9NfIAVE21VONfA69VF6f7MuhX071uBzWnedynL50Hst5/Ph5/8U8lxtz/2Wvt6pef/d8Z3PljX/YrNff2ly4zQ+b56eb739o5aY+bH7qo1vzgbSeqzuZb/xHMo/hGruhG7qh/7uhh1yf6OnX0A/xE//TP+b+i1mvPQvIzb/fVFel7xVPdM3IAVE21VUK17Tz1Prhmr0WkQOibKqrcAs9Gvr7yAFRNtVJeZaXI5czhrnvWnzKo98XATkgyqZ6CTHGXB/ipfTaermSrxe0jBwQZVMdpZcX9Aw5IMqmNBw5IMqmNBw5IMqmevqfvTrcbRMIgjhOOMVS+Mb7v2w5sJPKtlLoLt4d7/8n9UyRMrLwjMB/UR6QSiYQTnlAKplAOOUBqWQC4ZQHpJIJhFMekEomEE55QCqZQDjlAalkAuGUB6SSCYRTHpBKJhBOeUAqmUA45QGpZALhlAekkgmEUx6QSiYQTnlAKplAOOUBqWQC4ZQHpJIJhFMekEomEE55QFUyATOVslfOBMxUyl45EzBTKXvlTMBMpeyVMwEzlbJXzgTMVMpeORMwUyl75UzATKXslTMBM5WyV84EzFTKXjkTMFMpe+VMwEyl7JUzATOVslfOBMxUyl45EzBTKXvlTMBMpeyVMwEzlbJXzgTMVMpeORMwUyl75UzATKXslTMBM5WyV84EzFTKXjkTMFMpe+VMwEyl7JUzATOVslfOxLextXG9mNq4Xky3G+8uYzHJZOjnaFPf+nLRV97/M8zTduPtZSwmmQz9HH3aw3z9N7Vt8Nvi313GYpLJ0E+07Hrdd1/7uvGpwis9YzHJZOgnmq8v8r7y/mZn6HuolL1yJv7WR87QUxSTTIZ+nnXoU7+6DX34behfn/34Go6dl+X4fNH5sZwf/zzvS7Tvr37O+2Jelgdzn9kfVb+/99yTefDBP2T2+7syf3nMD5mXp5n7f7TloT5kfjzNPPITPT+P/CDW8/BOtgd/2s6PvNEZOkNn6HpDH9vPtOd167fZv7lnZT/ivphk5svEt+vLe/toDH0/lbJXzsTN9j5ftHHbd1/8NEd/rVfIWEwyGfopprl1/QXexvVjGOc2T9Hf6xUyFpNMhv46JWaes5hkMnQ4y1hMMhk6nGUsJpkMHc4yFpNMhg5nGYtJJkOHs4zFJJOhw1nGYpLJ0OEsYzHJZOhwlrGYZDJ0OMtYTDIZOpxlLCaZDB3OMhaTTIYOZxmLSSZDh7OMxSSTocNZxmKSydDhLGMxyWTocJaxmGQydDjLWEwyGTqcZSwmmQwdzjIWk0yGfr4/7JVfb9s4EAcVCw0cA0fQfDrcQ4ED7vt/xhPluqAp1dGfNfxbceaBboRmknB3oMZQXEychA7GKC4mTkKHHfxbkZ8pLiZOW+fPig6OjZfFxPl6JxwYz4uJk9BhIZ4XEyehN4OXJcKp7wRhvCwRTn0nCONliXDqO0EYL0uEU98JwnhZIpz6ThDGyxLh1HeCMF6WCKe+E4TxskQ49Z0gjJclwqnvBGG8LBFOfSe8gpBiPKcUdmq8LBFOfSfYE+J9QnFf6l6WCKe+E8xJ5YzSHpOXJcKp7wRrHjrfV7qXJcKp7wRjqs7P57Dd5WWJcOo7wZh6SOdI6Djf7wRbbi/0mD9iun2RNsu8LBFOfSfYEm+dhzyeX6Vvf6V7WSKc+k6w5ddohtBz5WHTnAgdJ6GL8xj67ctA6Djf7QRTQhF6JHScMk4wpQg98kbHqeMEW4rQwzmlTXMidJyELk7Mg0khhJjPcUxxs8zLEuHUd7bKpb9/nk63z/5k4Y31kIbsN8u8LBFOfWej9P11/MyV95fhH9dLd+oNxIHQcSo6m+X6+8wv9/G1Pha/l2TXuZslwqnvbJYx9LHv/M+x8YvFK72LO6dU4GWJcOo7m6UIfah8/Opp6F8/8vHVfXv+9zik0P34+hwebznrgT///x/D+fFw1gPPz2vn9Luen7Xzc7iY2pmvKj9fei5xdguv/37Wzvx8kfPJQCbOz1nn8iEPlzpxfsw614xo1rlqIHvPNYMqLt5X6F8PpaeO0Amd0N8d+qUMvett1OGh8x3MLeYa6oHjbNfZLGvf6GtINp27WSKc+s5mKdK+jq3fs7cgmXTuZolw6jubpQi9Nw/9Vvrezt0sEU59Z7OMoXf96dZ3Lv5yNdQng87dLBFOfWebnPr+2o9v8f6UWx+eXPvrxfJHpP2du1kinPpOuGOauQ1elginvhOE8bJEOPWdIMJfFfmZlyXCqe8EETwvEU59J4jgeYlw6jst+Flh5W0Kz0uEU99pwau8Ltk6JM9LhFPfaQGhFxA6TkWnBYReQOg4FZ0WEHoBoeNUdFpA6AWEjlPRaQGhFxA6TkWnBYReQOg4FZ0WEHoBoeNUdFow5/27wupnyUPoOBWdFrzid3ULoeNUdFpA6AWEjlPRaQGhFxA6TkWnBU2Efg7jX9V9d07/8HCO3fdnfYn5ee16bkjDmR7O2pmf187pdz0/a2ccLqZ25quKK84lzm7Z9f8+a2d+vsj5ZFATZ5x1Lht4vF3qxJlmnWtGNOtcNZA/nJPQh+fnueGvH9d4Je9unNAJndBbCX0pc8u0hMkl7nDhxFk7/6noNvCK39UthI7ziE5CryB0nEd0EnoFoeM8opPQKwgd5xGdhF5B6DiP6Gw6dMs/3MvAcbbpJHRCx9mAk9AJHWcDTkIndJwNOAmd0HE24CR0QsfZgJPQCR1nA87jhP5/e3Ws0zoMxXEY2UzeMjAgQOL9nxLM6KlJaXpOzvcNGarbX3ON/rKha2oauqFrVm4auqFrFmgauqFrFmgauqFrFmgauqFrFmgauqFrFmgauqFrFmgauqFrFmgauqFrFmgauqFrFmgauqFrFmgauqFrFmgmH/povR3/tqFrVmnmHvrYxks7vnRD16zSzD30Pubj8NcNXbNKM/nQ5+P4lW7omlWauYe+zccwdE3NSw/970Y39IjNj0XU96zSvMLQ+y3/9JVU3hbPfp8zvS/mZ1+LI93vxfzsc3HPez9u6NvtN/qz/3hwdSGG/l8e8d/R1KzW3KfNjfdx5k9mOUhNzcjNfVr/vdD7qT+Z5SA1NSM3d2q9b6de6GkOUlMzcjO8LAepqRm5GV6Wg9TUjNwEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgPv8ABOMmaX1q6b3AAAAAElFTkSuQmCC",a=n.p+"img/line.c94ac980.png",o=n.p+"img/pie.9485396b.png",d=n.p+"img/graph.6174455c.png",r=n.p+"img/heatmap.9cebc240.png",c=n.p+"img/mix.e21e7796.png",s=n.p+"img/scatter.88ca562a.png",A=n(17366),m=n(57096),u=n(3844),p=n(15784),v=n(68957),g=n(89965),f=n(73017),h=n(42119),x=n(65489),O=n(57330);const b={class:"container modeling-dialogs-visual-edit-index"},C={class:"main"},I={class:"header"},w={class:"title"},Q={class:"chart"},y={class:"vm-header"},B={class:"vm-content"},N={class:"chart-container"},H={class:"config"},k={class:"config-main"},z={class:"config-content common"},T={class:"config-content common"},E={key:0,class:"config-content"},V={class:"config-footer"},G={class:"visual-edit-select-chart-type-container"},q=["onClick"],U={key:0,src:i,alt:""},D={key:1,src:a,alt:""},M={key:2,src:o,alt:""},P={key:3,src:d,alt:""},X={key:4,src:r,alt:""},F={key:5,src:c,alt:""},J={key:6,src:s,alt:""},Z={class:"type-name"};var K=(0,l.defineComponent)({setup(e,{expose:t}){const{t:i}=(0,O.QT)();let a,o;const d=(0,l.ref)(!1),r=(0,l.reactive)({activeKey:"1",title:i("modeling.visual-edit.index.5m7ihlv0niw0"),loading:!1,number:[],string:[],datetime:[]}),c={bar:(0,l.defineAsyncComponent)((()=>Promise.all([n.e(8454),n.e(1787)]).then(n.bind(n,28454)))),line:(0,l.defineAsyncComponent)((()=>Promise.all([n.e(1544),n.e(5574)]).then(n.bind(n,51544)))),mix:(0,l.defineAsyncComponent)((()=>Promise.all([n.e(7789),n.e(869)]).then(n.bind(n,4998)))),pie:(0,l.defineAsyncComponent)((()=>n.e(7244).then(n.bind(n,3138)))),graph:(0,l.defineAsyncComponent)((()=>Promise.all([n.e(9945),n.e(8050)]).then(n.bind(n,99945)))),heatmap:(0,l.defineAsyncComponent)((()=>n.e(9209).then(n.bind(n,31791)))),scatter:(0,l.defineAsyncComponent)((()=>Promise.all([n.e(3379),n.e(8325)]).then(n.bind(n,3379))))},s=(0,l.computed)((()=>c[W.chartType])),K=(e,t)=>{d.value=!0,a=e,r.loading=!0,setTimeout((()=>{r.loading&&(r.loading=!1)}),5e3),(0,l.nextTick)((()=>{let e=()=>{let t=document.getElementById("chartDiv");t&&t.offsetWidth>0?(0,u.initChart)(t):setTimeout(e,100)};e()})),$(""),(0,u.clearChart)(),o=t,de().then((()=>{oe.list.length>0&&te(oe.list[0],0)})),L()},j=()=>{d.value=!1},L=()=>{let e={...(0,v.jsonFormat)(a),id:o.id,dataFlowId:window.$wujie?.props.data.id};(0,g.WK)(e).then((e=>{if(200===Number(e.code)&&e.query_data.length>0){let t=[],n=[],l=[],i=e.query_data[0];for(let a in e.dimension_options){let o=e.dimension_options[a];"number"===typeof i[o]?n.push({value:o,label:o}):isNaN(i[o])&&!isNaN(Date.parse(i[o]))||"date"===o||"year"===o||"datetime"===o?l.push({value:o,label:o}):t.push({value:o,label:o})}(0,g.Yn)(o.id).then((i=>{r.string=R(t,i&&i.data&&Array.isArray(i.data)?i.data:[]),r.number=n,r.datetime=l,(0,f.setQueryData)(e.query_data)})).catch((()=>{r.string=R(t,[]),r.number=n,r.datetime=l,(0,f.setQueryData)(e.query_data)}))}}))},R=(e,t)=>{let n=e.filter((e=>!e.isCustom)),l=t.map((e=>({value:`custom|${e.id}`,label:e.name,isCustom:!0})));return[...n,...l]};let S=(0,l.ref)("");const W=(0,l.reactive)({title:"",chartType:"",loading:!1});let Y=null;const _=e=>{Y&&(clearInterval(Y),Y=null);const t=20;let n=0;Y=setInterval((()=>{(he.value||n++>t)&&(clearInterval(Y),Y=null,he.value&&e(),W.loading=!1)}),100)},$=(e,t)=>{W.chartType="",e&&(W.chartType=e),t&&(W.title=""),(0,l.nextTick)((()=>{_((()=>{he.value?.init(),W.loading=!1}))})),ie.option=null},ee=(e,t)=>{te(e,t),(0,u.clearChart)()},te=(e,t)=>{W.loading=!0,W.title=e.config.title?e.config.title:"",W.chartType=e.config.chartType?e.config.chartType:"",S.value=t,(0,l.nextTick)((()=>{_((()=>{he.value?.init(e.config),W.loading=!1}))})),ie.option=null},ne=((0,h.yj)(),()=>{let e={...W,dataFlowId:window.$wujie?.props.data.id,operatorId:o.id};he.value?.config&&(e={...e,...he.value.config});let t={name:e.title,type:e.chartType,dataFlowId:window.$wujie?.props.data.id,operatorId:o.id,paramsJson:JSON.stringify(e)};if(!t.name)return void p.Z.error({content:i("modeling.visual-edit.index.5mpsromgvig0")});if(!t.type)return void p.Z.error({content:i("modeling.visual-edit.index.5mpsromgvxg0")});r.loading=!0;const n=e=>{200===Number(e.code)?(p.Z.success({content:i("modeling.visual-edit.index.5m7ihlv0nl00")}),de().then((()=>{let e=S.value||0===S.value?S.value:oe.list.length-1;te(oe.list[e],e)}))):r.loading=!1};S.value||0===S.value?(t.id=oe.list[S.value].id,(0,g.yf)(t).then((e=>n(e)))):(0,g.SW)(t).then((e=>n(e)))}),le=(0,l.ref)(!1),ie=(0,l.reactive)({loading:!1,option:null}),ae=()=>{le.value=!0;let e={name:W.title?W.title:i("modeling.visual-edit.index.5m7ihlv0mig0"),imgBase64:(0,u.getBase64)(),dataFlowId:window.$wujie?.props.data.id,chartDataJson:"string"===typeof ie.option?ie.option:JSON.stringify(ie.option)};(0,g.qR)(e).then((e=>{200===Number(e.code)&&p.Z.success({content:i("modeling.visual-edit.index.5m7ihlv0nnw0")})}))},oe=(0,l.reactive)({visible:!0,list:[]}),de=()=>new Promise((e=>{r.loading=!0,(0,g.nB)(o.id).then((t=>{r.loading=!1,200===Number(t.code)&&t.data&&(t.data.forEach((e=>e.config=JSON.parse(e.paramsJson))),oe.list=t.data?t.data:[],e(oe.list))}))})),re=()=>{oe.visible=!oe.visible};let ce=!1;const se=e=>{"add"===e&&(ce=!0,ue())},Ae=e=>{r.loading=!0,(0,g.R7)(e.id).then((e=>{200===Number(e.code)?(p.Z.success({content:i("modeling.visual-edit.index.5m7ihlv0nqc0")}),de().then((()=>{oe.list.length>0?te(oe.list[0],0):(ce=!0,ue())}))):r.loading=!1})).catch((()=>{r.loading=!1}))},me=(0,l.reactive)({visible:!1,other:{}}),ue=()=>me.visible=!0,pe=()=>me.visible=!1,ve=(e,t)=>{(0,l.nextTick)((()=>{$(e,t),pe(),(0,u.clearChart)(),ce&&(ce=!1,S.value="")}))},ge=(0,l.ref)(),fe=()=>{ge.value?.open(o.id)},he=(0,l.ref)(),xe=()=>{if(he.value&&he.value.validate()){let e={paramsData:{...W,operatorId:o.id},dataFlowId:window.$wujie?.props.data.id,operatorsData:{...(0,v.jsonFormat)(a)}};he.value?.config&&(e={paramsData:{...W,operatorId:o.id,...he.value.config},dataFlowId:window.$wujie?.props.data.id,operatorsData:{...(0,v.jsonFormat)(a)}}),(0,u.showLoading)(),(0,g.xl)(e).then((e=>{200===Number(e.code)&&(ie.option=e.chartData,(0,u.renderChart)(e.chartData,"scatter"===W.chartType&&e.mapData&&e.mapData.name&&e.mapData.data?e.mapData:null)),(0,u.hideLoading)()})).catch((()=>{(0,u.hideLoading)()}))}};return t({open:K}),(e,t)=>{const n=(0,l.resolveComponent)("a-button"),i=(0,l.resolveComponent)("a-doption"),a=(0,l.resolveComponent)("a-dropdown"),o=(0,l.resolveComponent)("icon-plus"),c=(0,l.resolveComponent)("icon-menu-fold"),u=(0,l.resolveComponent)("icon-menu-unfold"),p=(0,l.resolveComponent)("a-input"),v=(0,l.resolveComponent)("a-form-item"),g=(0,l.resolveComponent)("a-option"),h=(0,l.resolveComponent)("a-select"),O=(0,l.resolveComponent)("a-spin"),K=(0,l.resolveComponent)("a-modal");return(0,l.openBlock)(),(0,l.createBlock)(K,{class:"visual-edit-container",visible:d.value,closable:!1,footer:!1,"body-style":"padding: 0; width: 100%; height: 900px;","modal-style":{minWidth:"1480px",height:"900px"},"unmount-on-close":""},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(O,{style:{width:"100%",height:"100%"},loading:(0,l.unref)(r).loading},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",b,[(0,l.createElementVNode)("div",C,[(0,l.createElementVNode)("div",I,[(0,l.createElementVNode)("div",{class:"back",onClick:j},[(0,l.createVNode)((0,l.unref)(A.Z)),(0,l.createTextVNode)(" "+(0,l.toDisplayString)(e.$t("modeling.visual-edit.index.5m7ihlv0lrk0")),1)]),(0,l.createElementVNode)("div",w,(0,l.toDisplayString)((0,l.unref)(r).title?(0,l.unref)(r).title:e.$t("modeling.visual-edit.index.5m7ihlv0mig0")),1)]),(0,l.createElementVNode)("div",Q,[(0,l.createElementVNode)("div",{class:(0,l.normalizeClass)(["visual-menu",{"hide-visual-menu":!(0,l.unref)(oe).visible}])},[(0,l.createElementVNode)("div",y,(0,l.toDisplayString)(e.$t("modeling.visual-edit.index.5m7ihlv0mmo0")),1),(0,l.createElementVNode)("div",B,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(oe).list,((t,o)=>((0,l.openBlock)(),(0,l.createBlock)(a,{trigger:"contextMenu",key:`menuItem${o}`},{content:(0,l.withCtx)((()=>[(0,l.createVNode)(i,{onClick:e=>Ae(t)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.$t("modeling.visual-edit.index.5m7ihlv0mpc0")),1)])),_:2},1032,["onClick"])])),default:(0,l.withCtx)((()=>[(0,l.createVNode)(n,{class:"mb-s",type:o===(0,l.unref)(S)?"outline":"dashed",onClick:e=>ee(t,o)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(t.name?t.name:e.$t("modeling.visual-edit.index.5m7ihlv0mig0")),1)])),_:2},1032,["type","onClick"])])),_:2},1024)))),128)),(0,l.createVNode)(n,{type:"primary",onClick:t[0]||(t[0]=e=>se("add"))},{icon:(0,l.withCtx)((()=>[(0,l.createVNode)(o)])),default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.$t("modeling.visual-edit.index.5m7ihlv0ms00")),1)])),_:1})])],2),(0,l.createElementVNode)("div",N,[(0,l.createElementVNode)("div",{id:"chartDiv",ref:(e,t)=>{t["chartRef"]=e}},null,512)]),(0,l.createElementVNode)("div",{class:(0,l.normalizeClass)(["vm-toggle",{"hide-vm-toggle":!(0,l.unref)(oe).visible}]),onClick:re},[(0,l.withDirectives)((0,l.createVNode)(c,null,null,512),[[l.vShow,(0,l.unref)(oe).visible]]),(0,l.withDirectives)((0,l.createVNode)(u,null,null,512),[[l.vShow,!(0,l.unref)(oe).visible]])],2)])]),(0,l.createElementVNode)("div",H,[(0,l.createElementVNode)("div",k,[(0,l.createElementVNode)("div",z,[(0,l.createVNode)(m["default"],{ref:(e,t)=>{t["commonRef"]=e}},null,512),(0,l.createVNode)(v,{required:"",label:e.$t("modeling.visual-edit.index.5m7ihlv0mxo0"),rules:[]},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,{"max-length":140,"show-word-limit":"",modelValue:(0,l.unref)(W).title,"onUpdate:modelValue":t[1]||(t[1]=e=>(0,l.unref)(W).title=e),placeholder:e.$t("modeling.visual-edit.index.5m7ihlv0n0c0")},null,8,["modelValue","placeholder"])])),_:1},8,["label"])]),(0,l.createElementVNode)("div",T,[(0,l.createVNode)(v,{required:"",label:e.$t("modeling.visual-edit.index.5m7ihlv0n2s0"),rules:[]},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(h,{modelValue:(0,l.unref)(W).chartType,"onUpdate:modelValue":t[2]||(t[2]=e=>(0,l.unref)(W).chartType=e),placeholder:e.$t("modeling.visual-edit.index.5m7ihlv0n5c0"),onChange:t[3]||(t[3]=e=>ve(e))},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(f.chartTypes),((e,t)=>((0,l.openBlock)(),(0,l.createBlock)(g,{key:`chartType${t}`,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])])),_:1},8,["label"])]),(0,l.unref)(W).chartType?((0,l.openBlock)(),(0,l.createElementBlock)("div",E,[(0,l.createVNode)(O,{loading:(0,l.unref)(W).loading,style:{width:"100%",height:"100%"}},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(),(0,l.createBlock)((0,l.resolveDynamicComponent)((0,l.unref)(s)),{ref:(e,t)=>{t["configRef"]=e,he.value=e},numberOption:(0,l.unref)(r).number,stringOption:(0,l.unref)(r).string,datetimeOption:(0,l.unref)(r).datetime,onOpenCDD:fe},null,8,["numberOption","stringOption","datetimeOption"]))])),_:1},8,["loading"])])):(0,l.createCommentVNode)("",!0)]),(0,l.createElementVNode)("div",V,[(0,l.createVNode)(n,{type:"primary",onClick:xe},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.$t("modeling.visual-edit.index.5m7ihlv0n7s0")),1)])),_:1}),(0,l.createVNode)(n,{type:"primary",onClick:ne},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.$t("modeling.visual-edit.index.5m7ihlv0na80")),1)])),_:1}),(0,l.withDirectives)((0,l.createVNode)(n,{type:"primary",loading:(0,l.unref)(ie).loading,onClick:ae},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.$t("modeling.visual-edit.index.5m7ihlv0ndo0")),1)])),_:1},8,["loading"]),[[l.vShow,(0,l.unref)(ie).option]])])]),(0,l.createVNode)(K,{visible:(0,l.unref)(me).visible,title:e.$t("modeling.visual-edit.index.5m7ihlv0ng80"),footer:!1,width:"690px",onCancel:pe},{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",G,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(f.chartTypes),((e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)("div",{key:`chartType${t}`,onClick:t=>ve(e.value,!0)},["bar"===e.value?((0,l.openBlock)(),(0,l.createElementBlock)("img",U)):"line"===e.value?((0,l.openBlock)(),(0,l.createElementBlock)("img",D)):"pie"===e.value?((0,l.openBlock)(),(0,l.createElementBlock)("img",M)):"graph"===e.value?((0,l.openBlock)(),(0,l.createElementBlock)("img",P)):"heatmap"===e.value?((0,l.openBlock)(),(0,l.createElementBlock)("img",X)):"mix"===e.value?((0,l.openBlock)(),(0,l.createElementBlock)("img",F)):"scatter"===e.value?((0,l.openBlock)(),(0,l.createElementBlock)("img",J)):(0,l.createCommentVNode)("",!0),(0,l.createElementVNode)("div",Z,(0,l.toDisplayString)(e.label),1)],8,q)))),128))])])),_:1},8,["visible","title"]),(0,l.createVNode)(x["default"],{stringOption:(0,l.unref)(r).string,onSetCustomList:t[4]||(t[4]=e=>(0,l.unref)(r).string=R((0,l.unref)(r).string,e)),ref:(e,t)=>{t["custormDimensionDialogRef"]=e,ge.value=e}},null,8,["stringOption"])])])),_:1},8,["loading"])])),_:1},8,["visible"])}}}),j=n(83744);const L=(0,j.Z)(K,[["__scopeId","data-v-24e1d858"]]);var R=L}}]);
//# sourceMappingURL=5153.84f8c86f.js.map