/*
 * Copyright (c) 2022 Huawei Technologies Co.,Ltd.
 *
 * openGauss is licensed under Mulan PSL v2.
 * You can use this software according to the terms and conditions of the Mulan PSL v2.
 * You may obtain a copy of Mulan PSL v2 at:
 *
 * http://license.coscl.org.cn/MulanPSL2
 *
 * THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND,
 * EITHER EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT,
 * MERCHANTABILITY OR FITFOR A PARTICULAR PURPOSE.
 * See the Mulan PSL v2 for more details.
 * -------------------------------------------------------------------------
 *
 * BarChartGenerateServiceTest.java
 *
 * IDENTIFICATION
 * base-ops/src/test/java/org/opengauss/admin/plugin/service/modeling/BarChartGenerateServiceTest.java
 *
 * -------------------------------------------------------------------------
 */

package org.opengauss.admin.plugin.service.modeling;

import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import org.opengauss.admin.common.core.domain.model.ops.OpsClusterNodeVO;
import org.opengauss.admin.plugin.ModelingBaseTest;
import org.opengauss.admin.plugin.domain.entity.modeling.ModelingDataFlowEntity;
import org.opengauss.admin.plugin.domain.model.modeling.ModelingDataFlowSqlObject;
import org.opengauss.admin.plugin.service.modeling.operator.IModelingDataFlowProcessService;
import org.opengauss.admin.plugin.service.modeling.visualization.IModelingVisualizationCustomDimensionsService;
import org.opengauss.admin.plugin.service.modeling.visualization.impl.generator.BarChartGenerateServiceImpl;
import org.junit.*;
import org.junit.jupiter.api.Assertions;
import org.junit.runner.RunWith;
import org.mockito.ArgumentMatchers;
import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.springframework.test.context.junit4.SpringRunner;

import java.sql.SQLException;
import java.util.*;

import static org.mockito.Mockito.when;

@RunWith(SpringRunner.class)
public class BarChartGenerateServiceTest extends ModelingBaseTest {

    @InjectMocks
    private BarChartGenerateServiceImpl barChartGenerateService = new BarChartGenerateServiceImpl();

    @Mock
    private IModelingDataFlowProcessService modelingDataFlowProcessService;
    @Mock
    private IModelingDataFlowService modelingDataFlowService;
    @Mock
    private IModelingDataBaseService modelingDataBaseService;
    @Mock
    public IModelingVisualizationCustomDimensionsService modelingVisualizationCustomDimensionsService;


    public JSONObject paramsObject;
    public List<Map<String,Object>> queryData;

    private void prepareData() throws SQLException, ClassNotFoundException {
        //test data init
        OpsClusterNodeVO clusterNodeVO = new OpsClusterNodeVO();
        ModelingDataFlowSqlObject sqlObject = new ModelingDataFlowSqlObject();
        sqlObject.setExecuteClusterNode(clusterNodeVO);

        String paramsInJsonString = "{\"paramsData\":{\"title\":\"sss\",\"chartType\":\"bar\",\"loading\":false,\"operatorId\":\"5b0de7e4-417d-4413-89dd-3024f889dbe6\",\"indicator\":[{\"field\":\"price_total\",\"type\":\"sum\",\"unit\":\"ss\"}],\"dimension\":[{\"field\":\"department\",\"num\":5}],\"showType\":{\"key\":1,\"dimension\":\"brand_type\",\"dateField\":\"\",\"particle\":\"\",\"compareWay\":\"\"}},\"dataFlowId\":\"1301\",\"operatorsData\":{\"cells\":[{\"shape\":\"edge\",\"attrs\":{\"line\":{\"stroke\":\"#222c36\",\"strokeWidth\":1,\"targetMarker\":{\"name\":\"classic\",\"size\":8}}},\"id\":\"eedad35e-0d4c-4f1e-9287-15c284344e4e\",\"zIndex\":0,\"connector\":{\"name\":\"rounded\"},\"router\":{\"name\":\"manhattan\"},\"source\":{\"cell\":\"184821b0-e0e7-4351-8300-2dbd37ac76de\",\"port\":\"port2\"},\"target\":{\"cell\":\"5b0de7e4-417d-4413-89dd-3024f889dbe6\",\"port\":\"port1\"},\"cells_type\":\"line\"},{\"position\":{\"x\":630,\"y\":430},\"size\":{\"width\":220,\"height\":60},\"view\":\"vue-shape-view\",\"shape\":\"BaseNode\",\"component\":{},\"id\":\"5b0de7e4-417d-4413-89dd-3024f889dbe6\",\"data\":{\"type\":\"BaseNode\",\"cells_type\":\"query\",\"text\":\"查询算子\",\"configName\":\"QueryOperator\",\"icon\":\"modeling-chaxun\",\"table\":\"modeling_test_data_sales_list\",\"fields\":[],\"showDisabledCheckbox\":false,\"antvSelected\":true},\"ports\":{\"groups\":{\"top\":{\"position\":\"top\",\"attrs\":{\"circle\":{\"r\":5,\"magnet\":true,\"stroke\":\"#5F95FF\",\"strokeWidth\":1,\"fill\":\"#fff\",\"style\":{\"visibility\":\"hidden\"}}}},\"bottom\":{\"position\":\"bottom\",\"attrs\":{\"circle\":{\"r\":5,\"magnet\":true,\"stroke\":\"#5F95FF\",\"strokeWidth\":1,\"fill\":\"#fff\",\"style\":{\"visibility\":\"hidden\"}}}},\"left\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":5,\"magnet\":true,\"stroke\":\"#5F95FF\",\"strokeWidth\":1,\"fill\":\"#fff\",\"style\":{\"visibility\":\"hidden\"}}}},\"right\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":5,\"magnet\":true,\"stroke\":\"#5F95FF\",\"strokeWidth\":1,\"fill\":\"#fff\",\"style\":{\"visibility\":\"hidden\"}}}}},\"items\":[{\"group\":\"top\",\"id\":\"port1\"},{\"group\":\"bottom\",\"id\":\"port2\"},{\"group\":\"left\",\"id\":\"port3\"},{\"group\":\"right\",\"id\":\"port4\"}]},\"zIndex\":1,\"cells_type\":\"query\"},{\"position\":{\"x\":610,\"y\":280},\"size\":{\"width\":220,\"height\":60},\"view\":\"vue-shape-view\",\"shape\":\"BaseNode\",\"component\":{},\"id\":\"184821b0-e0e7-4351-8300-2dbd37ac76de\",\"data\":{\"type\":\"BaseNode\",\"cells_type\":\"dataSource\",\"text\":\"数据源算子\",\"configName\":\"DataSource\",\"icon\":\"modeling-dataSource\",\"source\":[\"tjj\",\"1592093252579741698\",\"public\"],\"showDisabledCheckbox\":false,\"clusterId\":\"tjj\",\"clusterNodeId\":\"1592093252579741698\",\"schema\":\"public\",\"antvSelected\":false},\"ports\":{\"groups\":{\"top\":{\"position\":\"top\",\"attrs\":{\"circle\":{\"r\":5,\"magnet\":true,\"stroke\":\"#5F95FF\",\"strokeWidth\":1,\"fill\":\"#fff\",\"style\":{\"visibility\":\"hidden\"}}}},\"bottom\":{\"position\":\"bottom\",\"attrs\":{\"circle\":{\"r\":5,\"magnet\":true,\"stroke\":\"#5F95FF\",\"strokeWidth\":1,\"fill\":\"#fff\",\"style\":{\"visibility\":\"hidden\"}}}},\"left\":{\"position\":\"left\",\"attrs\":{\"circle\":{\"r\":5,\"magnet\":true,\"stroke\":\"#5F95FF\",\"strokeWidth\":1,\"fill\":\"#fff\",\"style\":{\"visibility\":\"hidden\"}}}},\"right\":{\"position\":\"right\",\"attrs\":{\"circle\":{\"r\":5,\"magnet\":true,\"stroke\":\"#5F95FF\",\"strokeWidth\":1,\"fill\":\"#fff\",\"style\":{\"visibility\":\"hidden\"}}}}},\"items\":[{\"group\":\"top\",\"id\":\"port1\"},{\"group\":\"bottom\",\"id\":\"port2\"},{\"group\":\"left\",\"id\":\"port3\"},{\"group\":\"right\",\"id\":\"port4\"}]},\"zIndex\":2,\"cells_type\":\"dataSource\"}]}}";
        paramsObject = JSONObject.parseObject(paramsInJsonString);

        String queryDataString = "[{\"area\":\"河南\",\"goods_name\":\"UPS电源|C6KS|2小时\",\"quantity\":1.0,\"year\":\"2021\",\"price_unit\":19000.0,\"goods_model\":\"UPS电源\\n|C6KS|2小时\",\"salesman\":\"史宗宗\",\"id\":428,\"present\":\"销售品\",\"department\":\"业务部二\",\"brand_type\":\"华为\",\"price_total\":19000.0},{\"area\":\"河南\",\"goods_name\":\"服务器|ThinkSe rver RS260\",\"quantity\":1.0,\"year\":\"2021\",\"price_unit\":7950.0,\"goods_model\":\"服务器\\n|ThinkSe rver RS260\",\"salesman\":\"史宗宗\",\"id\":443,\"present\":\"销售品\",\"department\":\"业务部二\",\"brand_type\":\"华为\",\"price_total\":7950.0},{\"area\":\"河南\",\"goods_name\":\"超6类屏蔽网线|千兆屏蔽网线|RJ45型屏蔽网线插头|5米\",\"quantity\":3.0,\"year\":\"2021\",\"price_unit\":29.74,\"goods_model\":\"超6类屏蔽网线|千兆屏蔽网线\\n|RJ45型屏蔽网线\\n插头|5米\",\"salesman\":\"史宗宗\",\"id\":445,\"present\":\"销售品\",\"department\":\"业务部二\",\"brand_type\":\"华为\",\"price_total\":89.22},{\"area\":\"河南\",\"goods_name\":\"粉盒\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":1040.0,\"goods_model\":\"3503\",\"salesman\":\"马曙光\",\"id\":200,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"理光\",\"price_total\":1040.0},{\"area\":\"河南\",\"goods_name\":\"粉盒\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":930.0,\"goods_model\":\"T-FC505C-Y\",\"salesman\":\"马曙光\",\"id\":203,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"东芝\",\"price_total\":930.0},{\"area\":\"河南\",\"goods_name\":\"专用电容笔\",\"quantity\":5.0,\"year\":\"2021\",\"tax_rate\":\"无\",\"price_unit\":0.0,\"goods_model\":\"2048级灵敏压感\",\"salesman\":\"宋立民\",\"id\":215,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"华为\",\"price_total\":0.0},{\"area\":\"天津\",\"goods_name\":\"计算机外部产品\",\"quantity\":2.0,\"year\":\"2021\",\"price_unit\":1100.0,\"goods_model\":\"44708001\",\"salesman\":\"张建英\",\"id\":135,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"OKI\",\"price_total\":2200.0},{\"area\":\"河南\",\"goods_name\":\"无线鼠标\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"无\",\"price_unit\":0.0,\"goods_model\":\"无\",\"salesman\":\"林超\",\"id\":66,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"罗技\",\"price_total\":0.0},{\"area\":\"西安\",\"goods_name\":\"全媒体融合生产云平台系统V1.0\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"13%\",\"price_unit\":48000.0,\"goods_model\":\"融合平台资源编目软件SWP-CRE-WebCatalog\",\"salesman\":\"马曙光\",\"id\":316,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"大洋\",\"price_total\":48000.0},{\"area\":\"西安\",\"goods_name\":\"企业服务总线系统V3.0\",\"quantity\":2.0,\"year\":\"2021\",\"tax_rate\":\"13%\",\"price_unit\":20000.0,\"goods_model\":\"接口服务SWP-DY-ESB Engine\",\"salesman\":\"马曙光\",\"id\":319,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"大洋\",\"price_total\":40000.0},{\"area\":\"西安\",\"goods_name\":\"音视频文件切割、编目服务\",\"quantity\":500.0,\"year\":\"2021\",\"tax_rate\":\"13%\",\"price_unit\":360.0,\"goods_model\":\"音视频文件切割以及不低于2层的视频编目服务\",\"salesman\":\"马曙光\",\"id\":322,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"大洋\",\"price_total\":180000.0},{\"area\":\"西安\",\"goods_name\":\"硬盘盒\",\"quantity\":6.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":50.0,\"goods_model\":\"Master Caddy II，一盒6个\",\"salesman\":\"姚庆霞\",\"id\":335,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"ATOMOS\",\"price_total\":300.0},{\"area\":\"西安\",\"goods_name\":\"存储设备-移动存储\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":1190.0,\"goods_model\":\"希捷 SRDONF1 4TB便携式\",\"salesman\":\"马旻\",\"id\":367,\"present\":\"销售品\",\"department\":\"产品部\",\"brand_type\":\"希捷\",\"price_total\":1190.0},{\"area\":\"河南\",\"goods_name\":\"服务器-机架式\",\"quantity\":3.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":190849.0,\"goods_model\":\"R740\",\"salesman\":\"李文\",\"id\":11,\"present\":\"赠品\",\"department\":\"运营中心\",\"brand_type\":\"dell\",\"price_total\":572547.0},{\"area\":\"西安\",\"goods_name\":\"硒鼓\",\"quantity\":4.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":135.0,\"goods_model\":\"505A\",\"salesman\":\"马曙光\",\"id\":376,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"万通\",\"price_total\":540.0},{\"area\":\"西安\",\"goods_name\":\"硒鼓\",\"quantity\":2.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":315.0,\"goods_model\":\"192A\",\"salesman\":\"马曙光\",\"id\":380,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"万通\",\"price_total\":630.0},{\"area\":\"西安\",\"goods_name\":\"内存卡\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":195.0,\"goods_model\":\"128G MicroSD卡\",\"salesman\":\"李文\",\"id\":383,\"present\":\"销售品\",\"department\":\"运营中心\",\"brand_type\":\"闪迪\",\"price_total\":195.0},{\"area\":\"河南\",\"goods_name\":\"办公外设-多功能一体机\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":6459.05,\"goods_model\":\"HP Color LaserJet Pro MFP M477fnwA4\",\"salesman\":\"林超\",\"id\":26,\"present\":\"赠品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"惠普\",\"price_total\":6459.05},{\"area\":\"河南\",\"goods_name\":\"交换机\",\"quantity\":2.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":3900.0,\"goods_model\":\"S2700-26TP-PWR-EI-AC\",\"salesman\":\"宋鑫\",\"id\":71,\"present\":\"销售品\",\"department\":\"政教事业三部\",\"brand_type\":\"华为\",\"price_total\":7800.0},{\"area\":\"河南\",\"goods_name\":\"路由器\",\"quantity\":5.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":220.0,\"goods_model\":\"DIR-822+\",\"salesman\":\"马曙光\",\"id\":76,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"D-Link\",\"price_total\":1100.0},{\"area\":\"河南\",\"goods_name\":\"硬盘\",\"quantity\":2.0,\"year\":\"2021\",\"price_unit\":0.0,\"goods_model\":\"银河10TB SATA\",\"salesman\":\"陈嘉玮\",\"id\":84,\"present\":\"销售品\",\"department\":\"业务部四\",\"brand_type\":\"银河10TB SATA\",\"price_total\":0.0},{\"area\":\"河南\",\"goods_name\":\"两路服务器2\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"13%\",\"price_unit\":76374.6,\"goods_model\":\"SR650\",\"salesman\":\"李文\",\"id\":227,\"present\":\"销售品\",\"department\":\"运营中心\",\"brand_type\":\"联想\",\"price_total\":76374.65},{\"area\":\"河南\",\"goods_name\":\"笔记本电脑\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":10689.0,\"goods_model\":\"5590\",\"salesman\":\"董清国\",\"id\":255,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"戴尔\",\"price_total\":10689.0},{\"area\":\"天津\",\"goods_name\":\"台式计算机\",\"quantity\":3.0,\"year\":\"2021\",\"created_at\":1668881874000,\"tax_rate\":\"16%\",\"price_unit\":9807.82,\"goods_model\":\"7060\",\"salesman\":\"牟志强\",\"id\":70,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"戴尔\",\"price_total\":29423.46},{\"area\":\"吉林\",\"goods_name\":\"广播电视设备切换台\",\"quantity\":1.0,\"year\":\"2021\",\"created_at\":1668881874000,\"tax_rate\":\"13%\",\"price_unit\":21800.0,\"goods_model\":\"MCX-500\",\"salesman\":\"姚庆霞\",\"id\":327,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"索尼 SONY\",\"price_total\":21800.0},{\"area\":\"河南\",\"goods_name\":\"硒鼓\",\"quantity\":2.0,\"year\":\"2021\",\"created_at\":1668881874000,\"tax_rate\":\"16%\",\"price_unit\":160.0,\"goods_model\":\"228\",\"salesman\":\"马曙光\",\"id\":379,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"万通\",\"price_total\":320.0},{\"area\":\"河南\",\"goods_name\":\"复印纸\",\"quantity\":85.0,\"year\":\"2021\",\"created_at\":1668881874000,\"tax_rate\":\"16%\",\"price_unit\":26.6,\"goods_model\":\"A4(70G)\",\"salesman\":\"温靖宇\",\"id\":382,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"百旺\",\"price_total\":2261.0},{\"area\":\"河南\",\"goods_name\":\"鼠标\",\"quantity\":1.0,\"year\":\"2021\",\"created_at\":1668881874000,\"tax_rate\":\"16%\",\"price_unit\":49.0,\"goods_model\":\"-\",\"salesman\":\"李文\",\"id\":385,\"present\":\"销售品\",\"department\":\"运营中心\",\"brand_type\":\"联想\",\"price_total\":49.0},{\"area\":\"河南\",\"goods_name\":\"闪光灯\",\"quantity\":1.0,\"year\":\"2021\",\"created_at\":1668881874000,\"tax_rate\":\"16%\",\"price_unit\":3800.0,\"goods_model\":\"SB5000\",\"salesman\":\"刘春杰\",\"id\":403,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"尼康\",\"price_total\":3800.0},{\"area\":\"河南\",\"goods_name\":\"电池\",\"quantity\":2.0,\"year\":\"2021\",\"created_at\":1668881874000,\"tax_rate\":\"16%\",\"price_unit\":359.0,\"goods_model\":\"FV70\",\"salesman\":\"刘春杰\",\"id\":406,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"宝莱特\",\"price_total\":718.0},{\"area\":\"河南\",\"goods_name\":\"8口交换机\",\"quantity\":50.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":289.75,\"goods_model\":\"TL-R860+\",\"salesman\":\"宋立民\",\"id\":258,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"TP-LINK\",\"price_total\":14487.5},{\"area\":\"河南\",\"goods_name\":\"台式计算机\",\"quantity\":13.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":5098.0,\"goods_model\":\"ThinkCentre M710t-D749\",\"salesman\":\"姚庆霞\",\"id\":261,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"联想\",\"price_total\":66274.0},{\"area\":\"河南\",\"goods_name\":\"显示屏播放软件\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":29600.0,\"goods_model\":\"V1.0.1\",\"salesman\":\"王翡翀\",\"id\":275,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"上海三思\",\"price_total\":29600.0},{\"area\":\"河南\",\"goods_name\":\"全媒体融合生产云平台系统V1.0\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"13%\",\"price_unit\":59800.0,\"goods_model\":\"融合平台检索引擎SWP-CRE-Search\",\"salesman\":\"马曙光\",\"id\":313,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"大洋\",\"price_total\":59800.0},{\"area\":\"河南\",\"goods_name\":\"鼠标垫\",\"quantity\":8.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":25.0,\"goods_model\":\"布面\",\"salesman\":\"李文\",\"id\":386,\"present\":\"销售品\",\"department\":\"运营中心\",\"brand_type\":\"罗技\",\"price_total\":200.0},{\"area\":\"河南\",\"goods_name\":\"电池\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":550.0,\"goods_model\":\"EL15\",\"salesman\":\"刘春杰\",\"id\":404,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"尼康\",\"price_total\":550.0},{\"area\":\"河南\",\"goods_name\":\"交换机|S5720- 28P-SI-AC-dualpower\",\"quantity\":2.0,\"year\":\"2021\",\"price_unit\":5600.01,\"goods_model\":\"交换机\\n|S5720- 28P-SI-\\nAC-dual\\npower\",\"salesman\":\"史宗宗\",\"id\":425,\"present\":\"销售品\",\"department\":\"业务部二\",\"brand_type\":\"华为\",\"price_total\":11200.02},{\"area\":\"河南\",\"goods_name\":\"UPS主机|C6K机架式主机\",\"quantity\":1.0,\"year\":\"2021\",\"price_unit\":4659.82,\"goods_model\":\"UPS主\\n机|C6K机架式主机\",\"salesman\":\"史宗宗\",\"id\":429,\"present\":\"销售品\",\"department\":\"业务部二\",\"brand_type\":\"华为\",\"price_total\":4659.82},{\"area\":\"河南\",\"goods_name\":\"中控机柜|工业灰 (RAL 7035)|W80010002260\",\"quantity\":1.0,\"year\":\"2021\",\"price_unit\":11500.0,\"goods_model\":\"中控机柜\\n|工业灰 (RAL 7035)\\n|W80010002260\",\"salesman\":\"史宗宗\",\"id\":432,\"present\":\"销售品\",\"department\":\"业务部二\",\"brand_type\":\"华为\",\"price_total\":11500.0},{\"area\":\"河南\",\"goods_name\":\"超6类屏蔽网线|千兆屏蔽网线|RJ45型屏蔽网线插头|2米\",\"quantity\":5.0,\"year\":\"2021\",\"price_unit\":11.9,\"goods_model\":\"超6类屏蔽网线|千兆屏蔽网线\\n|RJ45型屏蔽网线插头|2米\",\"salesman\":\"史宗宗\",\"id\":435,\"present\":\"销售品\",\"department\":\"业务部二\",\"brand_type\":\"华为\",\"price_total\":59.5},{\"area\":\"河南\",\"goods_name\":\"卡片\",\"quantity\":50.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":30.0,\"goods_model\":\"cpu\",\"salesman\":\"林超\",\"id\":43,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"复旦\",\"price_total\":1500.0},{\"area\":\"河南\",\"goods_name\":\"门禁控制器\",\"quantity\":6.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":1360.0,\"goods_model\":\"TA-M10\",\"salesman\":\"林超\",\"id\":44,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":8160.0},{\"area\":\"河南\",\"goods_name\":\"扩展模块\",\"quantity\":6.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":240.0,\"goods_model\":\"k10\",\"salesman\":\"林超\",\"id\":45,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":1440.0},{\"area\":\"河南\",\"goods_name\":\"双联电磁锁\",\"quantity\":4.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":680.0,\"goods_model\":\"JDY280\",\"salesman\":\"林超\",\"id\":46,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":2720.0},{\"area\":\"河南\",\"goods_name\":\"单联电磁锁\",\"quantity\":2.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":380.0,\"goods_model\":\"JDY280S\",\"salesman\":\"林超\",\"id\":47,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":760.0},{\"area\":\"河南\",\"goods_name\":\"磁力锁支架\",\"quantity\":5.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":140.0,\"goods_model\":\"280专用\",\"salesman\":\"林超\",\"id\":48,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":700.0},{\"area\":\"河南\",\"goods_name\":\"机箱电源\",\"quantity\":6.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":390.0,\"goods_model\":\"TA-12V\",\"salesman\":\"林超\",\"id\":49,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":2340.0},{\"area\":\"河南\",\"goods_name\":\"闭门器\",\"quantity\":9.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":190.0,\"goods_model\":\"TA-BMQ\",\"salesman\":\"林超\",\"id\":50,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":1710.0},{\"area\":\"河南\",\"goods_name\":\"指纹读卡头\",\"quantity\":7.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":1280.0,\"goods_model\":\"TA-Z20\",\"salesman\":\"林超\",\"id\":51,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":8960.0},{\"area\":\"河南\",\"goods_name\":\"出门按钮\",\"quantity\":5.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":20.0,\"goods_model\":\"JDY86\",\"salesman\":\"林超\",\"id\":52,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":100.0},{\"area\":\"河南\",\"goods_name\":\"技术服务费\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"3%\",\"price_unit\":8000.0,\"goods_model\":\"线缆、辅料、安装费\",\"salesman\":\"林超\",\"id\":55,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"定制\",\"price_total\":8000.0},{\"area\":\"河南\",\"goods_name\":\"音响\",\"quantity\":2.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":1723.85,\"goods_model\":\"Bose SoundLink Mini 蓝牙扬声器II-黑色 无线音箱/音响\",\"salesman\":\"林超\",\"id\":56,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"bose\",\"price_total\":3447.7},{\"area\":\"河南\",\"goods_name\":\"无线ap\",\"quantity\":3.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":874.0,\"goods_model\":\"无线ap华为AP301DN-V2\",\"salesman\":\"林超\",\"id\":57,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"华为\",\"price_total\":2622.0},{\"area\":\"河南\",\"goods_name\":\"硒鼓\",\"quantity\":3.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":115.0,\"goods_model\":\"388A\",\"salesman\":\"马曙光\",\"id\":58,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"万通\",\"price_total\":345.0},{\"area\":\"河南\",\"goods_name\":\"硒鼓\",\"quantity\":2.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":135.0,\"goods_model\":\"505A\",\"salesman\":\"马曙光\",\"id\":59,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"格之格\",\"price_total\":270.0},{\"area\":\"河南\",\"goods_name\":\"硒鼓\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":350.0,\"goods_model\":\"192A\",\"salesman\":\"马曙光\",\"id\":60,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"万通\",\"price_total\":350.0},{\"area\":\"河南\",\"goods_name\":\"复印纸\",\"quantity\":8.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":39.9,\"goods_model\":\"B4(70G)\",\"salesman\":\"马曙光\",\"id\":61,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"百旺\",\"price_total\":319.2},{\"area\":\"河南\",\"goods_name\":\"硬盘\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":900.0,\"goods_model\":\"监控级4T\",\"salesman\":\"林超\",\"id\":64,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"希捷\",\"price_total\":900.0},{\"area\":\"河南\",\"goods_name\":\"HDMI线材\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"无\",\"price_unit\":0.0,\"goods_model\":\"3米\",\"salesman\":\"林超\",\"id\":65,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"无\",\"price_total\":0.0},{\"area\":\"河南\",\"goods_name\":\"硒鼓\",\"quantity\":3.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":560.0,\"goods_model\":\"742A\",\"salesman\":\"马曙光\",\"id\":161,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"万通\",\"price_total\":1680.0},{\"area\":\"河南\",\"goods_name\":\"转接线\",\"quantity\":5.0,\"year\":\"2021\",\"tax_rate\":\"无\",\"price_unit\":0.0,\"goods_model\":\"5米HDMI\",\"salesman\":\"王翡翀\",\"id\":268,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"绿联\",\"price_total\":0.0},{\"area\":\"天津\",\"goods_name\":\"光电模块\",\"quantity\":6.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":3800.0,\"goods_model\":\"SFP-10G-SR\",\"salesman\":\"宋立民\",\"id\":138,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"光电模块\",\"price_total\":22800.0},{\"area\":\"河南\",\"goods_name\":\"硒鼓\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":560.0,\"goods_model\":\"742\",\"salesman\":\"马曙光\",\"id\":373,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"万通\",\"price_total\":560.0},{\"area\":\"河南\",\"goods_name\":\"打印机粉仓\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":185.0,\"goods_model\":\"230\",\"salesman\":\"刘春杰\",\"id\":37,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"万通\",\"price_total\":185.0},{\"area\":\"河南\",\"goods_name\":\"笔记本\",\"quantity\":5.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":6999.0,\"goods_model\":\"5490  230049\",\"salesman\":\"何志国\",\"id\":38,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"戴尔\",\"price_total\":34995.0},{\"area\":\"河南\",\"goods_name\":\"内部沟通设备（无线蓝牙）\",\"quantity\":5.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":520.0,\"goods_model\":\"K374BT\",\"salesman\":\"姚庆霞\",\"id\":332,\"present\":\"销售品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"AKG\",\"price_total\":2600.0},{\"area\":\"河南\",\"goods_name\":\"多功能一体机\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":8009.0,\"goods_model\":\"HP Color LaserJet Pro MFP M477fdwA4\",\"salesman\":\"舒武君\",\"id\":395,\"present\":\"销售品\",\"department\":\"政教事业三部\",\"brand_type\":\"惠普\",\"price_total\":8009.0},{\"area\":\"河南\",\"goods_name\":\"UPS电源|C6KS|2小时\",\"quantity\":1.0,\"year\":\"2021\",\"price_unit\":19000.0,\"goods_model\":\"UPS电\\n源\\n|C6KS|2\\n小时\",\"salesman\":\"史宗宗\",\"id\":460,\"present\":\"销售品\",\"department\":\"业务部二\",\"brand_type\":\"华为\",\"price_total\":19000.0},{\"area\":\"广东\",\"goods_name\":\"服务器\",\"quantity\":4.0,\"year\":\"2022\",\"tax_rate\":\"16%\",\"price_unit\":40512.0,\"goods_model\":\"R740\",\"salesman\":\"牟志强\",\"id\":599,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"戴尔\",\"price_total\":162048.0},{\"area\":\"广东\",\"goods_name\":\"有线麦克风\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":1150.0,\"goods_model\":\"MG418\",\"salesman\":\"姚庆霞\",\"id\":14,\"present\":\"赠品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"美歌\",\"price_total\":1150.0},{\"area\":\"广东\",\"goods_name\":\"摄录一体机\",\"quantity\":6.0,\"year\":\"2022\",\"tax_rate\":\"16%\",\"price_unit\":32400.0,\"goods_model\":\"PXW-X280\",\"salesman\":\"马旻\",\"id\":636,\"present\":\"销售品\",\"department\":\"产品部\",\"brand_type\":\"索尼\",\"price_total\":194400.0},{\"area\":\"广东\",\"goods_name\":\"服务器|RS260- 8GB-1TB\",\"quantity\":1.0,\"tax_rate\":\"13%\",\"price_unit\":8860.0,\"goods_model\":\"服务器|RS260- 8GB-1TB\",\"salesman\":\"史宗宗\",\"id\":1025,\"present\":\"赠品\",\"department\":\"业务部二\",\"brand_type\":\"联想\",\"price_total\":8860.0},{\"area\":\"上海\",\"goods_name\":\"超6类屏蔽网线|千兆屏蔽网线|RJ45型屏蔽网线插头|2米\",\"quantity\":5.0,\"price_unit\":11.9,\"goods_model\":\"超6类屏蔽网线|千兆屏蔽网线\\n|RJ45型屏蔽网线\\n插头|2米\",\"salesman\":\"史宗宗\",\"id\":1122,\"present\":\"赠品\",\"department\":\"业务部二\",\"brand_type\":\"华为\",\"price_total\":59.51},{\"area\":\"上海\",\"goods_name\":\"超6类屏蔽网线|千兆屏蔽网线|RJ45型屏蔽网线插头|50米\",\"quantity\":3.0,\"tax_rate\":\"13%\",\"price_unit\":183.5,\"goods_model\":\"超6类屏蔽网线|千兆屏蔽网线|RJ45型屏蔽网线插头|50米\",\"salesman\":\"史宗宗\",\"id\":1174,\"present\":\"赠品\",\"department\":\"业务部二\",\"brand_type\":\"联想\",\"price_total\":550.5},{\"area\":\"上海\",\"goods_name\":\"打印机\",\"quantity\":4.0,\"tax_rate\":\"13%\",\"price_unit\":2500.0,\"goods_model\":\"DocuPrint P368d\",\"salesman\":\"李书进\",\"id\":1213,\"present\":\"赠品\",\"department\":\"业务部二\",\"brand_type\":\"富士施乐\",\"price_total\":10000.0},{\"area\":\"上海\",\"goods_name\":\"转接线\",\"quantity\":2.0,\"tax_rate\":\"13%\",\"price_unit\":0.0,\"goods_model\":\"Mini DP转VGA\",\"salesman\":\"王翡翀\",\"id\":1226,\"present\":\"赠品\",\"department\":\"ZD政教事业一部\",\"brand_type\":\"绿联\",\"price_total\":0.0},{\"area\":\"重庆\",\"goods_name\":\"台式机（配套使用27寸se2719h显示器）\",\"quantity\":1.0,\"year\":\"2022\",\"tax_rate\":\"13%\",\"price_unit\":4250.0,\"goods_model\":\"3470\",\"salesman\":\"何志国\",\"id\":767,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"戴尔\",\"price_total\":4250.0},{\"area\":\"重庆\",\"goods_name\":\"荧光笔\",\"quantity\":2.0,\"year\":\"2022\",\"tax_rate\":\"13%\",\"price_unit\":10.0,\"goods_model\":\"得力33111（混）\",\"salesman\":\"李文\",\"id\":831,\"present\":\"销售品\",\"department\":\"运营中心\",\"brand_type\":\"得力\",\"price_total\":20.0},{\"area\":\"河南\",\"goods_name\":\"机械制图陈列柜\",\"quantity\":4.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":10000.0,\"goods_model\":\"thkj\",\"salesman\":\"何志国\",\"id\":39,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"无\",\"price_total\":40000.0},{\"area\":\"河南\",\"goods_name\":\"门禁管理软件\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":8900.0,\"goods_model\":\"标准版\",\"salesman\":\"林超\",\"id\":41,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":8900.0},{\"area\":\"河南\",\"goods_name\":\"指纹采集仪\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":1400.0,\"goods_model\":\"TA-Z20\",\"salesman\":\"林超\",\"id\":42,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"同安\",\"price_total\":1400.0},{\"area\":\"河南\",\"goods_name\":\"台式计算机\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":4506.0,\"goods_model\":\"启天M415-B053\",\"salesman\":\"林超\",\"id\":1,\"present\":\"赠品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"联想\",\"price_total\":4506.0},{\"area\":\"河南\",\"goods_name\":\"维保\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"6%\",\"price_unit\":645700.0,\"goods_model\":\"ICT\",\"salesman\":\"孙毅\",\"id\":21,\"present\":\"赠品\",\"department\":\"政教事业本部\",\"brand_type\":\"华为\",\"price_total\":645700.0},{\"area\":\"河南\",\"goods_name\":\"维保服务\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"6%\",\"price_unit\":645700.0,\"goods_model\":\"ICT\",\"salesman\":\"孙毅\",\"id\":22,\"present\":\"赠品\",\"department\":\"政教事业本部\",\"brand_type\":\"华为\",\"price_total\":645700.0},{\"area\":\"河南\",\"goods_name\":\"服务费\",\"quantity\":1.0,\"year\":\"2021\",\"price_unit\":1500.0,\"goods_model\":\"无\",\"salesman\":\"王翡翀\",\"id\":23,\"present\":\"赠品\",\"department\":\"政教事业本部\",\"brand_type\":\"无\",\"price_total\":1500.0},{\"area\":\"河南\",\"goods_name\":\"办公外设-打印设备-激光打印机\",\"quantity\":5.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":2015.9,\"goods_model\":\"HP LaserJet Pro M203dn\",\"salesman\":\"林超\",\"id\":24,\"present\":\"赠品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"惠普\",\"price_total\":10079.5},{\"area\":\"河南\",\"goods_name\":\"办公外设-打印设备-激光打印机\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":6156.0,\"goods_model\":\"HP LaserJet Pro M701a\",\"salesman\":\"林超\",\"id\":25,\"present\":\"赠品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"惠普\",\"price_total\":6156.0},{\"area\":\"河南\",\"goods_name\":\"新风系统\",\"quantity\":1.0,\"year\":\"2021\",\"price_unit\":21300.0,\"goods_model\":\"FG-B550\",\"salesman\":\"赵雪\",\"id\":28,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"风果\",\"price_total\":21300.0},{\"area\":\"河南\",\"goods_name\":\"*现代服务*安装费\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"6%\",\"price_unit\":2600.0,\"goods_model\":\"无\",\"salesman\":\"赵雪\",\"id\":31,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"友邦\",\"price_total\":2600.0},{\"area\":\"河南\",\"goods_name\":\"除尘罩\",\"quantity\":7.0,\"year\":\"2021\",\"tax_rate\":\"无\",\"price_unit\":0.0,\"goods_model\":\"02\",\"salesman\":\"赵雪\",\"id\":32,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"金城布艺\",\"price_total\":0.0},{\"area\":\"河南\",\"goods_name\":\"小米空气净化器\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"无\",\"price_unit\":0.0,\"goods_model\":\"D130\",\"salesman\":\"赵雪\",\"id\":33,\"present\":\"销售品\",\"department\":\"政教事业四部\",\"brand_type\":\"小米\",\"price_total\":0.0},{\"area\":\"河南\",\"goods_name\":\"墨粉\",\"quantity\":2.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":520.0,\"goods_model\":\"CF230A\",\"salesman\":\"温靖宇\",\"id\":102,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"惠普\",\"price_total\":1040.0},{\"area\":\"河南\",\"goods_name\":\"保密柜\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":1200.0,\"goods_model\":\"950*420*550\",\"salesman\":\"温靖宇\",\"id\":103,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"盛欣佳美\",\"price_total\":1200.0},{\"area\":\"河南\",\"goods_name\":\"电话机\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":1200.0,\"goods_model\":\"908\",\"salesman\":\"温靖宇\",\"id\":104,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"纽曼\",\"price_total\":1200.0},{\"area\":\"河南\",\"goods_name\":\"墨粉\",\"quantity\":2.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":530.0,\"goods_model\":\"CF230\",\"salesman\":\"温靖宇\",\"id\":105,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"惠普\",\"price_total\":1060.0},{\"area\":\"河南\",\"goods_name\":\"针式打印机\",\"quantity\":6.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":2432.0,\"goods_model\":\"LQ-690K\",\"salesman\":\"宋立民\",\"id\":109,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"爱普生\",\"price_total\":14592.0},{\"area\":\"河南\",\"goods_name\":\"内存卡\",\"quantity\":3.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":0.0,\"goods_model\":\"TF\",\"salesman\":\"宋立民\",\"id\":110,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"TF\",\"price_total\":0.0},{\"area\":\"河南\",\"goods_name\":\"条码数据采集器\",\"quantity\":18.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":1140.0,\"goods_model\":\"NLS-HR23\",\"salesman\":\"宋立民\",\"id\":111,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"新大陆\",\"price_total\":20520.0},{\"area\":\"河南\",\"goods_name\":\"网线\",\"quantity\":1.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":836.0,\"goods_model\":\"超5类网线\",\"salesman\":\"林超\",\"id\":114,\"present\":\"销售品\",\"department\":\"ZD政教事业二部\",\"brand_type\":\"安普\",\"price_total\":836.0},{\"area\":\"河南\",\"goods_name\":\"移动硬盘\",\"quantity\":10.0,\"year\":\"2021\",\"tax_rate\":\"16%\",\"price_unit\":817.0,\"goods_model\":\"2T 移动硬盘\",\"salesman\":\"宋鑫\",\"id\":115,\"present\":\"销售品\",\"department\":\"政教事业三部\",\"brand_type\":\"希捷\",\"price_total\":8170.0}]";
        queryData = (List<Map<String,Object>>) JSONArray.parse(queryDataString);

        ModelingDataFlowEntity mockEntity = new ModelingDataFlowEntity();
        mockEntity.setName("test");
        mockEntity.setClusterNodeId("1592093252579741698");
        mockEntity.setSchema("public");

        //mock into function
        when(modelingDataBaseService.queryWithSqlObject(ArgumentMatchers.any(ModelingDataFlowSqlObject.class))).thenReturn(queryData);
        when(modelingDataFlowService.getById("1301")).thenReturn(mockEntity);
        when(modelingDataFlowProcessService.getSqlObjectByTargetOperatorId(ArgumentMatchers.any(JSONObject.class),ArgumentMatchers.any(),ArgumentMatchers.any())).thenReturn(sqlObject);
    }

    @Test
    public void generate() throws SQLException, ClassNotFoundException {
        prepareData();
        barChartGenerateService.setFullParams(paramsObject);
        String result = barChartGenerateService.generate();
        Assertions.assertEquals(result,"{\"grid\":{\"bottom\":\"40\",\"containLabel\":true,\"left\":\"3%\",\"right\":\"3%\"},\"legend\":{\"bottom\":10,\"data\":[\"业务部二\",\"ZD政教事业一部\",\"ZD政教事业二部\",\"政教事业四部\",\"产品部\"],\"type\":\"scroll\"},\"series\":[{\"data\":[73518.07,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,9410.5,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,10000.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"name\":\"业务部二\",\"type\":\"bar\",\"yAxisIndex\":0},{\"data\":[0.0,1040.0,930.0,0.0,0.0,327800.0,300.0,0.0,0.0,4425.0,0.0,0.0,1100.0,0.0,66274.0,0.0,21800.0,319.2,0.0,0.0,0.0,29600.0,0.0,0.0,0.0,0.0,270.0,0.0,0.0,0.0,2600.0,1150.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"name\":\"ZD政教事业一部\",\"type\":\"bar\",\"yAxisIndex\":0},{\"data\":[2622.0,0.0,0.0,0.0,0.0,0.0,0.0,900.0,0.0,0.0,0.0,24794.55,0.0,0.0,4506.0,0.0,0.0,2261.0,0.0,0.0,14487.5,0.0,1500.0,37190.0,8000.0,3447.7,0.0,0.0,0.0,22800.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,1200.0,1200.0,14592.0,0.0,20520.0,836.0],\"name\":\"ZD政教事业二部\",\"type\":\"bar\",\"yAxisIndex\":0},{\"data\":[0.0,0.0,0.0,0.0,0.0,0.0,0.0,1190.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,194400.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"name\":\"产品部\",\"type\":\"bar\",\"yAxisIndex\":0},{\"data\":[0.0,0.0,0.0,2200.0,0.0,0.0,0.0,0.0,0.0,185.0,0.0,0.0,0.0,0.0,0.0,241405.47,0.0,0.0,4350.0,718.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,40000.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,21300.0,2600.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],\"name\":\"政教事业四部\",\"type\":\"bar\",\"yAxisIndex\":0}],\"title\":{\"text\":\"sss\"},\"tooltip\":{\"trigger\":\"axis\"},\"xAxis\":{\"boundaryGap\":true,\"data\":[\"华为\",\"理光\",\"东芝\",\"OKI\",\"罗技\",\"大洋\",\"ATOMOS\",\"希捷\",\"dell\",\"万通\",\"闪迪\",\"惠普\",\"D-Link\",\"银河10TB SATA\",\"联想\",\"戴尔\",\"索尼 SONY\",\"百旺\",\"尼康\",\"宝莱特\",\"TP-LINK\",\"上海三思\",\"复旦\",\"同安\",\"定制\",\"bose\",\"格之格\",\"无\",\"绿联\",\"光电模块\",\"AKG\",\"美歌\",\"索尼\",\"富士施乐\",\"得力\",\"风果\",\"友邦\",\"金城布艺\",\"小米\",\"盛欣佳美\",\"纽曼\",\"爱普生\",\"TF\",\"新大陆\",\"安普\"],\"type\":\"category\"},\"yAxis\":{\"alignTicks\":false,\"axisLabel\":{\"formatter\":\"{value}ss\"},\"type\":\"value\"}}");
    }

}
